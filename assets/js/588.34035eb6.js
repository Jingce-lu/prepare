(window.webpackJsonp=window.webpackJsonp||[]).push([[588],{783:function(v,_,l){"use strict";l.r(_);var i=l(1),t=Object(i.a)({},(function(){var v=this,_=v.$createElement,l=v._self._c||_;return l("ContentSlotsDistributor",{attrs:{"slot-key":v.$parent.slotKey}},[l("h1",{attrs:{id:"一个页面从输入url到加载显示完成，发生了什么？"}},[l("a",{staticClass:"header-anchor",attrs:{href:"#一个页面从输入url到加载显示完成，发生了什么？","aria-hidden":"true"}},[v._v("#")]),v._v(" 一个页面从输入URL到加载显示完成，发生了什么？")]),v._v(" "),l("ul",[l("li",[l("a",{attrs:{href:"#%E4%B8%80%E4%B8%AA%E9%A1%B5%E9%9D%A2%E4%BB%8E%E8%BE%93%E5%85%A5url%E5%88%B0%E5%8A%A0%E8%BD%BD%E6%98%BE%E7%A4%BA%E5%AE%8C%E6%88%90%E5%8F%91%E7%94%9F%E4%BA%86%E4%BB%80%E4%B9%88"}},[v._v("一个页面从输入URL到加载显示完成，发生了什么？")]),v._v(" "),l("ul",[l("li",[l("a",{attrs:{href:"#%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C"}},[v._v("计算机网络")])]),v._v(" "),l("li",[l("a",{attrs:{href:"#%E6%B5%8F%E8%A7%88%E5%99%A8%E6%9C%BA%E5%88%B6"}},[v._v("浏览器机制")]),v._v(" "),l("ul",[l("li",[l("a",{attrs:{href:"#%E8%BF%9B%E7%A8%8B%E5%92%8C%E7%BA%BF%E7%A8%8B%E7%9A%84%E6%A6%82%E5%BF%B5"}},[v._v("进程和线程的概念")])]),v._v(" "),l("li",[l("a",{attrs:{href:"#%E5%A4%9A%E8%BF%9B%E7%A8%8B%E7%9A%84%E6%B5%8F%E8%A7%88%E5%99%A8"}},[v._v("多进程的浏览器")])]),v._v(" "),l("li",[l("a",{attrs:{href:"#%E6%B5%8F%E8%A7%88%E5%99%A8%E5%86%85%E6%A0%B8%E6%B8%B2%E6%9F%93%E8%BF%9B%E7%A8%8B"}},[v._v("浏览器内核（渲染进程）")])])])]),v._v(" "),l("li",[l("a",{attrs:{href:"#%E4%B8%80%E4%B8%AA%E9%A1%B5%E9%9D%A2%E4%BB%8E%E8%BE%93%E5%85%A5url%E5%88%B0%E5%8A%A0%E8%BD%BD%E6%98%BE%E7%A4%BA%E5%AE%8C%E6%88%90%E8%BF%99%E4%B8%AA%E8%BF%87%E7%A8%8B%E5%8F%91%E7%94%9F%E4%BA%86%E4%BB%80%E4%B9%88"}},[v._v("一个页面从输入URL到加载显示完成，这个过程发生了什么？")])])])])]),v._v(" "),l("h2",{attrs:{id:"计算机网络"}},[l("a",{staticClass:"header-anchor",attrs:{href:"#计算机网络","aria-hidden":"true"}},[v._v("#")]),v._v(" 计算机网络")]),v._v(" "),l("ol",[l("li",[l("p",[v._v("五层因特尔协议栈：")]),v._v(" "),l("ul",[l("li",[v._v("应用层（dns、http）：DNS解析成IP并完成http请求发送；")]),v._v(" "),l("li",[v._v("传输层（tcp、udp）：三次握手四次挥手模式建立tcp连接；")]),v._v(" "),l("li",[v._v("网络层（IP、ARP）：IP寻址；")]),v._v(" "),l("li",[v._v("数据链路层（PPP）：将请求数据封装成帧；")]),v._v(" "),l("li",[v._v("物理层：利用物理介质传输比特流（传输的时候通过双绞线、电磁波等）")]),v._v(" "),l("li",[l("strong",[v._v("OIS七层框架")]),v._v(":多了两层即，会话层（处理两个通信系统中交换信息的表示方式）和表示层（管理不同用户和进程之间的对话）。")])])]),v._v(" "),l("li",[l("p",[v._v("get和post的区别：")]),v._v(" "),l("ul",[l("li",[v._v("get产生一个tcp数据包，post产生两个")]),v._v(" "),l("li",[v._v("get请求时会把headers和data数据一起发送出去；")]),v._v(" "),l("li",[v._v("post请求时，浏览器先发送headers，服务器100继续，浏览器再发送data。")])])]),v._v(" "),l("li",[l("p",[v._v("DNS查询得到IP")]),v._v(" "),l("ol",[l("li",[v._v("请求信息：首先查看域名的本地DNS缓存，该缓存存储计算机最近检索到的信息，如果计算机不知道答案，那么就需要执行一个DNS查询来查找答案；")]),v._v(" "),l("li",[v._v("询问递归式DNS服务器：\n"),l("ul",[l("li",[v._v("如果信息不存储在本地，计算机会联系您的ISP（网络提供商）的递归DNS服务器；")]),v._v(" "),l("li",[v._v("这些专用计算机会为你执行一个DNS查询工作；")]),v._v(" "),l("li",[v._v("递归服务器有自己的缓存，所以这个查询过程通常在这里完成，并将信息还回给用户；")])])]),v._v(" "),l("li",[v._v("询问根域名服务器\n"),l("ul",[l("li",[v._v("如果递归服务器没有答案，他们会查询根域名服务器；")]),v._v(" "),l("li",[v._v("根域名服务器是一种计算机，它扮演着一种DNS的电话接线员的角色，他们不知道答案，但可以将我们的疑问指向知道在哪里可以找到答案的人。")])])]),v._v(" "),l("li",[v._v("询问TLD域名服务器：\n"),l("ul",[l("li",[v._v("根域名服务器将查看请求的第一部分，按从右到左的顺序，从www.dyn.com中找到.com，并将请求指向.com对应的顶级域名服务器（TLD）.com;")]),v._v(" "),l("li",[v._v("每个TLD，如（.com,.org,.us）都有自己的顶级域名服务器，")]),v._v(" "),l("li",[v._v("这些服务器没有我们需要的信息，但他们可以直接将我们引导到有信息的服务器。")])])]),v._v(" "),l("li",[v._v("询问权威的DNS服务器\n"),l("ul",[l("li",[v._v("TLD域名服务器会继续检查请求的下一部分（dyn）www.dyn.com，并将查询指向负责此特定域名的服务器；")]),v._v(" "),l("li",[v._v("这些权威的服务器将负责了解关于特定域的所有信息，并将信息存储在DNS记录。")])])]),v._v(" "),l("li",[v._v("找回记录："),l("br"),v._v("\n递归服务器从权威服务器中检索dyn.com的记录，并将记录存储在本地缓存；\n"),l("ul",[l("li",[v._v("如果其他任何人请求dyn.com的主机记录，递归服务器已经有答案了，并不需要再次进行查找；")]),v._v(" "),l("li",[v._v("所有记录都有一个期限，一段时间后，递归服务器将需要要求一个新的记录副本，以确保信息不回过时。")])])]),v._v(" "),l("li",[v._v("接收答案：\n"),l("ul",[l("li",[v._v("有了答案，递归服务器将记录返回到计算机，")]),v._v(" "),l("li",[v._v("您的计算机将记录存储在缓存中，从记录中读取IP地址，然后将这些信息传递给浏览器；")]),v._v(" "),l("li",[v._v("然后浏览器就可以根据IP地址和服务器进行连接建立。")])])])])]),v._v(" "),l("li",[l("p",[v._v("TCPIP请求")]),v._v(" "),l("ul",[l("li",[l("p",[v._v("http的本质就是TCPIP请求；")])]),v._v(" "),l("li",[l("p",[v._v("需要经历3次握手建立连接，4次挥手断开连接；")])]),v._v(" "),l("li",[l("p",[v._v("TCP将http长报文划分为短报文，通过三次握手与服务器端建立连接，进行可靠传输。")])]),v._v(" "),l("li",[l("p",[l("strong",[v._v("三次握手")]),v._v("：")]),v._v(" "),l("ol",[l("li",[v._v("客户端：你是XXX服务端吗？")]),v._v(" "),l("li",[v._v("务端： 我是XXX服务端，你是客户端吗？")]),v._v(" "),l("li",[v._v("客服端： 是的，我是客户端")])]),v._v(" "),l("p",[v._v("建立连接成功后，接下来就可以进行正式的传输数据。")])]),v._v(" "),l("li",[l("p",[l("strong",[v._v("四次挥手断开连接")])]),v._v(" "),l("ol",[l("li",[v._v("主动方：我已经关闭了向你那边的信息发送通道，只能被动接受信息了；")]),v._v(" "),l("li",[v._v("被动方： 收到通道关闭的信息；")]),v._v(" "),l("li",[v._v("被动方： 我现在也关闭了向你那边发送信息的通道")]),v._v(" "),l("li",[v._v("主动方： 左后收到信息，连接断开，之后双方无法通信")])])])])]),v._v(" "),l("li",[l("p",[v._v("TCP/IP的并发限制：")]),v._v(" "),l("ul",[l("li",[v._v("浏览器对同一个域名下并发的TCP连接是有限制的（2-10个不等）")]),v._v(" "),l("li",[v._v("而且在http1.0中往往一个资源的下载就需要一个tcp/ip请求")])])])]),v._v(" "),l("h2",{attrs:{id:"浏览器机制"}},[l("a",{staticClass:"header-anchor",attrs:{href:"#浏览器机制","aria-hidden":"true"}},[v._v("#")]),v._v(" 浏览器机制")]),v._v(" "),l("h3",{attrs:{id:"进程和线程的概念"}},[l("a",{staticClass:"header-anchor",attrs:{href:"#进程和线程的概念","aria-hidden":"true"}},[v._v("#")]),v._v(" 进程和线程的概念")]),v._v(" "),l("ol",[l("li",[v._v("进程是CPU资源分配的最小单位，是能拥有资源和独立运行的最小单位；")]),v._v(" "),l("li",[v._v("线程是CPU调度的最小单位，线程是建立在进程的基础上的一次程序运行单位，一个进程可以拥有多个线程；")]),v._v(" "),l("li",[v._v("通俗的讲：进程是一个工厂，工厂有它独立的资源，工厂之间相互独立->进程之间相互独立，线程是工厂中的工人，多个工人之间可以协作完成任务，工厂内有一个或多个工人，工人之间共享空间。")])]),v._v(" "),l("h3",{attrs:{id:"多进程的浏览器"}},[l("a",{staticClass:"header-anchor",attrs:{href:"#多进程的浏览器","aria-hidden":"true"}},[v._v("#")]),v._v(" 多进程的浏览器")]),v._v(" "),l("blockquote",[l("p",[v._v("浏览器是多进程的，有一个主控进程，以及每一个tab页面都会开一个进程（某些情况下多个tab由于优化策略会合并）")])]),v._v(" "),l("p",[v._v("浏览器主要进程：")]),v._v(" "),l("ol",[l("li",[v._v("Browser进程：浏览器的主进程，负责协调、主控，只有一个，作用：\n"),l("ul",[l("li",[v._v("负责浏览器界面的显示、与用户交互（如前进、后退等）")]),v._v(" "),l("li",[v._v("负责各个页面的管理，创建和销毁其他进程；")]),v._v(" "),l("li",[v._v("将Renderer进程得到的内存中的Bitmap绘制到用户界面上")]),v._v(" "),l("li",[v._v("网络资源的管理和下载等")])])]),v._v(" "),l("li",[v._v("第三方插件进程： 每种类型的插件对应一个进程，仅当该插件使用时才创建；")]),v._v(" "),l("li",[v._v("GPU进程： 最多一个，用于3D绘制等；")]),v._v(" "),l("li",[v._v("浏览器渲染进程（Renderer进程、浏览器内核、内部是多线程）：\n"),l("ul",[l("li",[v._v("默认没打开一个tab页面，就会启动一个Renderer进程；")]),v._v(" "),l("li",[v._v("负责页面的渲染，脚本的执行，事件的处理。")])])])]),v._v(" "),l("p",[v._v("浏览器多进程的优势")]),v._v(" "),l("ol",[l("li",[v._v("避免单个page crash影响整个浏览器；")]),v._v(" "),l("li",[v._v("避免第三方插件crash影响整个浏览器")]),v._v(" "),l("li",[v._v("多进程充分利用多核优势；")]),v._v(" "),l("li",[v._v("方便使用沙盒模型隔离插件等进程，提高浏览器稳定性")])]),v._v(" "),l("blockquote",[l("p",[v._v("简单点理解：如果浏览器是单进程，那么某个tab页或第三方插件崩溃了，就会导致整个浏览器崩溃，体验度极差，不过多进程内存消耗会更大，有点用空间换时间。")])]),v._v(" "),l("h3",{attrs:{id:"浏览器内核（渲染进程）"}},[l("a",{staticClass:"header-anchor",attrs:{href:"#浏览器内核（渲染进程）","aria-hidden":"true"}},[v._v("#")]),v._v(" 浏览器内核（渲染进程）")]),v._v(" "),l("p",[v._v("浏览器渲染进程内部是多线程，包含主要线程有：")]),v._v(" "),l("ol",[l("li",[l("p",[v._v("GUI渲染线程：")]),v._v(" "),l("ul",[l("li",[v._v("（1）负责浏览器界面的渲染，解析HTML、CSS，构建DOM树和RenderObject树，布局和绘制等；")]),v._v(" "),l("li",[v._v("（2） 当界面需要重绘（Repaint）或由于某种操作引发回流（reflow）时该线程会执行；")]),v._v(" "),l("li",[l("strong",[v._v("注意：GUI渲染线程和JS引擎线程是互斥的")]),v._v("，当JS引擎执行时GUI线程会被挂起，GUI更新会保存在一个队列中等JS引擎空闲时立即执行。")])])]),v._v(" "),l("li",[l("p",[v._v("JS引擎线程：")]),v._v(" "),l("ul",[l("li",[v._v("JS内核，负责处理JavaScript脚本程序（V8引擎）")]),v._v(" "),l("li",[v._v("负责解析JavaScript脚本，运行代码；")]),v._v(" "),l("li",[v._v("JS引擎一直等待着任务队列中的任务到来，然后加以处理，一个tab页面（renderer进程）中无论什么时候都只有一个JS线程在运行JS程序；")]),v._v(" "),l("li",[l("strong",[v._v("注意：由于GUI渲染线程和JS引擎线程是互斥的")]),v._v("，所以如果JS程序运行时间过长，这样会导致页面渲染不连贯，导致页面渲染加载阻塞；")])])]),v._v(" "),l("li",[l("p",[v._v("事件触发线程：")]),v._v(" "),l("ul",[l("li",[v._v("归属于浏览器，而不是JS引擎，用来控制事件循环；")]),v._v(" "),l("li",[v._v("当JS引擎执行代码块如setTimeOut时（也可以来自浏览器内核的其他线程，如鼠标单击事件、AJAX异步请求等），会将对应的任务添加到事件线程中；")]),v._v(" "),l("li",[v._v("当对应的事件符合触发条件被触发时，该线程就会把事件添加到JS的待处理队列的队尾，等待JS引擎的处理；")]),v._v(" "),l("li",[l("strong",[v._v("注意：由于JS的单线程的关系")]),v._v("所以这些待处理队列中的事件都得排队等待JS引擎处理（当JS引擎空闲时才会去执行）。")])])]),v._v(" "),l("li",[l("p",[v._v("定时触发器线程：")]),v._v(" "),l("ul",[l("li",[v._v("setTimeOut与setInterval所在的线程；")]),v._v(" "),l("li",[v._v("浏览器的定时计数器并不是由JavaScript引擎计数的，（因为JavaScript是单线程，如果处于阻塞状态就会影响计时的准确）因此通过单独的线程来计时并触发定时（计时完毕后，添加到事件队列，等待JS引擎空闲时执行）")])])]),v._v(" "),l("li",[l("p",[v._v("异步http请求线程：")]),v._v(" "),l("ul",[l("li",[v._v("在XMLHttpRequest在连接后是通过浏览器新开一个线程请求的")]),v._v(" "),l("li",[v._v("将检测到状态变更时，如果设置有回调函数，异步线程就将产生状态变更事件，将这个回调在放到事件队列中，再由JavaScript引擎执行。")])])])]),v._v(" "),l("h2",{attrs:{id:"一个页面从输入url到加载显示完成，这个过程发生了什么？"}},[l("a",{staticClass:"header-anchor",attrs:{href:"#一个页面从输入url到加载显示完成，这个过程发生了什么？","aria-hidden":"true"}},[v._v("#")]),v._v(" 一个页面从输入URL到加载显示完成，这个过程发生了什么？")]),v._v(" "),l("p",[v._v("简洁版：")]),v._v(" "),l("ul",[l("li",[v._v("浏览器根据请求的URL交给DNS域名解析，找到真实的IP，向服务器发起请求；")]),v._v(" "),l("li",[v._v("服务器交给后台处理完成后返回数据，浏览器接收文件（HTML、CSS、JavaScript等）；")]),v._v(" "),l("li",[v._v("浏览器对加载到的资源（HTML、CSS、JavaScript等）进行语法解析，构建相应的内部数据结构（DOM树、CSS树、render树等）；")]),v._v(" "),l("li",[v._v("载入解析到的资源文件、渲染页面、完成。")])]),v._v(" "),l("p",[v._v("详细版：")]),v._v(" "),l("ol",[l("li",[v._v("首先浏览器开启一个线程来处理这个请求，对URL分析判断，如果是http协议就按照Web方式来处理；")]),v._v(" "),l("li",[v._v("其次浏览器会对URL进行解析，一般包括（协议头、主机域名或IP地址、端口号、请求路径、查询参数、hash等），然后开启网络线程发出一个完整到http请求；")]),v._v(" "),l("li",[v._v("当然一般我们输入的URL是服务器域名，这时就需要DNS通过域名查询得到对应的IP；")]),v._v(" "),l("li",[v._v("DNS首先会查看浏览器DNS缓存，没有就查询计算机本地DNS缓存，还没有就询问递归式DNS服务器（即网络提供商，一般这个服务器都会有自己的缓存，所以IP查询一般在这里完成），如果没有缓存，那就需要通过根域名和TLD域名服务器指到对应的权威DNS服务器找回记录，并缓存到递归式服务器，然后递归服务器在将记录返回给本地。")]),v._v(" "),l("li",[v._v("有了IP地址，此时网络层便会通过IP地址寻的对应服务器的物理地址")]),v._v(" "),l("li",[v._v("寻得服务器地址，客户端在网络传输层便可以和服务器通过三次握手建立tcpip连接")]),v._v(" "),l("li",[v._v("连接建立后网络数据链路层将数据包装成帧；")]),v._v(" "),l("li",[v._v("最后物理层利用物理介质进行传输；")]),v._v(" "),l("li",[v._v("到了服务器，就会通过相反的方式将数据一层一层的还原回去；")]),v._v(" "),l("li",[v._v("请求到了后台服务器，一般会有统一的验证，如安全验证、跨域验证等，验证未通过就直接返回相应的http报文")]),v._v(" "),l("li",[v._v("验证通过后，就会进入后台代码，此时程序收到请求，然后执行对应的操作（如查询数据库等）；")]),v._v(" "),l("li",[v._v("如果浏览器访问过，且缓存上有对应的资源，便会与服务器最后修改时间对比，一致便返回304，告诉浏览器可使用本地缓存；")]),v._v(" "),l("li",[v._v("前端浏览器接收到响应成功的报文后便开始下载网页")]),v._v(" "),l("li",[v._v("下载完的网页将被交给浏览器内核（渲染进程）进行处理：\n"),l("ol",[l("li",[v._v("根据顶部定义的DTD类型进行对应的解析方式；")]),v._v(" "),l("li",[v._v("渲染进程内部是多线程的，网页的解析将会被交给内部的GUI渲染线程处理；")]),v._v(" "),l("li",[v._v("首先渲染线程中的HTML解释器，将HTML网页和资源从字节流解释转换成字符流；")]),v._v(" "),l("li",[v._v("再通过词法分析器将字符流解释成词语；")]),v._v(" "),l("li",[v._v("之后经过语法分析器根据词语构建成节点；最后通过这些节点组建一个DOM树；")]),v._v(" "),l("li",[v._v("这个过程中，如果遇到的DOM节点是JavaScript代码，就会调用JavaScript引擎对JavaScript代码进行解释执行，此时由JavaScript引擎和GUI渲染线程的互斥，GUI渲染线程就会被挂起，渲染过程停止；如果JavaScript代码的运行中对DOM树进行了修改，那么DOM的构建需要从新开始；")]),v._v(" "),l("li",[v._v("如果节点需要依赖其他资源，如（图片，CSS等），便会调用网络模块的资源加载器来加载它们，但它们是异步的，不会阻塞当前DOM树的构建；")]),v._v(" "),l("li",[v._v("如果遇到的是JavaScript资源URL（没有标记异步），则需要停止当前DOM的构建，直到JavaScript的资源加载并被JavaScript引擎执行后才继续构建DOM；")]),v._v(" "),l("li",[v._v("对于CSS，CSS解释器会将CSS文件解释成内部表示结构，生成CSS规则树；")]),v._v(" "),l("li",[v._v("然后合并CSS规则树和DOM树，生成render渲染树；")]),v._v(" "),l("li",[v._v("最后对render树进行布局和绘制，并将结果通过IO线程传递给Browser控制进程进行显示。")])])])])])}),[],!1,null,null,null);_.default=t.exports}}]);