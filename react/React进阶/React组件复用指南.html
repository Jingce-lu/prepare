<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>React组件复用指南 | Lu notes</title>
    <meta name="description" content=" ">
    <link rel=" " href=" ">
    
    <link rel="preload" href="/prepare/assets/css/0.styles.080a75b5.css" as="style"><link rel="preload" href="/prepare/assets/js/app.fc97b764.js" as="script"><link rel="preload" href="/prepare/assets/js/2.df88221a.js" as="script"><link rel="preload" href="/prepare/assets/js/540.7e78812b.js" as="script"><link rel="prefetch" href="/prepare/assets/js/10.442f1fc5.js"><link rel="prefetch" href="/prepare/assets/js/100.14f64daa.js"><link rel="prefetch" href="/prepare/assets/js/101.08c816ba.js"><link rel="prefetch" href="/prepare/assets/js/102.75954b8d.js"><link rel="prefetch" href="/prepare/assets/js/103.f07a1a73.js"><link rel="prefetch" href="/prepare/assets/js/104.38a0a2db.js"><link rel="prefetch" href="/prepare/assets/js/105.1165f8d4.js"><link rel="prefetch" href="/prepare/assets/js/106.bd44a1cb.js"><link rel="prefetch" href="/prepare/assets/js/107.648515e5.js"><link rel="prefetch" href="/prepare/assets/js/108.c89e3d00.js"><link rel="prefetch" href="/prepare/assets/js/109.807ec5a8.js"><link rel="prefetch" href="/prepare/assets/js/11.cd2a97ef.js"><link rel="prefetch" href="/prepare/assets/js/110.f32f0344.js"><link rel="prefetch" href="/prepare/assets/js/111.29d4cde6.js"><link rel="prefetch" href="/prepare/assets/js/112.d1403ab5.js"><link rel="prefetch" href="/prepare/assets/js/113.aace951e.js"><link rel="prefetch" href="/prepare/assets/js/114.87472f0b.js"><link rel="prefetch" href="/prepare/assets/js/115.ca09de7b.js"><link rel="prefetch" href="/prepare/assets/js/116.04b7cbb7.js"><link rel="prefetch" href="/prepare/assets/js/117.a997b001.js"><link rel="prefetch" href="/prepare/assets/js/118.929eba63.js"><link rel="prefetch" href="/prepare/assets/js/119.678ae8a7.js"><link rel="prefetch" href="/prepare/assets/js/12.b330362f.js"><link rel="prefetch" href="/prepare/assets/js/120.d74c0340.js"><link rel="prefetch" href="/prepare/assets/js/121.681bda87.js"><link rel="prefetch" href="/prepare/assets/js/122.e9c1ac50.js"><link rel="prefetch" href="/prepare/assets/js/123.6b8eced2.js"><link rel="prefetch" href="/prepare/assets/js/124.828a6255.js"><link rel="prefetch" href="/prepare/assets/js/125.9014d997.js"><link rel="prefetch" href="/prepare/assets/js/126.69f28474.js"><link rel="prefetch" href="/prepare/assets/js/127.8b28030f.js"><link rel="prefetch" href="/prepare/assets/js/128.b641adb5.js"><link rel="prefetch" href="/prepare/assets/js/129.ccaed8f4.js"><link rel="prefetch" href="/prepare/assets/js/13.1278de07.js"><link rel="prefetch" href="/prepare/assets/js/130.bd8064e4.js"><link rel="prefetch" href="/prepare/assets/js/131.d50daaf0.js"><link rel="prefetch" href="/prepare/assets/js/132.563c3581.js"><link rel="prefetch" href="/prepare/assets/js/133.71e89464.js"><link rel="prefetch" href="/prepare/assets/js/134.41086874.js"><link rel="prefetch" href="/prepare/assets/js/135.6dff9d9b.js"><link rel="prefetch" href="/prepare/assets/js/136.d3d5d8a3.js"><link rel="prefetch" href="/prepare/assets/js/137.0fdfd912.js"><link rel="prefetch" href="/prepare/assets/js/138.14a9be2d.js"><link rel="prefetch" href="/prepare/assets/js/139.cc6ec2ba.js"><link rel="prefetch" href="/prepare/assets/js/14.91e634a5.js"><link rel="prefetch" href="/prepare/assets/js/140.c8c318f0.js"><link rel="prefetch" href="/prepare/assets/js/141.64f1c6b5.js"><link rel="prefetch" href="/prepare/assets/js/142.32d4aefa.js"><link rel="prefetch" href="/prepare/assets/js/143.ec1dad86.js"><link rel="prefetch" href="/prepare/assets/js/144.8fe78fad.js"><link rel="prefetch" href="/prepare/assets/js/145.95fbff34.js"><link rel="prefetch" href="/prepare/assets/js/146.89a9f5f4.js"><link rel="prefetch" href="/prepare/assets/js/147.8eed692b.js"><link rel="prefetch" href="/prepare/assets/js/148.30ec0b02.js"><link rel="prefetch" href="/prepare/assets/js/149.1c016ae1.js"><link rel="prefetch" href="/prepare/assets/js/15.cac92205.js"><link rel="prefetch" href="/prepare/assets/js/150.d3cd9225.js"><link rel="prefetch" href="/prepare/assets/js/151.02f8a81b.js"><link rel="prefetch" href="/prepare/assets/js/152.19a01c78.js"><link rel="prefetch" href="/prepare/assets/js/153.631c846b.js"><link rel="prefetch" href="/prepare/assets/js/154.77b911cc.js"><link rel="prefetch" href="/prepare/assets/js/155.298715e7.js"><link rel="prefetch" href="/prepare/assets/js/156.e4686166.js"><link rel="prefetch" href="/prepare/assets/js/157.4181d3b5.js"><link rel="prefetch" href="/prepare/assets/js/158.db2f8c04.js"><link rel="prefetch" href="/prepare/assets/js/159.14255a33.js"><link rel="prefetch" href="/prepare/assets/js/16.539b3432.js"><link rel="prefetch" href="/prepare/assets/js/160.65d8926d.js"><link rel="prefetch" href="/prepare/assets/js/161.b2223e92.js"><link rel="prefetch" href="/prepare/assets/js/162.b1ff5f45.js"><link rel="prefetch" href="/prepare/assets/js/163.5dba0ea0.js"><link rel="prefetch" href="/prepare/assets/js/164.e096cb52.js"><link rel="prefetch" href="/prepare/assets/js/165.7cd8f1ba.js"><link rel="prefetch" href="/prepare/assets/js/166.d877586c.js"><link rel="prefetch" href="/prepare/assets/js/167.d28450cb.js"><link rel="prefetch" href="/prepare/assets/js/168.eb091bc1.js"><link rel="prefetch" href="/prepare/assets/js/169.a26dd498.js"><link rel="prefetch" href="/prepare/assets/js/17.f88d7805.js"><link rel="prefetch" href="/prepare/assets/js/170.5b46fb79.js"><link rel="prefetch" href="/prepare/assets/js/171.fd192fbf.js"><link rel="prefetch" href="/prepare/assets/js/172.f727ac0a.js"><link rel="prefetch" href="/prepare/assets/js/173.0998e52d.js"><link rel="prefetch" href="/prepare/assets/js/174.2a4e7bb2.js"><link rel="prefetch" href="/prepare/assets/js/175.fe126019.js"><link rel="prefetch" href="/prepare/assets/js/176.5d503af2.js"><link rel="prefetch" href="/prepare/assets/js/177.8e748403.js"><link rel="prefetch" href="/prepare/assets/js/178.a2b1a493.js"><link rel="prefetch" href="/prepare/assets/js/179.0cc507d4.js"><link rel="prefetch" href="/prepare/assets/js/18.b4a5445b.js"><link rel="prefetch" href="/prepare/assets/js/180.01278ba6.js"><link rel="prefetch" href="/prepare/assets/js/181.cfe7eeb5.js"><link rel="prefetch" href="/prepare/assets/js/182.6fe8ae66.js"><link rel="prefetch" href="/prepare/assets/js/183.4180a2f0.js"><link rel="prefetch" href="/prepare/assets/js/184.75164c74.js"><link rel="prefetch" href="/prepare/assets/js/185.e4c73d3a.js"><link rel="prefetch" href="/prepare/assets/js/186.0b9b4780.js"><link rel="prefetch" href="/prepare/assets/js/187.9d60c24e.js"><link rel="prefetch" href="/prepare/assets/js/188.4ddd0d72.js"><link rel="prefetch" href="/prepare/assets/js/189.7529fd71.js"><link rel="prefetch" href="/prepare/assets/js/19.5fad194b.js"><link rel="prefetch" href="/prepare/assets/js/190.36e2c33e.js"><link rel="prefetch" href="/prepare/assets/js/191.d789714b.js"><link rel="prefetch" href="/prepare/assets/js/192.240f8a76.js"><link rel="prefetch" href="/prepare/assets/js/193.51a669a1.js"><link rel="prefetch" href="/prepare/assets/js/194.1111c58f.js"><link rel="prefetch" href="/prepare/assets/js/195.edee3d58.js"><link rel="prefetch" href="/prepare/assets/js/196.d7e3e5b3.js"><link rel="prefetch" href="/prepare/assets/js/197.93a51ad8.js"><link rel="prefetch" href="/prepare/assets/js/198.20b35f83.js"><link rel="prefetch" href="/prepare/assets/js/199.d0088720.js"><link rel="prefetch" href="/prepare/assets/js/20.b634e488.js"><link rel="prefetch" href="/prepare/assets/js/200.e9cf0c1a.js"><link rel="prefetch" href="/prepare/assets/js/201.c6154aac.js"><link rel="prefetch" href="/prepare/assets/js/202.7517064d.js"><link rel="prefetch" href="/prepare/assets/js/203.79ed8409.js"><link rel="prefetch" href="/prepare/assets/js/204.097b9ec1.js"><link rel="prefetch" href="/prepare/assets/js/205.ad4771c6.js"><link rel="prefetch" href="/prepare/assets/js/206.dc5fd43e.js"><link rel="prefetch" href="/prepare/assets/js/207.4c394767.js"><link rel="prefetch" href="/prepare/assets/js/208.a8bc9c03.js"><link rel="prefetch" href="/prepare/assets/js/209.7e353703.js"><link rel="prefetch" href="/prepare/assets/js/21.f064f2c6.js"><link rel="prefetch" href="/prepare/assets/js/210.ffa51d4b.js"><link rel="prefetch" href="/prepare/assets/js/211.f247c4ca.js"><link rel="prefetch" href="/prepare/assets/js/212.dffa06e5.js"><link rel="prefetch" href="/prepare/assets/js/213.31ff9e84.js"><link rel="prefetch" href="/prepare/assets/js/214.526cde41.js"><link rel="prefetch" href="/prepare/assets/js/215.00ff114b.js"><link rel="prefetch" href="/prepare/assets/js/216.46b63fdf.js"><link rel="prefetch" href="/prepare/assets/js/217.411aeeb3.js"><link rel="prefetch" href="/prepare/assets/js/218.5a5c00eb.js"><link rel="prefetch" href="/prepare/assets/js/219.c9628d78.js"><link rel="prefetch" href="/prepare/assets/js/22.c9fbe411.js"><link rel="prefetch" href="/prepare/assets/js/220.12acd342.js"><link rel="prefetch" href="/prepare/assets/js/221.ac9332d9.js"><link rel="prefetch" href="/prepare/assets/js/222.7d4f0252.js"><link rel="prefetch" href="/prepare/assets/js/223.d948ab26.js"><link rel="prefetch" href="/prepare/assets/js/224.aac66226.js"><link rel="prefetch" href="/prepare/assets/js/225.6520bb20.js"><link rel="prefetch" href="/prepare/assets/js/226.7d5ff937.js"><link rel="prefetch" href="/prepare/assets/js/227.11ae8f6c.js"><link rel="prefetch" href="/prepare/assets/js/228.a6cc68f8.js"><link rel="prefetch" href="/prepare/assets/js/229.783417ff.js"><link rel="prefetch" href="/prepare/assets/js/23.76d84253.js"><link rel="prefetch" href="/prepare/assets/js/230.066d67f2.js"><link rel="prefetch" href="/prepare/assets/js/231.60650705.js"><link rel="prefetch" href="/prepare/assets/js/232.419afdbd.js"><link rel="prefetch" href="/prepare/assets/js/233.82c68dcf.js"><link rel="prefetch" href="/prepare/assets/js/234.b52cd204.js"><link rel="prefetch" href="/prepare/assets/js/235.281b5618.js"><link rel="prefetch" href="/prepare/assets/js/236.cf634687.js"><link rel="prefetch" href="/prepare/assets/js/237.6eabcae7.js"><link rel="prefetch" href="/prepare/assets/js/238.ff2c95b7.js"><link rel="prefetch" href="/prepare/assets/js/239.b76f518c.js"><link rel="prefetch" href="/prepare/assets/js/24.91073e02.js"><link rel="prefetch" href="/prepare/assets/js/240.fb6c7fa9.js"><link rel="prefetch" href="/prepare/assets/js/241.6c621307.js"><link rel="prefetch" href="/prepare/assets/js/242.dd2e31f1.js"><link rel="prefetch" href="/prepare/assets/js/243.3665f009.js"><link rel="prefetch" href="/prepare/assets/js/244.2e586860.js"><link rel="prefetch" href="/prepare/assets/js/245.d0a5efb7.js"><link rel="prefetch" href="/prepare/assets/js/246.a7dc0e2b.js"><link rel="prefetch" href="/prepare/assets/js/247.1234f9df.js"><link rel="prefetch" href="/prepare/assets/js/248.24ac5da6.js"><link rel="prefetch" href="/prepare/assets/js/249.fbe2912b.js"><link rel="prefetch" href="/prepare/assets/js/25.64f6c154.js"><link rel="prefetch" href="/prepare/assets/js/250.a793c1fe.js"><link rel="prefetch" href="/prepare/assets/js/251.33c0ae1e.js"><link rel="prefetch" href="/prepare/assets/js/252.ea45974b.js"><link rel="prefetch" href="/prepare/assets/js/253.549f99c5.js"><link rel="prefetch" href="/prepare/assets/js/254.e97a7c42.js"><link rel="prefetch" href="/prepare/assets/js/255.864f9b49.js"><link rel="prefetch" href="/prepare/assets/js/256.f00e1aeb.js"><link rel="prefetch" href="/prepare/assets/js/257.7d488eeb.js"><link rel="prefetch" href="/prepare/assets/js/258.629e3f7b.js"><link rel="prefetch" href="/prepare/assets/js/259.38332611.js"><link rel="prefetch" href="/prepare/assets/js/26.8cedf695.js"><link rel="prefetch" href="/prepare/assets/js/260.df7106b0.js"><link rel="prefetch" href="/prepare/assets/js/261.7a01c48c.js"><link rel="prefetch" href="/prepare/assets/js/262.01b7bb88.js"><link rel="prefetch" href="/prepare/assets/js/263.a8678e2c.js"><link rel="prefetch" href="/prepare/assets/js/264.57cc3706.js"><link rel="prefetch" href="/prepare/assets/js/265.69e8d462.js"><link rel="prefetch" href="/prepare/assets/js/266.af2c9d5f.js"><link rel="prefetch" href="/prepare/assets/js/267.31e31700.js"><link rel="prefetch" href="/prepare/assets/js/268.69c37cb7.js"><link rel="prefetch" href="/prepare/assets/js/269.cfe84c36.js"><link rel="prefetch" href="/prepare/assets/js/27.35031a05.js"><link rel="prefetch" href="/prepare/assets/js/270.2496a7bf.js"><link rel="prefetch" href="/prepare/assets/js/271.400fdb44.js"><link rel="prefetch" href="/prepare/assets/js/272.7475dd93.js"><link rel="prefetch" href="/prepare/assets/js/273.c9e2a9f4.js"><link rel="prefetch" href="/prepare/assets/js/274.8dac74a6.js"><link rel="prefetch" href="/prepare/assets/js/275.02e69847.js"><link rel="prefetch" href="/prepare/assets/js/276.04e2dd8e.js"><link rel="prefetch" href="/prepare/assets/js/277.e12f2f05.js"><link rel="prefetch" href="/prepare/assets/js/278.79d41e60.js"><link rel="prefetch" href="/prepare/assets/js/279.78e65e72.js"><link rel="prefetch" href="/prepare/assets/js/28.a4d31af6.js"><link rel="prefetch" href="/prepare/assets/js/280.59476266.js"><link rel="prefetch" href="/prepare/assets/js/281.2d268a7f.js"><link rel="prefetch" href="/prepare/assets/js/282.15455c23.js"><link rel="prefetch" href="/prepare/assets/js/283.058688b6.js"><link rel="prefetch" href="/prepare/assets/js/284.785c5d17.js"><link rel="prefetch" href="/prepare/assets/js/285.fec8513b.js"><link rel="prefetch" href="/prepare/assets/js/286.0630c47c.js"><link rel="prefetch" href="/prepare/assets/js/287.68d51a7e.js"><link rel="prefetch" href="/prepare/assets/js/288.0a2573d9.js"><link rel="prefetch" href="/prepare/assets/js/289.47877213.js"><link rel="prefetch" href="/prepare/assets/js/29.4af0c594.js"><link rel="prefetch" href="/prepare/assets/js/290.03f204c4.js"><link rel="prefetch" href="/prepare/assets/js/291.4e9cdc1c.js"><link rel="prefetch" href="/prepare/assets/js/292.102331e0.js"><link rel="prefetch" href="/prepare/assets/js/293.0b1fcc25.js"><link rel="prefetch" href="/prepare/assets/js/294.1a1e199d.js"><link rel="prefetch" href="/prepare/assets/js/295.21c745c1.js"><link rel="prefetch" href="/prepare/assets/js/296.f6e25fe9.js"><link rel="prefetch" href="/prepare/assets/js/297.28ff6518.js"><link rel="prefetch" href="/prepare/assets/js/298.046b3580.js"><link rel="prefetch" href="/prepare/assets/js/299.a73a1313.js"><link rel="prefetch" href="/prepare/assets/js/3.08575337.js"><link rel="prefetch" href="/prepare/assets/js/30.8bd066f9.js"><link rel="prefetch" href="/prepare/assets/js/300.3f1a1857.js"><link rel="prefetch" href="/prepare/assets/js/301.3c56400b.js"><link rel="prefetch" href="/prepare/assets/js/302.65153e17.js"><link rel="prefetch" href="/prepare/assets/js/303.6e65c880.js"><link rel="prefetch" href="/prepare/assets/js/304.60918c37.js"><link rel="prefetch" href="/prepare/assets/js/305.0f2f93f3.js"><link rel="prefetch" href="/prepare/assets/js/306.0baf8298.js"><link rel="prefetch" href="/prepare/assets/js/307.56b7cc57.js"><link rel="prefetch" href="/prepare/assets/js/308.248f1bd3.js"><link rel="prefetch" href="/prepare/assets/js/309.195eb1cf.js"><link rel="prefetch" href="/prepare/assets/js/31.134e90e4.js"><link rel="prefetch" href="/prepare/assets/js/310.2f389eff.js"><link rel="prefetch" href="/prepare/assets/js/311.8cfc7812.js"><link rel="prefetch" href="/prepare/assets/js/312.47640b96.js"><link rel="prefetch" href="/prepare/assets/js/313.bbee76eb.js"><link rel="prefetch" href="/prepare/assets/js/314.55abc171.js"><link rel="prefetch" href="/prepare/assets/js/315.ab9cce93.js"><link rel="prefetch" href="/prepare/assets/js/316.b809f0dc.js"><link rel="prefetch" href="/prepare/assets/js/317.af7ed8c0.js"><link rel="prefetch" href="/prepare/assets/js/318.2895c8d7.js"><link rel="prefetch" href="/prepare/assets/js/319.0148376c.js"><link rel="prefetch" href="/prepare/assets/js/32.e9a6b791.js"><link rel="prefetch" href="/prepare/assets/js/320.1c52a12b.js"><link rel="prefetch" href="/prepare/assets/js/321.5040f30b.js"><link rel="prefetch" href="/prepare/assets/js/322.ef25c13c.js"><link rel="prefetch" href="/prepare/assets/js/323.fd2fb827.js"><link rel="prefetch" href="/prepare/assets/js/324.f80e7b95.js"><link rel="prefetch" href="/prepare/assets/js/325.3f3e1a8a.js"><link rel="prefetch" href="/prepare/assets/js/326.4f8e65aa.js"><link rel="prefetch" href="/prepare/assets/js/327.22a39fc9.js"><link rel="prefetch" href="/prepare/assets/js/328.7994b71f.js"><link rel="prefetch" href="/prepare/assets/js/329.5150c3b7.js"><link rel="prefetch" href="/prepare/assets/js/33.8b822516.js"><link rel="prefetch" href="/prepare/assets/js/330.ba369000.js"><link rel="prefetch" href="/prepare/assets/js/331.1c15dc66.js"><link rel="prefetch" href="/prepare/assets/js/332.4c0057ba.js"><link rel="prefetch" href="/prepare/assets/js/333.87341288.js"><link rel="prefetch" href="/prepare/assets/js/334.f23460f5.js"><link rel="prefetch" href="/prepare/assets/js/335.492d26b5.js"><link rel="prefetch" href="/prepare/assets/js/336.bbded9dc.js"><link rel="prefetch" href="/prepare/assets/js/337.4f4aba88.js"><link rel="prefetch" href="/prepare/assets/js/338.cb5306fe.js"><link rel="prefetch" href="/prepare/assets/js/339.c3f0e586.js"><link rel="prefetch" href="/prepare/assets/js/34.3c0efde9.js"><link rel="prefetch" href="/prepare/assets/js/340.5cf9a827.js"><link rel="prefetch" href="/prepare/assets/js/341.dd30c91c.js"><link rel="prefetch" href="/prepare/assets/js/342.b0b59380.js"><link rel="prefetch" href="/prepare/assets/js/343.7ecddb3a.js"><link rel="prefetch" href="/prepare/assets/js/344.aa9889f4.js"><link rel="prefetch" href="/prepare/assets/js/345.ea4a61c4.js"><link rel="prefetch" href="/prepare/assets/js/346.a9de3a40.js"><link rel="prefetch" href="/prepare/assets/js/347.ad1c5006.js"><link rel="prefetch" href="/prepare/assets/js/348.18056568.js"><link rel="prefetch" href="/prepare/assets/js/349.81e3da50.js"><link rel="prefetch" href="/prepare/assets/js/35.3f918e70.js"><link rel="prefetch" href="/prepare/assets/js/350.e218d543.js"><link rel="prefetch" href="/prepare/assets/js/351.e0a8c142.js"><link rel="prefetch" href="/prepare/assets/js/352.8e00367e.js"><link rel="prefetch" href="/prepare/assets/js/353.ceb4ef0a.js"><link rel="prefetch" href="/prepare/assets/js/354.ad500b54.js"><link rel="prefetch" href="/prepare/assets/js/355.3508830e.js"><link rel="prefetch" href="/prepare/assets/js/356.94e494bf.js"><link rel="prefetch" href="/prepare/assets/js/357.e89d1d04.js"><link rel="prefetch" href="/prepare/assets/js/358.87622e29.js"><link rel="prefetch" href="/prepare/assets/js/359.71cfe8f4.js"><link rel="prefetch" href="/prepare/assets/js/36.7b540d91.js"><link rel="prefetch" href="/prepare/assets/js/360.5477c5f1.js"><link rel="prefetch" href="/prepare/assets/js/361.6f2cf59f.js"><link rel="prefetch" href="/prepare/assets/js/362.d722b18e.js"><link rel="prefetch" href="/prepare/assets/js/363.f600dba6.js"><link rel="prefetch" href="/prepare/assets/js/364.897d0cad.js"><link rel="prefetch" href="/prepare/assets/js/365.511a64ec.js"><link rel="prefetch" href="/prepare/assets/js/366.9e3c1726.js"><link rel="prefetch" href="/prepare/assets/js/367.15d0ddae.js"><link rel="prefetch" href="/prepare/assets/js/368.18aa1488.js"><link rel="prefetch" href="/prepare/assets/js/369.3b4401ae.js"><link rel="prefetch" href="/prepare/assets/js/37.1a7e194a.js"><link rel="prefetch" href="/prepare/assets/js/370.844de3b6.js"><link rel="prefetch" href="/prepare/assets/js/371.ea53c7e8.js"><link rel="prefetch" href="/prepare/assets/js/372.e022d9fe.js"><link rel="prefetch" href="/prepare/assets/js/373.7d3db6a8.js"><link rel="prefetch" href="/prepare/assets/js/374.47fcc0d0.js"><link rel="prefetch" href="/prepare/assets/js/375.bfc37979.js"><link rel="prefetch" href="/prepare/assets/js/376.ddc65c3e.js"><link rel="prefetch" href="/prepare/assets/js/377.16097a0a.js"><link rel="prefetch" href="/prepare/assets/js/378.a70c8ab3.js"><link rel="prefetch" href="/prepare/assets/js/379.7fc2ccb6.js"><link rel="prefetch" href="/prepare/assets/js/38.0549b1ce.js"><link rel="prefetch" href="/prepare/assets/js/380.7cb0b7f1.js"><link rel="prefetch" href="/prepare/assets/js/381.66b81e8d.js"><link rel="prefetch" href="/prepare/assets/js/382.9fe5310c.js"><link rel="prefetch" href="/prepare/assets/js/383.3ff2b73e.js"><link rel="prefetch" href="/prepare/assets/js/384.c4a11d43.js"><link rel="prefetch" href="/prepare/assets/js/385.c7a5256e.js"><link rel="prefetch" href="/prepare/assets/js/386.2bb3fa00.js"><link rel="prefetch" href="/prepare/assets/js/387.1c6eaa29.js"><link rel="prefetch" href="/prepare/assets/js/388.ed2edc5a.js"><link rel="prefetch" href="/prepare/assets/js/389.47a5be15.js"><link rel="prefetch" href="/prepare/assets/js/39.75f92fc1.js"><link rel="prefetch" href="/prepare/assets/js/390.29f27a7c.js"><link rel="prefetch" href="/prepare/assets/js/391.4107c271.js"><link rel="prefetch" href="/prepare/assets/js/392.3f880f83.js"><link rel="prefetch" href="/prepare/assets/js/393.848bdc58.js"><link rel="prefetch" href="/prepare/assets/js/394.a5ec97f0.js"><link rel="prefetch" href="/prepare/assets/js/395.baf7c3e9.js"><link rel="prefetch" href="/prepare/assets/js/396.83e537b0.js"><link rel="prefetch" href="/prepare/assets/js/397.d0fe788c.js"><link rel="prefetch" href="/prepare/assets/js/398.43eed7e8.js"><link rel="prefetch" href="/prepare/assets/js/399.022acc83.js"><link rel="prefetch" href="/prepare/assets/js/4.3167eea1.js"><link rel="prefetch" href="/prepare/assets/js/40.80d1fff7.js"><link rel="prefetch" href="/prepare/assets/js/400.9728cdb9.js"><link rel="prefetch" href="/prepare/assets/js/401.bdc0b9ec.js"><link rel="prefetch" href="/prepare/assets/js/402.1a008140.js"><link rel="prefetch" href="/prepare/assets/js/403.21afc774.js"><link rel="prefetch" href="/prepare/assets/js/404.b5d81952.js"><link rel="prefetch" href="/prepare/assets/js/405.8999abaf.js"><link rel="prefetch" href="/prepare/assets/js/406.52d3d6c7.js"><link rel="prefetch" href="/prepare/assets/js/407.cddd8fe9.js"><link rel="prefetch" href="/prepare/assets/js/408.136ac4b8.js"><link rel="prefetch" href="/prepare/assets/js/409.b65e582d.js"><link rel="prefetch" href="/prepare/assets/js/41.b41373df.js"><link rel="prefetch" href="/prepare/assets/js/410.b4cec35c.js"><link rel="prefetch" href="/prepare/assets/js/411.0a8e1302.js"><link rel="prefetch" href="/prepare/assets/js/412.80ab8863.js"><link rel="prefetch" href="/prepare/assets/js/413.b54f9fa2.js"><link rel="prefetch" href="/prepare/assets/js/414.7f3256cf.js"><link rel="prefetch" href="/prepare/assets/js/415.16dd11b2.js"><link rel="prefetch" href="/prepare/assets/js/416.63544b17.js"><link rel="prefetch" href="/prepare/assets/js/417.9d25e28c.js"><link rel="prefetch" href="/prepare/assets/js/418.0ecb132e.js"><link rel="prefetch" href="/prepare/assets/js/419.4ab16fd4.js"><link rel="prefetch" href="/prepare/assets/js/42.d7536485.js"><link rel="prefetch" href="/prepare/assets/js/420.60396cab.js"><link rel="prefetch" href="/prepare/assets/js/421.86aaff5f.js"><link rel="prefetch" href="/prepare/assets/js/422.5d1b969c.js"><link rel="prefetch" href="/prepare/assets/js/423.caf11813.js"><link rel="prefetch" href="/prepare/assets/js/424.19283fb2.js"><link rel="prefetch" href="/prepare/assets/js/425.fe6566f9.js"><link rel="prefetch" href="/prepare/assets/js/426.3a3970bb.js"><link rel="prefetch" href="/prepare/assets/js/427.82ff36e6.js"><link rel="prefetch" href="/prepare/assets/js/428.8b61795c.js"><link rel="prefetch" href="/prepare/assets/js/429.e499aaa3.js"><link rel="prefetch" href="/prepare/assets/js/43.a0078c9c.js"><link rel="prefetch" href="/prepare/assets/js/430.8b4a096c.js"><link rel="prefetch" href="/prepare/assets/js/431.2350dc54.js"><link rel="prefetch" href="/prepare/assets/js/432.fac0c9f2.js"><link rel="prefetch" href="/prepare/assets/js/433.d7b472e1.js"><link rel="prefetch" href="/prepare/assets/js/434.d9f77ad4.js"><link rel="prefetch" href="/prepare/assets/js/435.0f8fd59e.js"><link rel="prefetch" href="/prepare/assets/js/436.34fbba63.js"><link rel="prefetch" href="/prepare/assets/js/437.96f82233.js"><link rel="prefetch" href="/prepare/assets/js/438.e149d41e.js"><link rel="prefetch" href="/prepare/assets/js/439.5e48ee7e.js"><link rel="prefetch" href="/prepare/assets/js/44.919848cd.js"><link rel="prefetch" href="/prepare/assets/js/440.0215426b.js"><link rel="prefetch" href="/prepare/assets/js/441.df8fce8d.js"><link rel="prefetch" href="/prepare/assets/js/442.78091bf7.js"><link rel="prefetch" href="/prepare/assets/js/443.4c9598ed.js"><link rel="prefetch" href="/prepare/assets/js/444.af0ff36c.js"><link rel="prefetch" href="/prepare/assets/js/445.42e2a462.js"><link rel="prefetch" href="/prepare/assets/js/446.cf6a9ba2.js"><link rel="prefetch" href="/prepare/assets/js/447.b897bc7d.js"><link rel="prefetch" href="/prepare/assets/js/448.13c4137e.js"><link rel="prefetch" href="/prepare/assets/js/449.2f620535.js"><link rel="prefetch" href="/prepare/assets/js/45.91af9a0b.js"><link rel="prefetch" href="/prepare/assets/js/450.6214a69e.js"><link rel="prefetch" href="/prepare/assets/js/451.c23617a4.js"><link rel="prefetch" href="/prepare/assets/js/452.d71d75a3.js"><link rel="prefetch" href="/prepare/assets/js/453.00031d7e.js"><link rel="prefetch" href="/prepare/assets/js/454.248916f3.js"><link rel="prefetch" href="/prepare/assets/js/455.0cd5d7b3.js"><link rel="prefetch" href="/prepare/assets/js/456.c1615e34.js"><link rel="prefetch" href="/prepare/assets/js/457.6a108977.js"><link rel="prefetch" href="/prepare/assets/js/458.221c1d42.js"><link rel="prefetch" href="/prepare/assets/js/459.e48fb9ba.js"><link rel="prefetch" href="/prepare/assets/js/46.9aa9eb2f.js"><link rel="prefetch" href="/prepare/assets/js/460.768243d7.js"><link rel="prefetch" href="/prepare/assets/js/461.7781bd45.js"><link rel="prefetch" href="/prepare/assets/js/462.8bc2b752.js"><link rel="prefetch" href="/prepare/assets/js/463.8077ca28.js"><link rel="prefetch" href="/prepare/assets/js/464.b629f0ac.js"><link rel="prefetch" href="/prepare/assets/js/465.2a7c1bba.js"><link rel="prefetch" href="/prepare/assets/js/466.9315d5e6.js"><link rel="prefetch" href="/prepare/assets/js/467.833c563f.js"><link rel="prefetch" href="/prepare/assets/js/468.e6a0f589.js"><link rel="prefetch" href="/prepare/assets/js/469.6f2bd978.js"><link rel="prefetch" href="/prepare/assets/js/47.874b43a7.js"><link rel="prefetch" href="/prepare/assets/js/470.59760543.js"><link rel="prefetch" href="/prepare/assets/js/471.480f196a.js"><link rel="prefetch" href="/prepare/assets/js/472.b415b4cc.js"><link rel="prefetch" href="/prepare/assets/js/473.da7f19db.js"><link rel="prefetch" href="/prepare/assets/js/474.d5b80211.js"><link rel="prefetch" href="/prepare/assets/js/475.c3f02254.js"><link rel="prefetch" href="/prepare/assets/js/476.0c50fbdc.js"><link rel="prefetch" href="/prepare/assets/js/477.92b36684.js"><link rel="prefetch" href="/prepare/assets/js/478.e3e99571.js"><link rel="prefetch" href="/prepare/assets/js/479.5b117179.js"><link rel="prefetch" href="/prepare/assets/js/48.c3cf1ae6.js"><link rel="prefetch" href="/prepare/assets/js/480.fb3fb0a7.js"><link rel="prefetch" href="/prepare/assets/js/481.1eb2e701.js"><link rel="prefetch" href="/prepare/assets/js/482.7f76b22a.js"><link rel="prefetch" href="/prepare/assets/js/483.a2ca0497.js"><link rel="prefetch" href="/prepare/assets/js/484.1d1ee755.js"><link rel="prefetch" href="/prepare/assets/js/485.b7746e26.js"><link rel="prefetch" href="/prepare/assets/js/486.360a42aa.js"><link rel="prefetch" href="/prepare/assets/js/487.53052372.js"><link rel="prefetch" href="/prepare/assets/js/488.95b47994.js"><link rel="prefetch" href="/prepare/assets/js/489.0e6c31b7.js"><link rel="prefetch" href="/prepare/assets/js/49.65f6c32c.js"><link rel="prefetch" href="/prepare/assets/js/490.45884494.js"><link rel="prefetch" href="/prepare/assets/js/491.82374290.js"><link rel="prefetch" href="/prepare/assets/js/492.ac73f75d.js"><link rel="prefetch" href="/prepare/assets/js/493.02b90d30.js"><link rel="prefetch" href="/prepare/assets/js/494.2c979269.js"><link rel="prefetch" href="/prepare/assets/js/495.328e05cc.js"><link rel="prefetch" href="/prepare/assets/js/496.b12aaafa.js"><link rel="prefetch" href="/prepare/assets/js/497.50604b94.js"><link rel="prefetch" href="/prepare/assets/js/498.cec696b6.js"><link rel="prefetch" href="/prepare/assets/js/499.33160b1b.js"><link rel="prefetch" href="/prepare/assets/js/5.1b19945b.js"><link rel="prefetch" href="/prepare/assets/js/50.329f5842.js"><link rel="prefetch" href="/prepare/assets/js/500.87629aaf.js"><link rel="prefetch" href="/prepare/assets/js/501.a0ab0f72.js"><link rel="prefetch" href="/prepare/assets/js/502.4fa2c05d.js"><link rel="prefetch" href="/prepare/assets/js/503.874329a4.js"><link rel="prefetch" href="/prepare/assets/js/504.45093ef5.js"><link rel="prefetch" href="/prepare/assets/js/505.3f122fca.js"><link rel="prefetch" href="/prepare/assets/js/506.4beb1434.js"><link rel="prefetch" href="/prepare/assets/js/507.de9ba156.js"><link rel="prefetch" href="/prepare/assets/js/508.4668ab10.js"><link rel="prefetch" href="/prepare/assets/js/509.9f305cc3.js"><link rel="prefetch" href="/prepare/assets/js/51.62cfb61d.js"><link rel="prefetch" href="/prepare/assets/js/510.4e8a4acf.js"><link rel="prefetch" href="/prepare/assets/js/511.6b66329e.js"><link rel="prefetch" href="/prepare/assets/js/512.a464f2f0.js"><link rel="prefetch" href="/prepare/assets/js/513.14817dd2.js"><link rel="prefetch" href="/prepare/assets/js/514.6ed642c5.js"><link rel="prefetch" href="/prepare/assets/js/515.30099561.js"><link rel="prefetch" href="/prepare/assets/js/516.743590f2.js"><link rel="prefetch" href="/prepare/assets/js/517.8ce64493.js"><link rel="prefetch" href="/prepare/assets/js/518.5d8bf179.js"><link rel="prefetch" href="/prepare/assets/js/519.0bd3905b.js"><link rel="prefetch" href="/prepare/assets/js/52.aaadca0f.js"><link rel="prefetch" href="/prepare/assets/js/520.a0d7c6be.js"><link rel="prefetch" href="/prepare/assets/js/521.20991938.js"><link rel="prefetch" href="/prepare/assets/js/522.00208531.js"><link rel="prefetch" href="/prepare/assets/js/523.01ecbfd5.js"><link rel="prefetch" href="/prepare/assets/js/524.11931635.js"><link rel="prefetch" href="/prepare/assets/js/525.2b6b6d1b.js"><link rel="prefetch" href="/prepare/assets/js/526.cfc570f2.js"><link rel="prefetch" href="/prepare/assets/js/527.6ac96e49.js"><link rel="prefetch" href="/prepare/assets/js/528.8dc1511f.js"><link rel="prefetch" href="/prepare/assets/js/529.9caf4c41.js"><link rel="prefetch" href="/prepare/assets/js/53.7cfa8646.js"><link rel="prefetch" href="/prepare/assets/js/530.f2a2cd84.js"><link rel="prefetch" href="/prepare/assets/js/531.faab5117.js"><link rel="prefetch" href="/prepare/assets/js/532.0f8939d6.js"><link rel="prefetch" href="/prepare/assets/js/533.2ce6bff1.js"><link rel="prefetch" href="/prepare/assets/js/534.bc9934d5.js"><link rel="prefetch" href="/prepare/assets/js/535.632a4260.js"><link rel="prefetch" href="/prepare/assets/js/536.656f53fe.js"><link rel="prefetch" href="/prepare/assets/js/537.871529a2.js"><link rel="prefetch" href="/prepare/assets/js/538.a536ba9e.js"><link rel="prefetch" href="/prepare/assets/js/539.ac1d01fc.js"><link rel="prefetch" href="/prepare/assets/js/54.6a67479b.js"><link rel="prefetch" href="/prepare/assets/js/541.37226c03.js"><link rel="prefetch" href="/prepare/assets/js/542.cbc474ad.js"><link rel="prefetch" href="/prepare/assets/js/543.a9ff9401.js"><link rel="prefetch" href="/prepare/assets/js/544.44350193.js"><link rel="prefetch" href="/prepare/assets/js/545.e15bcaf2.js"><link rel="prefetch" href="/prepare/assets/js/546.8aea5493.js"><link rel="prefetch" href="/prepare/assets/js/547.878a1b5c.js"><link rel="prefetch" href="/prepare/assets/js/548.b5787a43.js"><link rel="prefetch" href="/prepare/assets/js/549.e5a5cf87.js"><link rel="prefetch" href="/prepare/assets/js/55.dcad84ea.js"><link rel="prefetch" href="/prepare/assets/js/550.1f883949.js"><link rel="prefetch" href="/prepare/assets/js/551.3256f198.js"><link rel="prefetch" href="/prepare/assets/js/552.b8975841.js"><link rel="prefetch" href="/prepare/assets/js/553.edfdd49b.js"><link rel="prefetch" href="/prepare/assets/js/554.7a8e731a.js"><link rel="prefetch" href="/prepare/assets/js/555.c29529ca.js"><link rel="prefetch" href="/prepare/assets/js/556.e817b97c.js"><link rel="prefetch" href="/prepare/assets/js/557.53580959.js"><link rel="prefetch" href="/prepare/assets/js/558.f1f6b2bf.js"><link rel="prefetch" href="/prepare/assets/js/559.ec53bfdc.js"><link rel="prefetch" href="/prepare/assets/js/56.db169fed.js"><link rel="prefetch" href="/prepare/assets/js/560.b489c269.js"><link rel="prefetch" href="/prepare/assets/js/561.3b64b0db.js"><link rel="prefetch" href="/prepare/assets/js/562.3084c5e8.js"><link rel="prefetch" href="/prepare/assets/js/563.fab3967f.js"><link rel="prefetch" href="/prepare/assets/js/564.081e1037.js"><link rel="prefetch" href="/prepare/assets/js/565.1f1f0938.js"><link rel="prefetch" href="/prepare/assets/js/566.6d426bfc.js"><link rel="prefetch" href="/prepare/assets/js/567.3da925cc.js"><link rel="prefetch" href="/prepare/assets/js/568.6501170a.js"><link rel="prefetch" href="/prepare/assets/js/569.f791914e.js"><link rel="prefetch" href="/prepare/assets/js/57.22e07713.js"><link rel="prefetch" href="/prepare/assets/js/570.a521af67.js"><link rel="prefetch" href="/prepare/assets/js/571.b88403d2.js"><link rel="prefetch" href="/prepare/assets/js/572.1d2b3250.js"><link rel="prefetch" href="/prepare/assets/js/573.baa7d3e0.js"><link rel="prefetch" href="/prepare/assets/js/574.c00f3118.js"><link rel="prefetch" href="/prepare/assets/js/575.f751f704.js"><link rel="prefetch" href="/prepare/assets/js/576.43f63088.js"><link rel="prefetch" href="/prepare/assets/js/577.27575ac1.js"><link rel="prefetch" href="/prepare/assets/js/578.cc9accb9.js"><link rel="prefetch" href="/prepare/assets/js/579.9937bd96.js"><link rel="prefetch" href="/prepare/assets/js/58.0dae4bef.js"><link rel="prefetch" href="/prepare/assets/js/580.e3cfde90.js"><link rel="prefetch" href="/prepare/assets/js/581.20212308.js"><link rel="prefetch" href="/prepare/assets/js/582.cdcc6feb.js"><link rel="prefetch" href="/prepare/assets/js/583.b94a4716.js"><link rel="prefetch" href="/prepare/assets/js/584.cbe0afe4.js"><link rel="prefetch" href="/prepare/assets/js/585.b1c02962.js"><link rel="prefetch" href="/prepare/assets/js/586.0ac3edd1.js"><link rel="prefetch" href="/prepare/assets/js/587.ed66d95a.js"><link rel="prefetch" href="/prepare/assets/js/588.40c2136b.js"><link rel="prefetch" href="/prepare/assets/js/589.342113f3.js"><link rel="prefetch" href="/prepare/assets/js/59.f51e3a1f.js"><link rel="prefetch" href="/prepare/assets/js/590.b788c3c0.js"><link rel="prefetch" href="/prepare/assets/js/591.267a4a55.js"><link rel="prefetch" href="/prepare/assets/js/592.46218a27.js"><link rel="prefetch" href="/prepare/assets/js/593.ed995243.js"><link rel="prefetch" href="/prepare/assets/js/594.fdf7b63a.js"><link rel="prefetch" href="/prepare/assets/js/595.89c50f68.js"><link rel="prefetch" href="/prepare/assets/js/596.edfea7d4.js"><link rel="prefetch" href="/prepare/assets/js/597.d7d273bb.js"><link rel="prefetch" href="/prepare/assets/js/598.07bfd3e7.js"><link rel="prefetch" href="/prepare/assets/js/599.f0f07c5c.js"><link rel="prefetch" href="/prepare/assets/js/6.9444d72f.js"><link rel="prefetch" href="/prepare/assets/js/60.70695472.js"><link rel="prefetch" href="/prepare/assets/js/600.f8c9cfa8.js"><link rel="prefetch" href="/prepare/assets/js/601.17cd8cd6.js"><link rel="prefetch" href="/prepare/assets/js/602.09d23d40.js"><link rel="prefetch" href="/prepare/assets/js/603.5c01f8be.js"><link rel="prefetch" href="/prepare/assets/js/604.6172cc4e.js"><link rel="prefetch" href="/prepare/assets/js/605.fe5dec22.js"><link rel="prefetch" href="/prepare/assets/js/606.bee9236d.js"><link rel="prefetch" href="/prepare/assets/js/607.8a014b27.js"><link rel="prefetch" href="/prepare/assets/js/608.0f82f66f.js"><link rel="prefetch" href="/prepare/assets/js/609.3523c706.js"><link rel="prefetch" href="/prepare/assets/js/61.f452eb1e.js"><link rel="prefetch" href="/prepare/assets/js/610.4e35a04b.js"><link rel="prefetch" href="/prepare/assets/js/611.b386a89a.js"><link rel="prefetch" href="/prepare/assets/js/612.bdf99785.js"><link rel="prefetch" href="/prepare/assets/js/613.ad961169.js"><link rel="prefetch" href="/prepare/assets/js/614.7dbd607c.js"><link rel="prefetch" href="/prepare/assets/js/62.537fb957.js"><link rel="prefetch" href="/prepare/assets/js/63.9b6fda45.js"><link rel="prefetch" href="/prepare/assets/js/64.7d5117e3.js"><link rel="prefetch" href="/prepare/assets/js/65.c6817900.js"><link rel="prefetch" href="/prepare/assets/js/66.0d92e78c.js"><link rel="prefetch" href="/prepare/assets/js/67.bfba1dfe.js"><link rel="prefetch" href="/prepare/assets/js/68.01d551fa.js"><link rel="prefetch" href="/prepare/assets/js/69.5e6c1f1e.js"><link rel="prefetch" href="/prepare/assets/js/7.06976092.js"><link rel="prefetch" href="/prepare/assets/js/70.01d73133.js"><link rel="prefetch" href="/prepare/assets/js/71.7c3de2c4.js"><link rel="prefetch" href="/prepare/assets/js/72.e76e5fb2.js"><link rel="prefetch" href="/prepare/assets/js/73.82fabf4c.js"><link rel="prefetch" href="/prepare/assets/js/74.3f28dbee.js"><link rel="prefetch" href="/prepare/assets/js/75.52a9417d.js"><link rel="prefetch" href="/prepare/assets/js/76.66195e23.js"><link rel="prefetch" href="/prepare/assets/js/77.ef053e83.js"><link rel="prefetch" href="/prepare/assets/js/78.3fa1085d.js"><link rel="prefetch" href="/prepare/assets/js/79.29f7ac3c.js"><link rel="prefetch" href="/prepare/assets/js/8.37e468b7.js"><link rel="prefetch" href="/prepare/assets/js/80.ef72de3c.js"><link rel="prefetch" href="/prepare/assets/js/81.b077feaa.js"><link rel="prefetch" href="/prepare/assets/js/82.e231e989.js"><link rel="prefetch" href="/prepare/assets/js/83.3fd80644.js"><link rel="prefetch" href="/prepare/assets/js/84.4ba9fae0.js"><link rel="prefetch" href="/prepare/assets/js/85.f0102a65.js"><link rel="prefetch" href="/prepare/assets/js/86.0dbb6ccf.js"><link rel="prefetch" href="/prepare/assets/js/87.559533ad.js"><link rel="prefetch" href="/prepare/assets/js/88.bc8b8b8f.js"><link rel="prefetch" href="/prepare/assets/js/89.40142912.js"><link rel="prefetch" href="/prepare/assets/js/9.ce5e1110.js"><link rel="prefetch" href="/prepare/assets/js/90.9c39370c.js"><link rel="prefetch" href="/prepare/assets/js/91.0dc7f473.js"><link rel="prefetch" href="/prepare/assets/js/92.0c4fb004.js"><link rel="prefetch" href="/prepare/assets/js/93.61288dd3.js"><link rel="prefetch" href="/prepare/assets/js/94.c76e66d4.js"><link rel="prefetch" href="/prepare/assets/js/95.e9b3d2e2.js"><link rel="prefetch" href="/prepare/assets/js/96.ff539867.js"><link rel="prefetch" href="/prepare/assets/js/97.1f923340.js"><link rel="prefetch" href="/prepare/assets/js/98.7ead62e3.js"><link rel="prefetch" href="/prepare/assets/js/99.700f1951.js">
    <link rel="stylesheet" href="/prepare/assets/css/0.styles.080a75b5.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/prepare/" class="home-link router-link-active"><!----> <span class="site-name">Lu notes</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/prepare/" class="nav-link">首页</a></div><div class="nav-item"><a href="/prepare/js/" class="nav-link">Js</a></div><div class="nav-item"><a href="/prepare/react/" class="nav-link router-link-active">React</a></div><div class="nav-item"><a href="/prepare/vue/" class="nav-link">Vue</a></div><div class="nav-item"><a href="/prepare/framework/" class="nav-link">框架通识</a></div><div class="nav-item"><a href="/prepare/safety/" class="nav-link">安全性能</a></div><div class="nav-item"><a href="/prepare/prepare/" class="nav-link">Prepare</a></div><div class="nav-item"><a href="/prepare/handrolledcode/" class="nav-link">手撸代码无敌</a></div><div class="nav-item"><a href="/prepare/dataalgorithm/" class="nav-link">数据算法</a></div><div class="nav-item"><a href="/prepare/engineering/" class="nav-link">工程化</a></div><div class="nav-item"><a href="/prepare/other/" class="nav-link">其他</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/prepare/" class="nav-link">首页</a></div><div class="nav-item"><a href="/prepare/js/" class="nav-link">Js</a></div><div class="nav-item"><a href="/prepare/react/" class="nav-link router-link-active">React</a></div><div class="nav-item"><a href="/prepare/vue/" class="nav-link">Vue</a></div><div class="nav-item"><a href="/prepare/framework/" class="nav-link">框架通识</a></div><div class="nav-item"><a href="/prepare/safety/" class="nav-link">安全性能</a></div><div class="nav-item"><a href="/prepare/prepare/" class="nav-link">Prepare</a></div><div class="nav-item"><a href="/prepare/handrolledcode/" class="nav-link">手撸代码无敌</a></div><div class="nav-item"><a href="/prepare/dataalgorithm/" class="nav-link">数据算法</a></div><div class="nav-item"><a href="/prepare/engineering/" class="nav-link">工程化</a></div><div class="nav-item"><a href="/prepare/other/" class="nav-link">其他</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><a href="/prepare/react/Dva/" class="sidebar-heading clickable"><span>Dva</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/prepare/react/React-native/" class="sidebar-heading clickable"><span>React-native</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/prepare/react/React基础/" class="sidebar-heading clickable"><span>React基础</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/prepare/react/React进阶/" class="sidebar-heading clickable open"><span>React进阶</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/prepare/react/React进阶/HOC.html" class="sidebar-link">HOC</a></li><li><a href="/prepare/react/React进阶/React-HOC.html" class="sidebar-link">React-HOC</a></li><li><a href="/prepare/react/React进阶/React-Hooks.html" class="sidebar-link">React-Hooks</a></li><li><a href="/prepare/react/React进阶/React-hooks怎么用.html" class="sidebar-link">React-hooks怎么用</a></li><li><a href="/prepare/react/React进阶/React-hooks抽象组件.html" class="sidebar-link">React-hooks抽象组件</a></li><li><a href="/prepare/react/React进阶/React事件处理机制.html" class="sidebar-link">React事件处理机制</a></li><li><a href="/prepare/react/React进阶/React事件机制.html" class="sidebar-link">React事件机制</a></li><li><a href="/prepare/react/React进阶/React实现Toast（提示）效果.html" class="sidebar-link">React实现Toast（提示）效果</a></li><li><a href="/prepare/react/React进阶/React组件复用指南.html" class="active sidebar-link">React组件复用指南</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/prepare/react/React进阶/React组件复用指南.html#高阶组件-hoc" class="sidebar-link">高阶组件(HOC)</a></li><li class="sidebar-sub-header"><a href="/prepare/react/React进阶/React组件复用指南.html#inheritance-inversion-的高阶组件不一定会解析完整子树" class="sidebar-link">Inheritance Inversion 的高阶组件不一定会解析完整子树</a></li><li class="sidebar-sub-header"><a href="/prepare/react/React进阶/React组件复用指南.html#渲染属性-render-props" class="sidebar-link">渲染属性(Render Props)</a></li></ul></li><li><a href="/prepare/react/React进阶/React进阶之路.html" class="sidebar-link">React进阶之路</a></li><li><a href="/prepare/react/React进阶/Ref.html" class="sidebar-link">Ref</a></li><li><a href="/prepare/react/React进阶/setState.html" class="sidebar-link">setState</a></li><li><a href="/prepare/react/React进阶/Throttle和Debounce在React中的应用.html" class="sidebar-link">Throttle和Debounce在React中的应用</a></li><li><a href="/prepare/react/React进阶/实现react服务器渲染基础方法.html" class="sidebar-link">实现react服务器渲染基础方法</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/prepare/react/源码分析/" class="sidebar-heading clickable"><span>源码分析</span> <span class="arrow right"></span></a> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="react组件复用指南"><a href="#react组件复用指南" aria-hidden="true" class="header-anchor">#</a> React组件复用指南</h1> <ul><li><a href="#react%E7%BB%84%E4%BB%B6%E5%A4%8D%E7%94%A8%E6%8C%87%E5%8D%97">React组件复用指南</a> <ul><li><a href="#%E9%AB%98%E9%98%B6%E7%BB%84%E4%BB%B6hoc">高阶组件(HOC)</a> <ul><li><a href="#%E4%BB%80%E4%B9%88%E6%98%AF%E9%AB%98%E9%98%B6%E7%BB%84%E4%BB%B6">什么是高阶组件？</a></li> <li><a href="#hoc-%E5%B7%A5%E5%8E%82%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%96%B9%E6%B3%95">HOC 工厂的实现方法</a> <ul><li><a href="#%E5%B1%9E%E6%80%A7%E4%BB%A3%E7%90%86props-proxy">属性代理(Props Proxy)</a></li></ul></li> <li><a href="#%E5%8F%8D%E5%90%91%E7%BB%A7%E6%89%BFinheritance-inversion">反向继承(Inheritance Inversion)</a></li></ul></li> <li><a href="#_inheritance-inversion-%E7%9A%84%E9%AB%98%E9%98%B6%E7%BB%84%E4%BB%B6%E4%B8%8D%E4%B8%80%E5%AE%9A%E4%BC%9A%E8%A7%A3%E6%9E%90%E5%AE%8C%E6%95%B4%E5%AD%90%E6%A0%91_"><em>Inheritance Inversion 的高阶组件不一定会解析完整子树</em></a> <ul><li><a href="#%E5%91%BD%E5%90%8D">命名</a></li> <li><a href="#%E6%A1%88%E4%BE%8B%E5%88%86%E6%9E%90">案例分析</a></li> <li><a href="#%E9%99%84%E5%BD%95-a-hoc-%E5%92%8C%E5%8F%82%E6%95%B0">附录 A: HOC 和参数</a> <ul><li><a href="#%E9%99%84%E5%BD%95-b-%E4%B8%8E%E7%88%B6%E7%BB%84%E4%BB%B6%E7%9A%84%E4%B8%8D%E5%90%8C">附录 B: 与父组件的不同</a></li></ul></li></ul></li> <li><a href="#%E6%B8%B2%E6%9F%93%E5%B1%9E%E6%80%A7render-props">渲染属性(Render Props)</a> <ul><li><a href="#mixins-%E5%AD%98%E5%9C%A8%E7%9A%84%E9%97%AE%E9%A2%98">Mixins 存在的问题</a></li> <li><a href="#hoc-%E6%98%AF%E6%96%B0%E7%9A%84-mixin">HOC 是新的 Mixin</a></li> <li><a href="#render-props">Render Props</a></li> <li><a href="#render-props--hocs">Render Props &gt; HOCs</a></li></ul></li></ul></li></ul> <h2 id="高阶组件-hoc"><a href="#高阶组件-hoc" aria-hidden="true" class="header-anchor">#</a> 高阶组件(HOC)</h2> <h3 id="什么是高阶组件？"><a href="#什么是高阶组件？" aria-hidden="true" class="header-anchor">#</a> 什么是高阶组件？</h3> <blockquote><p>高阶组件就是一个 React 组件包裹着另外一个 React 组件
这种模式通常使用函数来实现，基本上是一个类工厂（是的，一个类工厂！），它的函数签名可以用类似 haskell 的伪代码表示</p></blockquote> <div class="language-haskell line-numbers-mode"><pre class="language-haskell"><code><span class="token hvariable">hocFactory</span><span class="token operator">::</span> <span class="token constant">W</span><span class="token operator">:</span> <span class="token constant">React.Component</span> <span class="token operator">=&gt;</span> <span class="token constant">E</span><span class="token operator">:</span> <span class="token constant">React.Component</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>其中 W (WrappedComponent) 指被包裹的 React.Component，E (EnhancedComponent) 指返回类型为 React.Component 的新的 HOC。</p> <p>我们有意模糊了定义中“包裹”的概念，因为它可能会有以下两种不同的含义之一：</p> <ol><li>属性代理(Props Proxy)： HOC 对传给 WrappedComponent W 的 porps 进行操作，</li> <li>反向继承(Inheritance Inversion)： HOC 继承 WrappedComponent W。</li></ol> <p>我们会深入地探究这两种模式。</p> <h3 id="hoc-工厂的实现方法"><a href="#hoc-工厂的实现方法" aria-hidden="true" class="header-anchor">#</a> HOC 工厂的实现方法</h3> <p>这一节我们将会研究 React 中两种 HOC 的实现方法：Props Proxy (PP) and Inheritance Inversion (II)。两种方法都可以操作 WrappedComponent。</p> <h4 id="属性代理-props-proxy"><a href="#属性代理-props-proxy" aria-hidden="true" class="header-anchor">#</a> 属性代理(Props Proxy)</h4> <p>Props Proxy (PP) 的最简实现：</p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token keyword">function</span> <span class="token function">ppHOC</span><span class="token punctuation">(</span><span class="token parameter">WrappedComponent</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
  <span class="token keyword">return</span> <span class="token keyword">class</span> <span class="token class-name">PP</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">WrappedComponent</span></span> <span class="token spread"><span class="token punctuation">{</span><span class="token punctuation">...</span><span class="token attr-value">this</span><span class="token punctuation">.</span><span class="token attr-value">props</span><span class="token punctuation">}</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token punctuation">}</span>  
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>这里主要是 HOC 在 render 方法中** 返回** 了一个 <em>WrappedComponent</em> 类型的 React Element。我们还传入了 HOC 接收到的 props，这就是名字 <strong>Props Proxy</strong> 的由来。</p> <p><strong>使用 Props Proxy 可以做什么？</strong></p> <ul><li>操作 props</li> <li>通过 Refs 访问到组件实例</li> <li>提取 state</li> <li>用其他元素包裹 <em>WrappedComponent</em></li></ul> <p><strong>操作 props</strong></p> <p>你可以读取、添加、编辑、删除传给 _WrappedComponent _的 props。</p> <p>当删除或者编辑重要的 props 时要小心，你可能应该通过命名空间确保高阶组件的 props 不会破坏 <em>WrappedComponent</em>。</p> <p>例子：添加新的 props。在这个应用中，当前登录的用户可以在 _WrappedComponent _中通过 <em>this.props.user</em> 访问到。</p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token keyword">function</span> <span class="token function">ppHOC</span><span class="token punctuation">(</span><span class="token parameter">WrappedComponent</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">class</span> <span class="token class-name">PP</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> newProps <span class="token operator">=</span> <span class="token punctuation">{</span>
        user<span class="token punctuation">:</span> currentLoggedInUser
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">WrappedComponent</span></span> <span class="token spread"><span class="token punctuation">{</span><span class="token punctuation">...</span><span class="token attr-value">this</span><span class="token punctuation">.</span><span class="token attr-value">props</span><span class="token punctuation">}</span></span> <span class="token spread"><span class="token punctuation">{</span><span class="token punctuation">...</span><span class="token attr-value">newProps</span><span class="token punctuation">}</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><strong>通过 Refs 访问到组件实例</strong></p> <p>你可以通过_引用_（<em>ref</em>）访问到 <em>this</em> （<em>WrappedComponent</em> 的实例），但为了得到引用，<em>WrappedComponent</em> 还需要一个初始渲染，意味着你需要在 HOC 的 render 方法中返回 <em>WrappedComponent</em> 元素，让 React 开始它的一致化处理，你就可以得到 _WrappedComponent_的实例的引用。</p> <p>例子：如何通过 <a href="https://link.zhihu.com/?target=https%3A//facebook.github.io/react/docs/more-about-refs.html" target="_blank" rel="noopener noreferrer">refs<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 访问到实例的方法和实例本身：</p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token keyword">function</span> <span class="token function">refsHOC</span><span class="token punctuation">(</span><span class="token parameter">WrappedComponent</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">class</span> <span class="token class-name">RefsHOC</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
    <span class="token function">proc</span><span class="token punctuation">(</span><span class="token parameter">wrappedComponentInstance</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      wrappedComponentInstance<span class="token punctuation">.</span><span class="token function">method</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> props <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">,</span> <span class="token punctuation">{</span>ref<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">proc</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">WrappedComponent</span></span> <span class="token spread"><span class="token punctuation">{</span><span class="token punctuation">...</span><span class="token attr-value">props</span><span class="token punctuation">}</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>Ref 的回调函数会在 WrappedComponent 渲染时执行，你就可以得到 _WrappedComponent _的引用。这可以用来读取/添加实例的 props ，调用实例的方法。</p> <p><strong>提取 state</strong></p> <p>你可以通过传入 props 和回调函数把 state 提取出来，类似于 smart component 与 dumb component。</p> <p>提取 state 的例子：提取了 input 的 <em>value</em> 和 <em>onChange</em> 方法。这个简单的例子不是很常规，但足够说明问题。</p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token keyword">function</span> <span class="token function">ppHOC</span><span class="token punctuation">(</span><span class="token parameter">WrappedComponent</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">class</span> <span class="token class-name">PP</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">{</span>
        name<span class="token punctuation">:</span> <span class="token string">''</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>onNameChange <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">onNameChange</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">onNameChange</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        name<span class="token punctuation">:</span> event<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> newProps <span class="token operator">=</span> <span class="token punctuation">{</span>
        name<span class="token punctuation">:</span> <span class="token punctuation">{</span>
          value<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
          onChange<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>onNameChange
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">WrappedComponent</span></span> <span class="token spread"><span class="token punctuation">{</span><span class="token punctuation">...</span><span class="token attr-value">this</span><span class="token punctuation">.</span><span class="token attr-value">props</span><span class="token punctuation">}</span></span> <span class="token spread"><span class="token punctuation">{</span><span class="token punctuation">...</span><span class="token attr-value">newProps</span><span class="token punctuation">}</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p>你可以这样用：</p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code>@ppHOC
<span class="token keyword">class</span> <span class="token class-name">Example</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>name<span class="token punctuation">&quot;</span></span> <span class="token spread"><span class="token punctuation">{</span><span class="token punctuation">...</span><span class="token attr-value">this</span><span class="token punctuation">.</span><span class="token attr-value">props</span><span class="token punctuation">.</span><span class="token attr-value">name</span><span class="token punctuation">}</span></span><span class="token punctuation">/&gt;</span></span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>这个 input 会自动成为<a href="https://reactjs.org/docs/forms.html" target="_blank" rel="noopener noreferrer">受控input<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p> <blockquote><p><strong>更多关于常规的双向绑定 HOC 请点击 <a href="https://github.com/franleplant/react-hoc-examples/blob/master/pp_state.js" target="_blank" rel="noopener noreferrer">链接<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></strong> <strong>用其他元素包裹 WrappedComponent</strong>
为了封装样式、布局或别的目的，你可以用其它组件和元素包裹 <em>WrappedComponent</em>。基本方法是使用父组件（附录 B）实现，但通过 HOC 你可以得到更多灵活性。</p></blockquote> <p>例子：包裹样式</p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token keyword">function</span> <span class="token function">ppHOC</span><span class="token punctuation">(</span><span class="token parameter">WrappedComponent</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">class</span> <span class="token class-name">PP</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>display<span class="token punctuation">:</span> <span class="token string">'block'</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">WrappedComponent</span></span> <span class="token spread"><span class="token punctuation">{</span><span class="token punctuation">...</span><span class="token attr-value">this</span><span class="token punctuation">.</span><span class="token attr-value">props</span><span class="token punctuation">}</span></span><span class="token punctuation">/&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="反向继承-inheritance-inversion"><a href="#反向继承-inheritance-inversion" aria-hidden="true" class="header-anchor">#</a> 反向继承(Inheritance Inversion)</h3> <p>Inheritance Inversion (II) 的最简实现：</p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token keyword">function</span> <span class="token function">iiHOC</span><span class="token punctuation">(</span><span class="token parameter">WrappedComponent</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">class</span> <span class="token class-name">Enhancer</span> <span class="token keyword">extends</span> <span class="token class-name">WrappedComponent</span> <span class="token punctuation">{</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>你可以看到，返回的 HOC 类（Enhancer）<strong>继承</strong>了 <em>WrappedComponent</em>。之所以被称为 Inheritance Inversion 是因为 <em>WrappedComponent</em> 被 <em>Enhancer</em> 继承了，而不是 <em>WrappedComponent</em> 继承了 <em>Enhancer</em>。在这种方式中，它们的关系看上去被**反转（inverse）**了。</p> <p>Inheritance Inversion 允许 HOC 通过 <em>this</em> 访问到 <em>WrappedComponent</em>，意味着<strong>它可以访问到 state、props、组件生命周期方法和 render 方法</strong>。</p> <p>关于生命周期方法可以用来做什么，我不想细说，因为它是 React 的特性而不是 HOC 的特性。但请注意通过 II 你可以创建新的生命周期方法。为了不破坏 <em>WrappedComponent</em>，记得调用 <em>super.[lifecycleHook]</em>。</p> <p><strong>一致化处理（Reconciliation process）</strong></p> <p>开始之前我们先理清一些概念。</p> <p>React 元素决定描述了在 React 执行<a href="https://reactjs.org/blog/2015/12/18/react-components-elements-and-instances.html" target="_blank" rel="noopener noreferrer">一致化<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>处理时它要渲染什么。</p> <p>React 元素有两种类型：字符串和函数。字符串类型的 React 元素代表 DOM 节点，函数类型的 React 元素代表继承 React.Component 的组件。更多关于元素（Element）和组件（Component）请看<a href="https://reactjs.org/blog/2015/12/18/react-components-elements-and-instances.html" target="_blank" rel="noopener noreferrer">这篇文章<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。函数类型的 React 元素会在<a href="https://reactjs.org/docs/reconciliation.html" target="_blank" rel="noopener noreferrer">一致化<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>处理中被解析成一个完全由字符串类型 React 组件组成的树（而最后的结果永远是 DOM 元素）。</p> <p>这很重要，意味着 <strong>Inheritance Inversion 的高阶组件不一定会解析完整子树</strong></p> <h2 id="inheritance-inversion-的高阶组件不一定会解析完整子树"><a href="#inheritance-inversion-的高阶组件不一定会解析完整子树" aria-hidden="true" class="header-anchor">#</a> <em>Inheritance Inversion 的高阶组件不一定会解析完整子树</em></h2> <p>这在学习渲染劫持（Render Highjacking）时非常重要。</p> <p><strong>你可以用 Inheritance Inversion 做什么？</strong></p> <ul><li>渲染劫持（Render Highjacking）</li> <li>操作 state</li></ul> <p><strong>渲染劫持</strong></p> <p>之所以被称为渲染劫持是因为 HOC 控制着 <em>WrappedComponent</em> 的渲染输出，可以用它做各种各样的事。</p> <p>通过渲染劫持你可以：</p> <ul><li>在由 <em>render</em><strong>输出</strong>的任何 React 元素中读取、添加、编辑、删除 props</li> <li>读取和修改由 <em>render</em> 输出的 React 元素树</li> <li>有条件地渲染元素树</li> <li>把样式包裹进元素树（就像在 Props Proxy 中的那样）
<em>*render</em> 指 <em>WrappedComponent</em>.<em>render</em> 方法</li></ul> <blockquote><p><em>你<strong>不能</strong>编辑或添加 WrappedComponent 实例的 props，因为 React 组件不能编辑它接收到的 props，但你<strong>可以</strong>修改由 <strong>render</strong> 方法返回的组件的 props。</em>
就像我们刚才学到的，II 类型的 HOC 不一定会解析完整子树，意味着渲染劫持有一些限制。根据经验，使用渲染劫持你可以完全操作 <em>WrappedComponent</em> 的 render 方法返回的元素树。但是如果元素树包括一个函数类型的 React 组件，你就不能操作它的子组件了。（被 React 的一致化处理推迟到了真正渲染到屏幕时）</p></blockquote> <p>例1：条件渲染。当 <em>this.props.loggedIn</em> 为 true 时，这个 HOC 会完全渲染 _WrappedComponent_的渲染结果。（假设 HOC 接收到了 loggedIn 这个 prop）</p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token keyword">function</span> <span class="token function">iiHOC</span><span class="token punctuation">(</span><span class="token parameter">WrappedComponent</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">class</span> <span class="token class-name">Enhancer</span> <span class="token keyword">extends</span> <span class="token class-name">WrappedComponent</span> <span class="token punctuation">{</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>loggedIn<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>例2：修改由 <em>render</em> 方法输出的 React 组件树。</p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token keyword">function</span> <span class="token function">iiHOC</span><span class="token punctuation">(</span><span class="token parameter">WrappedComponent</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">class</span> <span class="token class-name">Enhancer</span> <span class="token keyword">extends</span> <span class="token class-name">WrappedComponent</span> <span class="token punctuation">{</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> elementsTree <span class="token operator">=</span> <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token keyword">let</span> newProps <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>elementsTree <span class="token operator">&amp;&amp;</span> elementsTree<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token string">'input'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        newProps <span class="token operator">=</span> <span class="token punctuation">{</span>value<span class="token punctuation">:</span> <span class="token string">'may the force be with you'</span><span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">const</span> props <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> elementsTree<span class="token punctuation">.</span>props<span class="token punctuation">,</span> newProps<span class="token punctuation">)</span>
      <span class="token keyword">const</span> newElementsTree <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">cloneElement</span><span class="token punctuation">(</span>elementsTree<span class="token punctuation">,</span> props<span class="token punctuation">,</span> elementsTree<span class="token punctuation">.</span>props<span class="token punctuation">.</span>children<span class="token punctuation">)</span>
      <span class="token keyword">return</span> newElementsTree
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>在这个例子中，如果 <em>WrappedComponent</em> 的输出在最顶层有一个 input，那么就把它的 value 设为 <em>“may the force be with you”</em>。</p> <p>你可以在这里做各种各样的事，你可以遍历整个元素树，然后修改元素树中任何元素的 props。这也正是样式处理库 <a href="http://stack.formidable.com/radium/" target="_blank" rel="noopener noreferrer">Radium<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 所用的方法（案例分析一节中有更多关于 Radium 的信息）。</p> <blockquote><p><em>注：在 Props Proxy 中<strong>不能</strong>做到渲染劫持。</em> <em>虽然通过 WrappedComponent.prototype.render 你可以访问到 render 方法，不过还需要模拟 WrappedComponent 的实例和它的 props，还可能亲自处理组件的生命周期，而不是交给 React。根据我的实验，这么做不值，你要是想做到渲染劫持你应该用 Inheritance Inversion 而不是 Props Proxy。记住，React 在内部处理了组件实例，你处理实例的唯一方法是通过 <strong>this</strong> 或者 refs。</em> <strong>操作 state</strong></p></blockquote> <p>HOC 可以读取、编辑和删除 <em>WrappedComponent</em> 实例的 state，如果你需要，你也可以给它添加更多的 state。记住，这会搞乱 <em>WrappedComponent</em> 的 state，导致你可能会破坏某些东西。要限制 HOC 读取或添加 state，添加 state 时应该放在单独的命名空间里，而不是和 <em>WrappedComponent</em> 的 state 混在一起。</p> <p>例子：通过访问 <em>WrappedComponent</em> 的 props 和 state 来做调试。</p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token constant">IIHOCDEBUGGER</span><span class="token punctuation">(</span><span class="token parameter">WrappedComponent</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">class</span> <span class="token class-name">II</span> <span class="token keyword">extends</span> <span class="token class-name">WrappedComponent</span> <span class="token punctuation">{</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">HOC Debugger Component</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">Props</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text"> </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pre</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pre</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">State</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pre</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pre</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
          </span><span class="token punctuation">{</span><span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>这里 HOC 用其他元素包裹着 <em>WrappedComponent</em>，还输出了 <em>WrappedComponent</em> 实例的 props 和 state。<em>JSON.stringify</em> 的小技巧是由 <a href="https://twitter.com/ryanflorence" target="_blank" rel="noopener noreferrer">Ryan Florence<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 和 <a href="https://twitter.com/mjackson" target="_blank" rel="noopener noreferrer">Michael Jackson<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 教我的。这个调试器完整的实现在<a href="https://github.com/franleplant/react-hoc-examples/blob/master/ii_debug.js" target="_blank" rel="noopener noreferrer">这里<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p> <h4 id="命名"><a href="#命名" aria-hidden="true" class="header-anchor">#</a> 命名</h4> <p>用 HOC 包裹了一个组件会使它失去原本 <em>WrappedComponent</em> 的名字，可能会影响开发和调试。</p> <p>通常会用 <em>WrappedComponent</em> 的名字加上一些 前缀作为 HOC 的名字。下面的代码来自 React-Redux：</p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token constant">HOC</span><span class="token punctuation">.</span>displayName <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">HOC(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">getDisplayName</span><span class="token punctuation">(</span>WrappedComponent<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)</span><span class="token template-punctuation string">`</span></span>
<span class="token comment">//或</span>
<span class="token keyword">class</span> <span class="token class-name">HOC</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span></span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> displayName <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">HOC(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">getDisplayName</span><span class="token punctuation">(</span>WrappedComponent<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)</span><span class="token template-punctuation string">`</span></span>
  <span class="token operator">...</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><em>getDisplayName</em> 函数：</p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token keyword">function</span> <span class="token function">getDisplayName</span><span class="token punctuation">(</span><span class="token parameter">WrappedComponent</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> WrappedComponent<span class="token punctuation">.</span>displayName <span class="token operator">||</span>
         WrappedComponent<span class="token punctuation">.</span>name <span class="token operator">||</span>
         ‘Component’
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>实际上你不用自己写，<a href="https://github.com/acdlite/recompose" target="_blank" rel="noopener noreferrer">recompose<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 提供了这个函数。</p> <h4 id="案例分析"><a href="#案例分析" aria-hidden="true" class="header-anchor">#</a> 案例分析</h4> <p><a href="https://github.com/reduxjs/react-redux" target="_blank" rel="noopener noreferrer">React-Redux<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>React-Redux 是 <a href="https://redux.js.org/" target="_blank" rel="noopener noreferrer">Redux<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 官方的 React 绑定实现。他提供的函数中有一个 <em>connect</em>，处理了监听 store 和后续的处理。是通过 Props Proxy 来实现的。</p> <p>在纯的Flux架构中，React 组件会连接到一个或多个 store，需要大量添加和删除 store 监听器，挑出 state 中 需要的部分。React-Redux 的实现非常好，它把这些处理都抽象出来了。总的说来，你不用再自己写了。</p> <p><a href="https://formidable.com/open-source/radium/" target="_blank" rel="noopener noreferrer">Radium<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>Radium 通过在内联样式中使用<a href="https://developer.mozilla.org/en-US/docs/Web/CSS/Pseudo-classes" target="_blank" rel="noopener noreferrer">CSS 伪类<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>增强了内联样式的能力。内联样式为什么好是另一个话题，很多人已经开始这样做，像 Radium 这样的库真的简化了这个过程。如果你想了解更多关于内联样式请参考 <a href="https://medium.com/@vjeux" target="_blank" rel="noopener noreferrer">Vjeux<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 的<a href="https://speakerdeck.com/vjeux/react-css-in-js" target="_blank" rel="noopener noreferrer">这个<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> ppt。</p> <p>话说回来，Radium 是怎样做到内联 CSS 伪类的，比如 hover？它用 Inheritance Inversion 模式做到了渲染劫持，插入对应的事件监听器来模拟 CSS 伪类，比如 hover。事件监听器插入到了 React 组件的 props 里。Radium 需要读取 <em>WrappedComponent</em> 的 render 方法输出的所有组件树，每当它发现一个新的带有 style 属性的组件时，在 props 上添加一个事件监听器。简单地说，Radium 修改了组件树的 props（实际上 Radium 的实现会更复杂些，你理解意思就行）。</p> <p>Radium 暴露的 API 真的很简单。令人印象深刻的是，他在用户甚至没有察觉到的时候，完成了所有工作。由此可见 HOC 的威力。</p> <h3 id="附录-a-hoc-和参数"><a href="#附录-a-hoc-和参数" aria-hidden="true" class="header-anchor">#</a> 附录 A: HOC 和参数</h3> <blockquote><p><em>你可以选择跳过下面的内容</em>
有时，在你的 HOC 上使用参数是很有用的。这对中级以上的 JS 开发者来说是很自然的事，但上面的例子都没有用到，为了做到详尽无遗我们快速地讲解一下。</p></blockquote> <p>例子：Props Proxy 模式 的 HOC 最简参数使用方法。关键在于 HOCFactoryFactory 函数。</p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token keyword">function</span> <span class="token function">HOCFactoryFactory</span><span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>params</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token comment">// do something with params</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token function">HOCFactory</span><span class="token punctuation">(</span><span class="token parameter">WrappedComponent</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">class</span> <span class="token class-name">HOC</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
      <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">WrappedComponent</span></span> <span class="token spread"><span class="token punctuation">{</span><span class="token punctuation">...</span><span class="token attr-value">this</span><span class="token punctuation">.</span><span class="token attr-value">props</span><span class="token punctuation">}</span></span><span class="token punctuation">/&gt;</span></span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>你可以这样用：</p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token function">HOCFactoryFactory</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">(</span>WrappedComponent<span class="token punctuation">)</span>
<span class="token comment">//或</span>
@<span class="token function">HOCFatoryFactory</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span>
<span class="token keyword">class</span> <span class="token class-name">WrappedComponent</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="附录-b-与父组件的不同"><a href="#附录-b-与父组件的不同" aria-hidden="true" class="header-anchor">#</a> 附录 B: 与父组件的不同</h4> <blockquote><p><em>你可以选择跳过下面的内容</em>
父组件就是有一些子组件的 React 组件。React 有访问和操作子组件的 API。</p></blockquote> <p>例子：父组件访问子组件。</p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token keyword">class</span> <span class="token class-name">Parent</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
          </span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>children<span class="token punctuation">}</span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">(</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Parent</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token punctuation">{</span>children<span class="token punctuation">}</span><span class="token plain-text">
  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Parent</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">,</span> mountNode<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>相对 HOC 来说，父组件可以做什么，不可以做什么？我们详细地总结一下：</p> <ul><li>渲染劫持 (在 Inheritance Inversion 一节讲到)</li> <li>操作内部 props (在 Inheritance Inversion 一节讲到)</li> <li>提取 state。但也有它的不足。只有在显式地为它创建钩子函数后，你才能从父组件外面访问到它的 props。这给它增添了一些不必要的限制。</li> <li>用新的 React 组件包裹。这可能是唯一一种父组件比 HOC 好用的情况。HOC 也可以做到。</li> <li>操作子组件会有一些陷阱。例如，当子组件没有单一的根节点时，你得添加一个额外的元素包裹所有的子组件，这让你的代码有些繁琐。在 HOC 中单一的根节点会由 React/JSX语法来确保。</li> <li>父组件可以自由应用到组件树中，不像 HOC 那样需要给每个组件创建一个类。</li></ul> <p>一般来讲，可以用父组件的时候就用父组件，它不像 HOC 那么 hacky，但也失去了 HOC 可以提供的灵活性。</p> <h2 id="渲染属性-render-props"><a href="#渲染属性-render-props" aria-hidden="true" class="header-anchor">#</a> 渲染属性(Render Props)</h2> <h3 id="mixins-存在的问题"><a href="#mixins-存在的问题" aria-hidden="true" class="header-anchor">#</a> Mixins 存在的问题</h3> <p>我的演讲始于高阶组件主要解决的问题：<strong>代码复用</strong>。</p> <p>让我们回到 2015 年使用 <code>React.createClass</code> 那会儿。假定你现在有一个简单的 React 应用需要跟踪并在页面上实时显示鼠标位置。你可能会构建一个下面这样的例子：</p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">import</span> ReactDOM <span class="token keyword">from</span> <span class="token string">'react-dom'</span>
<span class="token keyword">const</span> App <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createClass</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function">getInitialState</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span> x<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token number">0</span> <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">handleMouseMove</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      x<span class="token punctuation">:</span> event<span class="token punctuation">.</span>clientX<span class="token punctuation">,</span>
      y<span class="token punctuation">:</span> event<span class="token punctuation">.</span>clientY
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> x<span class="token punctuation">,</span> y <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> height<span class="token punctuation">:</span> <span class="token string">'100%'</span> <span class="token punctuation">}</span><span class="token punctuation">}</span></span> <span class="token attr-name">onMouseMove</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleMouseMove<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">The mouse position is (</span><span class="token punctuation">{</span>x<span class="token punctuation">}</span><span class="token plain-text">, </span><span class="token punctuation">{</span>y<span class="token punctuation">}</span><span class="token plain-text">)</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">App</span></span><span class="token punctuation">/&gt;</span></span><span class="token punctuation">,</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'app'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>现在，假定我们在另一个组件中也需要跟踪鼠标位置。我们可以重用 <code>&lt;App&gt;</code> 中的代码吗？</p> <p>在 <code>createClass</code> 这个范式中，代码重用问题是通过被称为 “mixins” 的技术解决的。我们创建一个 <code>MouseMixin</code>，让任何人都能通过它来追踪鼠标位置。</p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">import</span> ReactDOM <span class="token keyword">from</span> <span class="token string">'react-dom'</span>
<span class="token comment">// mixin 中含有了你需要在任何应用中追踪鼠标位置的样板代码。</span>
<span class="token comment">// 我们可以将样板代码放入到一个 mixin 中，这样其他组件就能共享这些代码</span>
<span class="token keyword">const</span> MouseMixin <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">getInitialState</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span> x<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token number">0</span> <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">handleMouseMove</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      x<span class="token punctuation">:</span> event<span class="token punctuation">.</span>clientX<span class="token punctuation">,</span>
      y<span class="token punctuation">:</span> event<span class="token punctuation">.</span>clientY
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> App <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createClass</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// 使用 mixin！</span>
  mixins<span class="token punctuation">:</span> <span class="token punctuation">[</span> MouseMixin <span class="token punctuation">]</span><span class="token punctuation">,</span>
  
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> x<span class="token punctuation">,</span> y <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> height<span class="token punctuation">:</span> <span class="token string">'100%'</span> <span class="token punctuation">}</span><span class="token punctuation">}</span></span> <span class="token attr-name">onMouseMove</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleMouseMove<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">The mouse position is (</span><span class="token punctuation">{</span>x<span class="token punctuation">}</span><span class="token plain-text">, </span><span class="token punctuation">{</span>y<span class="token punctuation">}</span><span class="token plain-text">)</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">App</span></span><span class="token punctuation">/&gt;</span></span><span class="token punctuation">,</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'app'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><p>问题解决了，对吧？现在，任何人都能轻松地将 <code>MouseMixin</code> 混入他们的组件中，并通过 <code>this.state</code> 属性获得鼠标的 <code>x</code> 和 <code>y</code> 坐标。</p> <h3 id="hoc-是新的-mixin"><a href="#hoc-是新的-mixin" aria-hidden="true" class="header-anchor">#</a> HOC 是新的 Mixin</h3> <p>去年，随着ES6 class 的到来，React 团队最终决定使用 ES6 class 来代替 <code>createClass</code>。这是一个明智的决定，没有人会在 JavaScript 都内置了 class 时还会维护自己的类模型。</p> <p>就存在一个问题：<strong>ES6 class 不支持 mixin</strong>。除了不是 ES6 规范的一部分，Dan 已经在一篇 React 博客上发布的博文上详细讨论了 mixin 存在的其他问题。</p> <p>minxins 的问题总结下来就是</p> <ul><li><strong>ES6 class</strong>。其不支持 mixins。</li> <li><strong>不够直接</strong>。minxins 改变了 state，因此也就很难知道一些 state 是从哪里来的，尤其是当不止存在一个 mixins 时。</li> <li><strong>名字冲突</strong>。两个要更新同一段 state 的 mixins 可能会相互覆盖。<code>createClass</code> API 会对两个 mixins 的 <code>getInitialState</code> 是否具有相同的 key 做检查，如果具有，则会发出警告，但该手段并不牢靠。</li></ul> <p>所以，为了替代 mixin，React 社区中的不少开发者最终决定用高阶组件（简称 HOC）来做代码复用。在这个范式下，代码通过一个类似于 <strong>装饰器（decorator）</strong> 的技术进行共享。首先，你的一个组件定义了大量需要被渲染的标记，之后用若干具有你想用共享的行为的组件包裹它。因此，你现在是在 <strong>装饰</strong> 你的组件，而不是<strong>混入</strong>你需要的行为！</p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">import</span> ReactDOM <span class="token keyword">from</span> <span class="token string">'react-dom'</span>
<span class="token keyword">const</span> <span class="token function-variable function">withMouse</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">Component</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">class</span> <span class="token class-name">extends</span> React<span class="token punctuation">.</span>Component <span class="token punctuation">{</span>
    state <span class="token operator">=</span> <span class="token punctuation">{</span> x<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token number">0</span> <span class="token punctuation">}</span>
    <span class="token function-variable function">handleMouseMove</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        x<span class="token punctuation">:</span> event<span class="token punctuation">.</span>clientX<span class="token punctuation">,</span>
        y<span class="token punctuation">:</span> event<span class="token punctuation">.</span>clientY
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> height<span class="token punctuation">:</span> <span class="token string">'100%'</span> <span class="token punctuation">}</span><span class="token punctuation">}</span></span> <span class="token attr-name">onMouseMove</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleMouseMove<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Component</span></span> <span class="token spread"><span class="token punctuation">{</span><span class="token punctuation">...</span><span class="token attr-value">this</span><span class="token punctuation">.</span><span class="token attr-value">props</span><span class="token punctuation">}</span></span> <span class="token attr-name">mouse</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">}</span></span><span class="token punctuation">/&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> App <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createClass</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 现在，我们得到了一个鼠标位置的 prop，而不再需要维护自己的 state</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> x<span class="token punctuation">,</span> y <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>mouse
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> height<span class="token punctuation">:</span> <span class="token string">'100%'</span> <span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">The mouse position is (</span><span class="token punctuation">{</span>x<span class="token punctuation">}</span><span class="token plain-text">, </span><span class="token punctuation">{</span>y<span class="token punctuation">}</span><span class="token plain-text">)</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 主需要用 withMouse 包裹组件，它就能获得 mouse prop</span>
<span class="token keyword">const</span> AppWithMouse <span class="token operator">=</span> <span class="token function">withMouse</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span>
ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">AppWithMouse</span></span><span class="token punctuation">/&gt;</span></span><span class="token punctuation">,</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'app'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><p>让我们和 mixin 说再见，去拥抱 HOC 吧。</p> <p>在 ES6 class 的新时代下，HOC 的确是一个能够优雅地解决代码重用问题方案，社区也已经广泛采用它了。</p> <p>此刻，我想问一句：是什么驱使我们迁移到 HOC ? 我们是否解决了在使用 mixin 时遇到的问题？</p> <p>让我们看下：</p> <ul><li><strong>ES6 class</strong>。这里不再是问题了，ES6 class 创建的组件能够和 HOC 结合。</li> <li><strong>不够直接</strong>。即便用了 HOC，这个问题仍然存在。在 mixin 中，我们不知道 state 从何而来，在 HOC 中，我们不知道 props 从何而来。</li> <li><strong>名字冲突</strong>。我们仍然会面临该问题。两个使用了同名 prop 的 HOC 将遭遇冲突并且彼此覆盖，并且这次问题会更加隐晦，因为 React 不会在 prop 重名是发出警告。</li></ul> <p>另一个 HOC 和 mixin 都有的问题就是，二者使用的是 <strong>静态组合</strong> 而不是 <strong>动态组合</strong>。问问你自己：在 HOC 这个范式下，组合是在哪里发生的？当组件类（如上例中的的 <code>AppWithMouse</code>）被创建后，发生了一次静态组合。</p> <p>你无法在 <code>render</code> 方法中使用 mixin 或者 HOC，而这恰是 React <strong>动态</strong> 组合模型的关键。当你在 <code>render</code> 中完成了组合，你就可以利用到所有 React 生命期的优势了。动态组合或许微不足道，但兴许某天也会出现一篇专门探讨它的博客，等等，我有点离题了。</p> <p>总而言之：**使用 ES6 class 创建的 HOC 仍然会遇到和使用 <code>createClass</code> 时一样的问题，它只能算一次重构。**现在不要说拥抱 HOC 了，我们不过在拥抱新的 mixin！</p> <p>除了上述缺陷，由于 HOC 的实质是<strong>包裹</strong>组件并创建了一个<strong>混入</strong>现有组件的 mixin 替代，因此，<strong>HOC 将引入大量的繁文缛节</strong>。从 HOC 中返回的组件需要表现得和它包裹的组件尽可能一样（它需要和包裹组件接收一样的 props 等等）。这一事实使得构建健壮的 HOC 需要大量的样板代码（boilerplate code）。</p> <h3 id="render-props"><a href="#render-props" aria-hidden="true" class="header-anchor">#</a> Render Props</h3> <p>我会这么定义 render prop：</p> <blockquote><p>一个 render prop 是一个类型为函数的 prop，它让组件知道该渲染什么。
更通俗的说法是：不同于通过 “混入” 或者装饰来共享组件行为，<strong>一个普通组件只需要一个函数 prop 就能够进行一些 state 共享</strong>。</p></blockquote> <p>继续到上面的例子，我们将通过一个类型为函数的 <code>render</code> 的 prop 来简化 <code>withMouse</code> HOC 到一个普通的 <code>&lt;Mouse&gt;</code> 组件。然后，在 <code>&lt;Mouse&gt;</code> 的 <code>render</code> 方法中，我们可以使用一个 render prop 来让组件知道如何渲染：</p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">import</span> ReactDOM <span class="token keyword">from</span> <span class="token string">'react-dom'</span>
<span class="token keyword">import</span> PropTypes <span class="token keyword">from</span> <span class="token string">'prop-types'</span>
<span class="token comment">// 与 HOC 不同，我们可以使用具有 render prop 的普通组件来共享代码</span>
<span class="token keyword">class</span> <span class="token class-name">Mouse</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> propTypes <span class="token operator">=</span> <span class="token punctuation">{</span>
    render<span class="token punctuation">:</span> PropTypes<span class="token punctuation">.</span>func<span class="token punctuation">.</span>isRequired
  <span class="token punctuation">}</span>
  state <span class="token operator">=</span> <span class="token punctuation">{</span> x<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token number">0</span> <span class="token punctuation">}</span>
  <span class="token function-variable function">handleMouseMove</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      x<span class="token punctuation">:</span> event<span class="token punctuation">.</span>clientX<span class="token punctuation">,</span>
      y<span class="token punctuation">:</span> event<span class="token punctuation">.</span>clientY
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> height<span class="token punctuation">:</span> <span class="token string">'100%'</span> <span class="token punctuation">}</span><span class="token punctuation">}</span></span> <span class="token attr-name">onMouseMove</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleMouseMove<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> App <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createClass</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> height<span class="token punctuation">:</span> <span class="token string">'100%'</span> <span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Mouse</span></span> <span class="token attr-name">render</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> x<span class="token punctuation">,</span> y <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
          <span class="token comment">// render prop 给了我们所需要的 state 来渲染我们想要的</span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">The mouse position is (</span><span class="token punctuation">{</span>x<span class="token punctuation">}</span><span class="token plain-text">, </span><span class="token punctuation">{</span>y<span class="token punctuation">}</span><span class="token plain-text">)</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
        <span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token punctuation">/&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">App</span></span><span class="token punctuation">/&gt;</span></span><span class="token punctuation">,</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'app'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br></div></div><p>这里需要明确的概念是，<code>&lt;Mouse&gt;</code> 组件实际上是调用了它的 <code>render</code> 方法来将它的 state 暴露给 <code>&lt;App&gt;</code> 组件。因此，<code>&lt;App&gt;</code> 可以随便按自己的想法使用这个 state，这太美妙了。</p> <p>在此，我想说明，“children as a function” 是一个 <strong>完全相同的概念</strong>，只是用 <code>children</code> prop 替代了 <code>render</code> prop。我挂在嘴边的 <code>render prop</code> 并不是在强调一个 <strong>名叫</strong> <code>prop</code> 的 prop，而是在强调你使用一个 prop 去进行渲染的概念。</p> <p>该技术规避了所有 mixin 和 HOC 会面对的问题：</p> <ul><li><strong>ES6 class</strong>。不成问题，我们可以在 ES6 class 创建的组件中使用 render prop。</li> <li><strong>不够直接</strong>。我们不必再担心 state 或者 props 来自哪里。我们可以看到通过 render prop 的参数列表看到有哪些 state 或者 props 可供使用。</li> <li><strong>名字冲突</strong>。现在不会有任何的自动属性名称合并，因此，名字冲突将全无可乘之机。</li></ul> <p>并且，render prop 也不会引入 <strong>任何繁文缛节</strong>，因为你不会 <strong>包裹</strong> 和 <strong>装饰</strong> 其他的组件。它仅仅是一个函数！如果你使用了 TypeScript 或者 Flow，你会发现相较于 HOC，现在很容易为你具有 render prop 的组件写一个类型定义。当然，这是另外一个话题了。</p> <p>另外，这里的组合模型是 <strong>动态的</strong>！每次组合都发生在 render 内部，因此，我们就能利用到 React 生命周期以及自然流动的 props 和 state 带来的优势。</p> <p>使用这个模式，你可以将 <strong>任何</strong> HOC 替换一个具有 render prop 的一般组件。这点我们可以证明！😅</p> <h3 id="render-props-hocs"><a href="#render-props-hocs" aria-hidden="true" class="header-anchor">#</a> Render Props &gt; HOCs</h3> <p>一个更将强有力的，能够证明 render prop 比 HOC 要强大的证据是，任何 HOC 都能使用 render prop 替代，反之则不然。下面的代码展示了使用一个一般的、具有 render prop 的 <code>&lt;Mouse&gt;</code> 组件来实现的 <code>withMouse</code> HOC：</p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token keyword">const</span> <span class="token function-variable function">withMouse</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">Component</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">class</span> <span class="token class-name">extends</span> React<span class="token punctuation">.</span>Component <span class="token punctuation">{</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Mouse</span></span> <span class="token attr-name">render</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token parameter">mouse</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Component</span></span> <span class="token spread"><span class="token punctuation">{</span><span class="token punctuation">...</span><span class="token attr-value">this</span><span class="token punctuation">.</span><span class="token attr-value">props</span><span class="token punctuation">}</span></span> <span class="token attr-name">mouse</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>mouse<span class="token punctuation">}</span></span><span class="token punctuation">/&gt;</span></span>
      <span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/prepare/react/React进阶/React实现Toast（提示）效果.html" class="prev">React实现Toast（提示）效果</a></span> <span class="next"><a href="/prepare/react/React进阶/React进阶之路.html">React进阶之路</a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/prepare/assets/js/app.fc97b764.js" defer></script><script src="/prepare/assets/js/2.df88221a.js" defer></script><script src="/prepare/assets/js/540.7e78812b.js" defer></script>
  </body>
</html>
