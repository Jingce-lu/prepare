<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>TS从零开发AXIOS全系列 | Lu notes</title>
    <meta name="description" content=" ">
    <link rel=" " href=" ">
    
    <link rel="preload" href="/prepare/assets/css/0.styles.cacbc208.css" as="style"><link rel="preload" href="/prepare/assets/js/app.4aa2a542.js" as="script"><link rel="preload" href="/prepare/assets/js/3.54d0c86c.js" as="script"><link rel="preload" href="/prepare/assets/js/2.1e70219e.js" as="script"><link rel="preload" href="/prepare/assets/js/367.7f7f1832.js" as="script"><link rel="prefetch" href="/prepare/assets/js/10.a5440e3b.js"><link rel="prefetch" href="/prepare/assets/js/100.49921228.js"><link rel="prefetch" href="/prepare/assets/js/101.348a4cc2.js"><link rel="prefetch" href="/prepare/assets/js/102.a8fce71c.js"><link rel="prefetch" href="/prepare/assets/js/103.d0e88517.js"><link rel="prefetch" href="/prepare/assets/js/104.9cea9c23.js"><link rel="prefetch" href="/prepare/assets/js/105.45546216.js"><link rel="prefetch" href="/prepare/assets/js/106.fb278dad.js"><link rel="prefetch" href="/prepare/assets/js/107.7ff9a5b5.js"><link rel="prefetch" href="/prepare/assets/js/108.f65f31c5.js"><link rel="prefetch" href="/prepare/assets/js/109.7665a2cc.js"><link rel="prefetch" href="/prepare/assets/js/11.2d0e368d.js"><link rel="prefetch" href="/prepare/assets/js/110.0a0df56c.js"><link rel="prefetch" href="/prepare/assets/js/111.4c3c1e69.js"><link rel="prefetch" href="/prepare/assets/js/112.b7d07c6b.js"><link rel="prefetch" href="/prepare/assets/js/113.7f348636.js"><link rel="prefetch" href="/prepare/assets/js/114.3125585d.js"><link rel="prefetch" href="/prepare/assets/js/115.f1e68cca.js"><link rel="prefetch" href="/prepare/assets/js/116.a3852067.js"><link rel="prefetch" href="/prepare/assets/js/117.581d0284.js"><link rel="prefetch" href="/prepare/assets/js/118.77a35996.js"><link rel="prefetch" href="/prepare/assets/js/119.4679cb3e.js"><link rel="prefetch" href="/prepare/assets/js/12.8a7587de.js"><link rel="prefetch" href="/prepare/assets/js/120.9b5ad07c.js"><link rel="prefetch" href="/prepare/assets/js/121.a8d4d990.js"><link rel="prefetch" href="/prepare/assets/js/122.447be4b1.js"><link rel="prefetch" href="/prepare/assets/js/123.2a617b7d.js"><link rel="prefetch" href="/prepare/assets/js/124.a65153c0.js"><link rel="prefetch" href="/prepare/assets/js/125.7ba5c94c.js"><link rel="prefetch" href="/prepare/assets/js/126.505d6f2f.js"><link rel="prefetch" href="/prepare/assets/js/127.1b7af4b8.js"><link rel="prefetch" href="/prepare/assets/js/128.a16bc654.js"><link rel="prefetch" href="/prepare/assets/js/129.3edf5db1.js"><link rel="prefetch" href="/prepare/assets/js/13.c8e76649.js"><link rel="prefetch" href="/prepare/assets/js/130.390174a8.js"><link rel="prefetch" href="/prepare/assets/js/131.ad3319f8.js"><link rel="prefetch" href="/prepare/assets/js/132.91bdf7b2.js"><link rel="prefetch" href="/prepare/assets/js/133.40b289a5.js"><link rel="prefetch" href="/prepare/assets/js/134.c5d25cbb.js"><link rel="prefetch" href="/prepare/assets/js/135.ed6a2bed.js"><link rel="prefetch" href="/prepare/assets/js/136.90ea9c6f.js"><link rel="prefetch" href="/prepare/assets/js/137.2675dbcd.js"><link rel="prefetch" href="/prepare/assets/js/138.81c7a8fd.js"><link rel="prefetch" href="/prepare/assets/js/139.6cecc9e3.js"><link rel="prefetch" href="/prepare/assets/js/14.a6339ea5.js"><link rel="prefetch" href="/prepare/assets/js/140.ce2c9cbf.js"><link rel="prefetch" href="/prepare/assets/js/141.ced3ca78.js"><link rel="prefetch" href="/prepare/assets/js/142.04bf2181.js"><link rel="prefetch" href="/prepare/assets/js/143.6031aa9f.js"><link rel="prefetch" href="/prepare/assets/js/144.96146eeb.js"><link rel="prefetch" href="/prepare/assets/js/145.0f500a5e.js"><link rel="prefetch" href="/prepare/assets/js/146.efc3e514.js"><link rel="prefetch" href="/prepare/assets/js/147.95426fa6.js"><link rel="prefetch" href="/prepare/assets/js/148.f6adc68b.js"><link rel="prefetch" href="/prepare/assets/js/149.d993b6b0.js"><link rel="prefetch" href="/prepare/assets/js/15.79ca39c3.js"><link rel="prefetch" href="/prepare/assets/js/150.bd7304a1.js"><link rel="prefetch" href="/prepare/assets/js/151.39e64c11.js"><link rel="prefetch" href="/prepare/assets/js/152.75640974.js"><link rel="prefetch" href="/prepare/assets/js/153.1e9841fd.js"><link rel="prefetch" href="/prepare/assets/js/154.5fc55557.js"><link rel="prefetch" href="/prepare/assets/js/155.49fc5ddb.js"><link rel="prefetch" href="/prepare/assets/js/156.902f0240.js"><link rel="prefetch" href="/prepare/assets/js/157.606b27b6.js"><link rel="prefetch" href="/prepare/assets/js/158.f1fe34ad.js"><link rel="prefetch" href="/prepare/assets/js/159.9576f3ce.js"><link rel="prefetch" href="/prepare/assets/js/16.84797d53.js"><link rel="prefetch" href="/prepare/assets/js/160.8da69e64.js"><link rel="prefetch" href="/prepare/assets/js/161.76da728b.js"><link rel="prefetch" href="/prepare/assets/js/162.06b367d2.js"><link rel="prefetch" href="/prepare/assets/js/163.eb233686.js"><link rel="prefetch" href="/prepare/assets/js/164.3edd8194.js"><link rel="prefetch" href="/prepare/assets/js/165.8cc5478d.js"><link rel="prefetch" href="/prepare/assets/js/166.e34521c6.js"><link rel="prefetch" href="/prepare/assets/js/167.202fae94.js"><link rel="prefetch" href="/prepare/assets/js/168.6c44ac7b.js"><link rel="prefetch" href="/prepare/assets/js/169.78435a15.js"><link rel="prefetch" href="/prepare/assets/js/17.d920472b.js"><link rel="prefetch" href="/prepare/assets/js/170.491ba435.js"><link rel="prefetch" href="/prepare/assets/js/171.45389e8c.js"><link rel="prefetch" href="/prepare/assets/js/172.e92f89e6.js"><link rel="prefetch" href="/prepare/assets/js/173.e87030a6.js"><link rel="prefetch" href="/prepare/assets/js/174.dc989fd5.js"><link rel="prefetch" href="/prepare/assets/js/175.317fbc42.js"><link rel="prefetch" href="/prepare/assets/js/176.ef3bba27.js"><link rel="prefetch" href="/prepare/assets/js/177.4070ed82.js"><link rel="prefetch" href="/prepare/assets/js/178.7786f575.js"><link rel="prefetch" href="/prepare/assets/js/179.2c731981.js"><link rel="prefetch" href="/prepare/assets/js/18.f1b8945d.js"><link rel="prefetch" href="/prepare/assets/js/180.9cbbe23a.js"><link rel="prefetch" href="/prepare/assets/js/181.6cca9a96.js"><link rel="prefetch" href="/prepare/assets/js/182.9a3881ec.js"><link rel="prefetch" href="/prepare/assets/js/183.f07eb804.js"><link rel="prefetch" href="/prepare/assets/js/184.c29e346c.js"><link rel="prefetch" href="/prepare/assets/js/185.70dbaa66.js"><link rel="prefetch" href="/prepare/assets/js/186.3b5ea4a9.js"><link rel="prefetch" href="/prepare/assets/js/187.69c10a5c.js"><link rel="prefetch" href="/prepare/assets/js/188.bda15704.js"><link rel="prefetch" href="/prepare/assets/js/189.4405a76d.js"><link rel="prefetch" href="/prepare/assets/js/19.0959b1ce.js"><link rel="prefetch" href="/prepare/assets/js/190.9c9ea2c8.js"><link rel="prefetch" href="/prepare/assets/js/191.1dddd830.js"><link rel="prefetch" href="/prepare/assets/js/192.4fe1628a.js"><link rel="prefetch" href="/prepare/assets/js/193.fca14b99.js"><link rel="prefetch" href="/prepare/assets/js/194.71b17ca8.js"><link rel="prefetch" href="/prepare/assets/js/195.1806cf86.js"><link rel="prefetch" href="/prepare/assets/js/196.872bf712.js"><link rel="prefetch" href="/prepare/assets/js/197.71bb9916.js"><link rel="prefetch" href="/prepare/assets/js/198.96b69fb8.js"><link rel="prefetch" href="/prepare/assets/js/199.c5e292e5.js"><link rel="prefetch" href="/prepare/assets/js/20.9a39fdb8.js"><link rel="prefetch" href="/prepare/assets/js/200.90b09042.js"><link rel="prefetch" href="/prepare/assets/js/201.0c311788.js"><link rel="prefetch" href="/prepare/assets/js/202.3d5a8d4a.js"><link rel="prefetch" href="/prepare/assets/js/203.79fe61c1.js"><link rel="prefetch" href="/prepare/assets/js/204.b511d41d.js"><link rel="prefetch" href="/prepare/assets/js/205.6d293bb7.js"><link rel="prefetch" href="/prepare/assets/js/206.4c1a8f7b.js"><link rel="prefetch" href="/prepare/assets/js/207.c1c3db09.js"><link rel="prefetch" href="/prepare/assets/js/208.0441721b.js"><link rel="prefetch" href="/prepare/assets/js/209.6962f333.js"><link rel="prefetch" href="/prepare/assets/js/21.c0fc0e6c.js"><link rel="prefetch" href="/prepare/assets/js/210.e9c70512.js"><link rel="prefetch" href="/prepare/assets/js/211.4243c8b7.js"><link rel="prefetch" href="/prepare/assets/js/212.708a8e00.js"><link rel="prefetch" href="/prepare/assets/js/213.91611672.js"><link rel="prefetch" href="/prepare/assets/js/214.6f427907.js"><link rel="prefetch" href="/prepare/assets/js/215.6fc8feed.js"><link rel="prefetch" href="/prepare/assets/js/216.cd1cadaa.js"><link rel="prefetch" href="/prepare/assets/js/217.90e5770f.js"><link rel="prefetch" href="/prepare/assets/js/218.cc5550d2.js"><link rel="prefetch" href="/prepare/assets/js/219.43653d83.js"><link rel="prefetch" href="/prepare/assets/js/22.d1ec8aaa.js"><link rel="prefetch" href="/prepare/assets/js/220.853a7a17.js"><link rel="prefetch" href="/prepare/assets/js/221.45a7b565.js"><link rel="prefetch" href="/prepare/assets/js/222.691dc236.js"><link rel="prefetch" href="/prepare/assets/js/223.7a16963d.js"><link rel="prefetch" href="/prepare/assets/js/224.12e6dce7.js"><link rel="prefetch" href="/prepare/assets/js/225.c1103685.js"><link rel="prefetch" href="/prepare/assets/js/226.14ab24ce.js"><link rel="prefetch" href="/prepare/assets/js/227.312433e8.js"><link rel="prefetch" href="/prepare/assets/js/228.67610733.js"><link rel="prefetch" href="/prepare/assets/js/229.33c394b5.js"><link rel="prefetch" href="/prepare/assets/js/23.ca83b4af.js"><link rel="prefetch" href="/prepare/assets/js/230.1942cfe1.js"><link rel="prefetch" href="/prepare/assets/js/231.7d5c5b56.js"><link rel="prefetch" href="/prepare/assets/js/232.577a3e8a.js"><link rel="prefetch" href="/prepare/assets/js/233.096f8e54.js"><link rel="prefetch" href="/prepare/assets/js/234.a087f4bd.js"><link rel="prefetch" href="/prepare/assets/js/235.827f27cf.js"><link rel="prefetch" href="/prepare/assets/js/236.dee180de.js"><link rel="prefetch" href="/prepare/assets/js/237.17b07d1c.js"><link rel="prefetch" href="/prepare/assets/js/238.12f1d493.js"><link rel="prefetch" href="/prepare/assets/js/239.0ad7e429.js"><link rel="prefetch" href="/prepare/assets/js/24.78c4fe63.js"><link rel="prefetch" href="/prepare/assets/js/240.a3269099.js"><link rel="prefetch" href="/prepare/assets/js/241.78834a00.js"><link rel="prefetch" href="/prepare/assets/js/242.231fd3bd.js"><link rel="prefetch" href="/prepare/assets/js/243.0601150f.js"><link rel="prefetch" href="/prepare/assets/js/244.e10f4ae4.js"><link rel="prefetch" href="/prepare/assets/js/245.5e427303.js"><link rel="prefetch" href="/prepare/assets/js/246.b17c6ee8.js"><link rel="prefetch" href="/prepare/assets/js/247.10e011ff.js"><link rel="prefetch" href="/prepare/assets/js/248.7aaa4d02.js"><link rel="prefetch" href="/prepare/assets/js/249.badf3b9f.js"><link rel="prefetch" href="/prepare/assets/js/25.636392cc.js"><link rel="prefetch" href="/prepare/assets/js/250.4d1508f0.js"><link rel="prefetch" href="/prepare/assets/js/251.b341c146.js"><link rel="prefetch" href="/prepare/assets/js/252.35374e5a.js"><link rel="prefetch" href="/prepare/assets/js/253.b0a45ea0.js"><link rel="prefetch" href="/prepare/assets/js/254.d5e7821d.js"><link rel="prefetch" href="/prepare/assets/js/255.7b30b3b6.js"><link rel="prefetch" href="/prepare/assets/js/256.9b7539bb.js"><link rel="prefetch" href="/prepare/assets/js/257.c2130c0c.js"><link rel="prefetch" href="/prepare/assets/js/258.b6d9ce70.js"><link rel="prefetch" href="/prepare/assets/js/259.4ecf8002.js"><link rel="prefetch" href="/prepare/assets/js/26.c3e6548b.js"><link rel="prefetch" href="/prepare/assets/js/260.fdd6c38b.js"><link rel="prefetch" href="/prepare/assets/js/261.1d7ab4cc.js"><link rel="prefetch" href="/prepare/assets/js/262.19c92240.js"><link rel="prefetch" href="/prepare/assets/js/263.18bc31cc.js"><link rel="prefetch" href="/prepare/assets/js/264.cc39da90.js"><link rel="prefetch" href="/prepare/assets/js/265.3a47da85.js"><link rel="prefetch" href="/prepare/assets/js/266.f1a0a9f1.js"><link rel="prefetch" href="/prepare/assets/js/267.b3585a79.js"><link rel="prefetch" href="/prepare/assets/js/268.8241b69b.js"><link rel="prefetch" href="/prepare/assets/js/269.98260290.js"><link rel="prefetch" href="/prepare/assets/js/27.74c15f7b.js"><link rel="prefetch" href="/prepare/assets/js/270.f7d18da7.js"><link rel="prefetch" href="/prepare/assets/js/271.8a4b19fa.js"><link rel="prefetch" href="/prepare/assets/js/272.56972589.js"><link rel="prefetch" href="/prepare/assets/js/273.36fbb645.js"><link rel="prefetch" href="/prepare/assets/js/274.1ab1a1d0.js"><link rel="prefetch" href="/prepare/assets/js/275.e9a35772.js"><link rel="prefetch" href="/prepare/assets/js/276.369609b5.js"><link rel="prefetch" href="/prepare/assets/js/277.b22699a7.js"><link rel="prefetch" href="/prepare/assets/js/278.dc37cbd9.js"><link rel="prefetch" href="/prepare/assets/js/279.9b2c12da.js"><link rel="prefetch" href="/prepare/assets/js/28.df2150c0.js"><link rel="prefetch" href="/prepare/assets/js/280.7a8f8294.js"><link rel="prefetch" href="/prepare/assets/js/281.464181e8.js"><link rel="prefetch" href="/prepare/assets/js/282.b9e9da5a.js"><link rel="prefetch" href="/prepare/assets/js/283.3ef3300c.js"><link rel="prefetch" href="/prepare/assets/js/284.7684f7f0.js"><link rel="prefetch" href="/prepare/assets/js/285.5210d007.js"><link rel="prefetch" href="/prepare/assets/js/286.6267b024.js"><link rel="prefetch" href="/prepare/assets/js/287.5f6b3490.js"><link rel="prefetch" href="/prepare/assets/js/288.57299f99.js"><link rel="prefetch" href="/prepare/assets/js/289.343fea50.js"><link rel="prefetch" href="/prepare/assets/js/29.74fb2eda.js"><link rel="prefetch" href="/prepare/assets/js/290.5e98e99c.js"><link rel="prefetch" href="/prepare/assets/js/291.58195d2c.js"><link rel="prefetch" href="/prepare/assets/js/292.449ad646.js"><link rel="prefetch" href="/prepare/assets/js/293.9d7830e9.js"><link rel="prefetch" href="/prepare/assets/js/294.3e2e4014.js"><link rel="prefetch" href="/prepare/assets/js/295.8c4bda2d.js"><link rel="prefetch" href="/prepare/assets/js/296.24e74267.js"><link rel="prefetch" href="/prepare/assets/js/297.10c65d84.js"><link rel="prefetch" href="/prepare/assets/js/298.a5e4ef11.js"><link rel="prefetch" href="/prepare/assets/js/299.f3e6668b.js"><link rel="prefetch" href="/prepare/assets/js/30.46d15308.js"><link rel="prefetch" href="/prepare/assets/js/300.3c3111c4.js"><link rel="prefetch" href="/prepare/assets/js/301.d35b667d.js"><link rel="prefetch" href="/prepare/assets/js/302.b92401df.js"><link rel="prefetch" href="/prepare/assets/js/303.413a5670.js"><link rel="prefetch" href="/prepare/assets/js/304.d4135152.js"><link rel="prefetch" href="/prepare/assets/js/305.161b2d23.js"><link rel="prefetch" href="/prepare/assets/js/306.2a7640a2.js"><link rel="prefetch" href="/prepare/assets/js/307.d3dab53b.js"><link rel="prefetch" href="/prepare/assets/js/308.b6b7500c.js"><link rel="prefetch" href="/prepare/assets/js/309.0ef6023b.js"><link rel="prefetch" href="/prepare/assets/js/31.e07861db.js"><link rel="prefetch" href="/prepare/assets/js/310.e09d364e.js"><link rel="prefetch" href="/prepare/assets/js/311.fff66975.js"><link rel="prefetch" href="/prepare/assets/js/312.5ed5aa08.js"><link rel="prefetch" href="/prepare/assets/js/313.d8ea9b76.js"><link rel="prefetch" href="/prepare/assets/js/314.6a3e4182.js"><link rel="prefetch" href="/prepare/assets/js/315.bf4f551a.js"><link rel="prefetch" href="/prepare/assets/js/316.9d2d4cc0.js"><link rel="prefetch" href="/prepare/assets/js/317.9366c9cf.js"><link rel="prefetch" href="/prepare/assets/js/318.f4bc379d.js"><link rel="prefetch" href="/prepare/assets/js/319.0938baed.js"><link rel="prefetch" href="/prepare/assets/js/32.b33a2c95.js"><link rel="prefetch" href="/prepare/assets/js/320.7e7663fc.js"><link rel="prefetch" href="/prepare/assets/js/321.6b805cbb.js"><link rel="prefetch" href="/prepare/assets/js/322.a7db652b.js"><link rel="prefetch" href="/prepare/assets/js/323.1aefa02b.js"><link rel="prefetch" href="/prepare/assets/js/324.15691e35.js"><link rel="prefetch" href="/prepare/assets/js/325.69358db6.js"><link rel="prefetch" href="/prepare/assets/js/326.1debd6b1.js"><link rel="prefetch" href="/prepare/assets/js/327.6e2abdb9.js"><link rel="prefetch" href="/prepare/assets/js/328.5eae944d.js"><link rel="prefetch" href="/prepare/assets/js/329.3b35b14b.js"><link rel="prefetch" href="/prepare/assets/js/33.4a9bca74.js"><link rel="prefetch" href="/prepare/assets/js/330.8bfcc682.js"><link rel="prefetch" href="/prepare/assets/js/331.e8ced76e.js"><link rel="prefetch" href="/prepare/assets/js/332.33b55129.js"><link rel="prefetch" href="/prepare/assets/js/333.853626fe.js"><link rel="prefetch" href="/prepare/assets/js/334.2daad06c.js"><link rel="prefetch" href="/prepare/assets/js/335.11cdd2cb.js"><link rel="prefetch" href="/prepare/assets/js/336.726f1d83.js"><link rel="prefetch" href="/prepare/assets/js/337.2c034ae2.js"><link rel="prefetch" href="/prepare/assets/js/338.3ead5a84.js"><link rel="prefetch" href="/prepare/assets/js/339.c8d7a159.js"><link rel="prefetch" href="/prepare/assets/js/34.d73d7e5e.js"><link rel="prefetch" href="/prepare/assets/js/340.68dd9c49.js"><link rel="prefetch" href="/prepare/assets/js/341.9558d3e5.js"><link rel="prefetch" href="/prepare/assets/js/342.27319bb4.js"><link rel="prefetch" href="/prepare/assets/js/343.f11dbc39.js"><link rel="prefetch" href="/prepare/assets/js/344.db252639.js"><link rel="prefetch" href="/prepare/assets/js/345.a7a8e9a6.js"><link rel="prefetch" href="/prepare/assets/js/346.a7d08d66.js"><link rel="prefetch" href="/prepare/assets/js/347.80d4da39.js"><link rel="prefetch" href="/prepare/assets/js/348.8554c6f8.js"><link rel="prefetch" href="/prepare/assets/js/349.1375ae90.js"><link rel="prefetch" href="/prepare/assets/js/35.d96bb4e9.js"><link rel="prefetch" href="/prepare/assets/js/350.4a373ae7.js"><link rel="prefetch" href="/prepare/assets/js/351.3781e581.js"><link rel="prefetch" href="/prepare/assets/js/352.dfb29dcd.js"><link rel="prefetch" href="/prepare/assets/js/353.f1d018f3.js"><link rel="prefetch" href="/prepare/assets/js/354.9e263c35.js"><link rel="prefetch" href="/prepare/assets/js/355.3ea6abf9.js"><link rel="prefetch" href="/prepare/assets/js/356.d5561094.js"><link rel="prefetch" href="/prepare/assets/js/357.0e4fa259.js"><link rel="prefetch" href="/prepare/assets/js/358.8a5ba1a3.js"><link rel="prefetch" href="/prepare/assets/js/359.4a2849ad.js"><link rel="prefetch" href="/prepare/assets/js/36.97aab521.js"><link rel="prefetch" href="/prepare/assets/js/360.29929644.js"><link rel="prefetch" href="/prepare/assets/js/361.f5b94044.js"><link rel="prefetch" href="/prepare/assets/js/362.e24a8808.js"><link rel="prefetch" href="/prepare/assets/js/363.4b19012b.js"><link rel="prefetch" href="/prepare/assets/js/364.612a3cf2.js"><link rel="prefetch" href="/prepare/assets/js/365.b72d9c17.js"><link rel="prefetch" href="/prepare/assets/js/366.946ebf78.js"><link rel="prefetch" href="/prepare/assets/js/368.ed0bd446.js"><link rel="prefetch" href="/prepare/assets/js/369.f6c1dc47.js"><link rel="prefetch" href="/prepare/assets/js/37.00afd3d0.js"><link rel="prefetch" href="/prepare/assets/js/370.54711768.js"><link rel="prefetch" href="/prepare/assets/js/371.ad1e902d.js"><link rel="prefetch" href="/prepare/assets/js/372.08a1015b.js"><link rel="prefetch" href="/prepare/assets/js/373.886e6c01.js"><link rel="prefetch" href="/prepare/assets/js/374.797e91d5.js"><link rel="prefetch" href="/prepare/assets/js/375.9413ef1f.js"><link rel="prefetch" href="/prepare/assets/js/376.1c5ef876.js"><link rel="prefetch" href="/prepare/assets/js/377.616a47cc.js"><link rel="prefetch" href="/prepare/assets/js/378.7789ffe7.js"><link rel="prefetch" href="/prepare/assets/js/379.2bfe364f.js"><link rel="prefetch" href="/prepare/assets/js/38.4e1d1518.js"><link rel="prefetch" href="/prepare/assets/js/380.b2d805df.js"><link rel="prefetch" href="/prepare/assets/js/381.c2889ffb.js"><link rel="prefetch" href="/prepare/assets/js/382.095084b2.js"><link rel="prefetch" href="/prepare/assets/js/383.f1748ffb.js"><link rel="prefetch" href="/prepare/assets/js/384.a472ccda.js"><link rel="prefetch" href="/prepare/assets/js/385.5858a009.js"><link rel="prefetch" href="/prepare/assets/js/386.5e848ab0.js"><link rel="prefetch" href="/prepare/assets/js/387.0a0b375d.js"><link rel="prefetch" href="/prepare/assets/js/388.7282fa44.js"><link rel="prefetch" href="/prepare/assets/js/389.6bea854a.js"><link rel="prefetch" href="/prepare/assets/js/39.90d1991c.js"><link rel="prefetch" href="/prepare/assets/js/390.0f0af822.js"><link rel="prefetch" href="/prepare/assets/js/391.42710fdf.js"><link rel="prefetch" href="/prepare/assets/js/392.a75d8d96.js"><link rel="prefetch" href="/prepare/assets/js/393.897b9d43.js"><link rel="prefetch" href="/prepare/assets/js/394.f82a390c.js"><link rel="prefetch" href="/prepare/assets/js/395.cd79fac0.js"><link rel="prefetch" href="/prepare/assets/js/396.a08270a9.js"><link rel="prefetch" href="/prepare/assets/js/397.7817db7d.js"><link rel="prefetch" href="/prepare/assets/js/398.06e4c151.js"><link rel="prefetch" href="/prepare/assets/js/399.98b6f25e.js"><link rel="prefetch" href="/prepare/assets/js/4.deb2474e.js"><link rel="prefetch" href="/prepare/assets/js/40.9dbbfabf.js"><link rel="prefetch" href="/prepare/assets/js/400.7d83ece0.js"><link rel="prefetch" href="/prepare/assets/js/401.f6085e42.js"><link rel="prefetch" href="/prepare/assets/js/402.8c1805ed.js"><link rel="prefetch" href="/prepare/assets/js/403.edb3313a.js"><link rel="prefetch" href="/prepare/assets/js/404.7b6fa829.js"><link rel="prefetch" href="/prepare/assets/js/405.6ef2b086.js"><link rel="prefetch" href="/prepare/assets/js/406.60202aef.js"><link rel="prefetch" href="/prepare/assets/js/407.208da993.js"><link rel="prefetch" href="/prepare/assets/js/408.1e8b4916.js"><link rel="prefetch" href="/prepare/assets/js/409.253c9d37.js"><link rel="prefetch" href="/prepare/assets/js/41.ef34b856.js"><link rel="prefetch" href="/prepare/assets/js/410.a105bf27.js"><link rel="prefetch" href="/prepare/assets/js/411.a4ead3f0.js"><link rel="prefetch" href="/prepare/assets/js/412.5d85f6ae.js"><link rel="prefetch" href="/prepare/assets/js/413.9b580f76.js"><link rel="prefetch" href="/prepare/assets/js/414.fedb5996.js"><link rel="prefetch" href="/prepare/assets/js/415.a8e6052a.js"><link rel="prefetch" href="/prepare/assets/js/416.e18a7b2c.js"><link rel="prefetch" href="/prepare/assets/js/417.6aecefa5.js"><link rel="prefetch" href="/prepare/assets/js/418.f31a3315.js"><link rel="prefetch" href="/prepare/assets/js/419.63a49f0d.js"><link rel="prefetch" href="/prepare/assets/js/42.92f2416e.js"><link rel="prefetch" href="/prepare/assets/js/420.ae48e884.js"><link rel="prefetch" href="/prepare/assets/js/421.b08c930a.js"><link rel="prefetch" href="/prepare/assets/js/422.32e42cc4.js"><link rel="prefetch" href="/prepare/assets/js/423.f6179ab3.js"><link rel="prefetch" href="/prepare/assets/js/424.fa5abb35.js"><link rel="prefetch" href="/prepare/assets/js/425.9c21ac05.js"><link rel="prefetch" href="/prepare/assets/js/426.3ab08b58.js"><link rel="prefetch" href="/prepare/assets/js/427.f76cdf1d.js"><link rel="prefetch" href="/prepare/assets/js/428.85990eae.js"><link rel="prefetch" href="/prepare/assets/js/429.716e1d23.js"><link rel="prefetch" href="/prepare/assets/js/43.edf01c7a.js"><link rel="prefetch" href="/prepare/assets/js/430.95a828f5.js"><link rel="prefetch" href="/prepare/assets/js/431.9bfd5449.js"><link rel="prefetch" href="/prepare/assets/js/432.9a566716.js"><link rel="prefetch" href="/prepare/assets/js/433.01139265.js"><link rel="prefetch" href="/prepare/assets/js/434.d7a19880.js"><link rel="prefetch" href="/prepare/assets/js/435.9a8746ac.js"><link rel="prefetch" href="/prepare/assets/js/436.ec5fcfba.js"><link rel="prefetch" href="/prepare/assets/js/437.44e65d79.js"><link rel="prefetch" href="/prepare/assets/js/438.13a6a166.js"><link rel="prefetch" href="/prepare/assets/js/439.2d4d4148.js"><link rel="prefetch" href="/prepare/assets/js/44.32e43797.js"><link rel="prefetch" href="/prepare/assets/js/440.ad3fdb6d.js"><link rel="prefetch" href="/prepare/assets/js/441.45064c53.js"><link rel="prefetch" href="/prepare/assets/js/442.cfcc7f1d.js"><link rel="prefetch" href="/prepare/assets/js/443.f4f1cb3c.js"><link rel="prefetch" href="/prepare/assets/js/444.e9c81370.js"><link rel="prefetch" href="/prepare/assets/js/445.89ce86b1.js"><link rel="prefetch" href="/prepare/assets/js/446.f038c3cf.js"><link rel="prefetch" href="/prepare/assets/js/447.f26f0a29.js"><link rel="prefetch" href="/prepare/assets/js/448.a1c0e1d4.js"><link rel="prefetch" href="/prepare/assets/js/449.d0e2b72c.js"><link rel="prefetch" href="/prepare/assets/js/45.21a2127a.js"><link rel="prefetch" href="/prepare/assets/js/450.9f488eaa.js"><link rel="prefetch" href="/prepare/assets/js/451.bd8cc1e1.js"><link rel="prefetch" href="/prepare/assets/js/452.ebe45f6b.js"><link rel="prefetch" href="/prepare/assets/js/453.bdfb61e0.js"><link rel="prefetch" href="/prepare/assets/js/454.95b7a984.js"><link rel="prefetch" href="/prepare/assets/js/455.717e1e6c.js"><link rel="prefetch" href="/prepare/assets/js/456.8b69db69.js"><link rel="prefetch" href="/prepare/assets/js/457.7a929397.js"><link rel="prefetch" href="/prepare/assets/js/458.804edf97.js"><link rel="prefetch" href="/prepare/assets/js/459.db67d2a9.js"><link rel="prefetch" href="/prepare/assets/js/46.eb13f192.js"><link rel="prefetch" href="/prepare/assets/js/460.a200873e.js"><link rel="prefetch" href="/prepare/assets/js/461.bd28388c.js"><link rel="prefetch" href="/prepare/assets/js/462.81ccc53e.js"><link rel="prefetch" href="/prepare/assets/js/463.6c47da66.js"><link rel="prefetch" href="/prepare/assets/js/464.e5b6782e.js"><link rel="prefetch" href="/prepare/assets/js/465.e67f547a.js"><link rel="prefetch" href="/prepare/assets/js/466.4c7cd738.js"><link rel="prefetch" href="/prepare/assets/js/467.8657c0cf.js"><link rel="prefetch" href="/prepare/assets/js/468.08bc3836.js"><link rel="prefetch" href="/prepare/assets/js/469.00c4b17e.js"><link rel="prefetch" href="/prepare/assets/js/47.00f49482.js"><link rel="prefetch" href="/prepare/assets/js/470.e03d4f64.js"><link rel="prefetch" href="/prepare/assets/js/471.2e52eb1e.js"><link rel="prefetch" href="/prepare/assets/js/472.adfc544f.js"><link rel="prefetch" href="/prepare/assets/js/473.154de722.js"><link rel="prefetch" href="/prepare/assets/js/474.2516ce21.js"><link rel="prefetch" href="/prepare/assets/js/475.ab26a2ad.js"><link rel="prefetch" href="/prepare/assets/js/476.775b4a5f.js"><link rel="prefetch" href="/prepare/assets/js/477.13b98428.js"><link rel="prefetch" href="/prepare/assets/js/478.1115c467.js"><link rel="prefetch" href="/prepare/assets/js/479.bf438781.js"><link rel="prefetch" href="/prepare/assets/js/48.143c0fcd.js"><link rel="prefetch" href="/prepare/assets/js/480.f174f9a8.js"><link rel="prefetch" href="/prepare/assets/js/481.cec3bf00.js"><link rel="prefetch" href="/prepare/assets/js/482.f890a841.js"><link rel="prefetch" href="/prepare/assets/js/483.afa24986.js"><link rel="prefetch" href="/prepare/assets/js/484.75e9a7af.js"><link rel="prefetch" href="/prepare/assets/js/485.5b8d049b.js"><link rel="prefetch" href="/prepare/assets/js/486.c30c41de.js"><link rel="prefetch" href="/prepare/assets/js/487.132aac57.js"><link rel="prefetch" href="/prepare/assets/js/488.28d79e0e.js"><link rel="prefetch" href="/prepare/assets/js/489.1dfe4d76.js"><link rel="prefetch" href="/prepare/assets/js/49.80d345d9.js"><link rel="prefetch" href="/prepare/assets/js/490.19532f53.js"><link rel="prefetch" href="/prepare/assets/js/491.28f1f3e5.js"><link rel="prefetch" href="/prepare/assets/js/492.ef9c24aa.js"><link rel="prefetch" href="/prepare/assets/js/493.9572e0ed.js"><link rel="prefetch" href="/prepare/assets/js/494.4a167e6e.js"><link rel="prefetch" href="/prepare/assets/js/495.b2db249c.js"><link rel="prefetch" href="/prepare/assets/js/496.60e0072a.js"><link rel="prefetch" href="/prepare/assets/js/497.def23ef1.js"><link rel="prefetch" href="/prepare/assets/js/498.075390b6.js"><link rel="prefetch" href="/prepare/assets/js/499.e238a946.js"><link rel="prefetch" href="/prepare/assets/js/5.a57b603d.js"><link rel="prefetch" href="/prepare/assets/js/50.fef33694.js"><link rel="prefetch" href="/prepare/assets/js/500.6437184a.js"><link rel="prefetch" href="/prepare/assets/js/501.0bf4ac23.js"><link rel="prefetch" href="/prepare/assets/js/502.d9dc707e.js"><link rel="prefetch" href="/prepare/assets/js/503.d3234bad.js"><link rel="prefetch" href="/prepare/assets/js/504.34ca38f9.js"><link rel="prefetch" href="/prepare/assets/js/505.912a8cd0.js"><link rel="prefetch" href="/prepare/assets/js/506.0afae8f8.js"><link rel="prefetch" href="/prepare/assets/js/507.c261f29d.js"><link rel="prefetch" href="/prepare/assets/js/508.e7d3445e.js"><link rel="prefetch" href="/prepare/assets/js/509.d702a77b.js"><link rel="prefetch" href="/prepare/assets/js/51.5b4b4e29.js"><link rel="prefetch" href="/prepare/assets/js/510.527b812e.js"><link rel="prefetch" href="/prepare/assets/js/511.864b0d3f.js"><link rel="prefetch" href="/prepare/assets/js/512.8b9b82d7.js"><link rel="prefetch" href="/prepare/assets/js/513.256fd3c2.js"><link rel="prefetch" href="/prepare/assets/js/514.ae2179b6.js"><link rel="prefetch" href="/prepare/assets/js/515.bc4fa5b0.js"><link rel="prefetch" href="/prepare/assets/js/516.c38ba561.js"><link rel="prefetch" href="/prepare/assets/js/517.51984326.js"><link rel="prefetch" href="/prepare/assets/js/518.3f47f081.js"><link rel="prefetch" href="/prepare/assets/js/519.ae18498f.js"><link rel="prefetch" href="/prepare/assets/js/52.2433e887.js"><link rel="prefetch" href="/prepare/assets/js/520.e8cf39b0.js"><link rel="prefetch" href="/prepare/assets/js/521.87ed42b7.js"><link rel="prefetch" href="/prepare/assets/js/522.3d7605bf.js"><link rel="prefetch" href="/prepare/assets/js/523.2f0bbf04.js"><link rel="prefetch" href="/prepare/assets/js/524.b813b532.js"><link rel="prefetch" href="/prepare/assets/js/525.a5b10f42.js"><link rel="prefetch" href="/prepare/assets/js/526.ffc49ffe.js"><link rel="prefetch" href="/prepare/assets/js/527.cb06cf54.js"><link rel="prefetch" href="/prepare/assets/js/528.10d369f4.js"><link rel="prefetch" href="/prepare/assets/js/529.d719bb28.js"><link rel="prefetch" href="/prepare/assets/js/53.086ca660.js"><link rel="prefetch" href="/prepare/assets/js/530.2e5136a6.js"><link rel="prefetch" href="/prepare/assets/js/531.455d1463.js"><link rel="prefetch" href="/prepare/assets/js/532.8ca13041.js"><link rel="prefetch" href="/prepare/assets/js/533.5cda3252.js"><link rel="prefetch" href="/prepare/assets/js/534.90555bf7.js"><link rel="prefetch" href="/prepare/assets/js/535.bef0d568.js"><link rel="prefetch" href="/prepare/assets/js/536.3a57d71f.js"><link rel="prefetch" href="/prepare/assets/js/537.dcc1b8ea.js"><link rel="prefetch" href="/prepare/assets/js/538.83cb57c0.js"><link rel="prefetch" href="/prepare/assets/js/539.204384d0.js"><link rel="prefetch" href="/prepare/assets/js/54.635a7266.js"><link rel="prefetch" href="/prepare/assets/js/540.5de6d18c.js"><link rel="prefetch" href="/prepare/assets/js/541.95c11fdb.js"><link rel="prefetch" href="/prepare/assets/js/542.393ea3b6.js"><link rel="prefetch" href="/prepare/assets/js/543.194fb7b2.js"><link rel="prefetch" href="/prepare/assets/js/544.cb31849c.js"><link rel="prefetch" href="/prepare/assets/js/545.88a30588.js"><link rel="prefetch" href="/prepare/assets/js/546.a20dd6df.js"><link rel="prefetch" href="/prepare/assets/js/547.33f1f124.js"><link rel="prefetch" href="/prepare/assets/js/548.d4a8b375.js"><link rel="prefetch" href="/prepare/assets/js/549.fff24f01.js"><link rel="prefetch" href="/prepare/assets/js/55.c8f5379d.js"><link rel="prefetch" href="/prepare/assets/js/550.cf151aab.js"><link rel="prefetch" href="/prepare/assets/js/551.7d65273b.js"><link rel="prefetch" href="/prepare/assets/js/552.eea4caec.js"><link rel="prefetch" href="/prepare/assets/js/553.92e81200.js"><link rel="prefetch" href="/prepare/assets/js/554.b54aafec.js"><link rel="prefetch" href="/prepare/assets/js/555.bde77fc8.js"><link rel="prefetch" href="/prepare/assets/js/556.3cb6abf7.js"><link rel="prefetch" href="/prepare/assets/js/557.3b14051c.js"><link rel="prefetch" href="/prepare/assets/js/558.b5276352.js"><link rel="prefetch" href="/prepare/assets/js/559.3467e9d3.js"><link rel="prefetch" href="/prepare/assets/js/56.4811b1a4.js"><link rel="prefetch" href="/prepare/assets/js/560.f6a84448.js"><link rel="prefetch" href="/prepare/assets/js/561.346e4bba.js"><link rel="prefetch" href="/prepare/assets/js/562.cb863df8.js"><link rel="prefetch" href="/prepare/assets/js/563.f6b75d41.js"><link rel="prefetch" href="/prepare/assets/js/564.80f97a9b.js"><link rel="prefetch" href="/prepare/assets/js/565.a1098038.js"><link rel="prefetch" href="/prepare/assets/js/566.eba64999.js"><link rel="prefetch" href="/prepare/assets/js/567.adf2df2b.js"><link rel="prefetch" href="/prepare/assets/js/568.f9cad91c.js"><link rel="prefetch" href="/prepare/assets/js/569.62b599f1.js"><link rel="prefetch" href="/prepare/assets/js/57.42ff1d33.js"><link rel="prefetch" href="/prepare/assets/js/570.943f96f6.js"><link rel="prefetch" href="/prepare/assets/js/571.a413b109.js"><link rel="prefetch" href="/prepare/assets/js/572.154ca760.js"><link rel="prefetch" href="/prepare/assets/js/573.8a1f8b96.js"><link rel="prefetch" href="/prepare/assets/js/574.0ed21853.js"><link rel="prefetch" href="/prepare/assets/js/575.bd353ac4.js"><link rel="prefetch" href="/prepare/assets/js/576.130c67fc.js"><link rel="prefetch" href="/prepare/assets/js/577.facf742a.js"><link rel="prefetch" href="/prepare/assets/js/578.b0ad9235.js"><link rel="prefetch" href="/prepare/assets/js/579.e2b66704.js"><link rel="prefetch" href="/prepare/assets/js/58.62a7a83c.js"><link rel="prefetch" href="/prepare/assets/js/580.e3724772.js"><link rel="prefetch" href="/prepare/assets/js/581.d789d7e4.js"><link rel="prefetch" href="/prepare/assets/js/582.ab221baa.js"><link rel="prefetch" href="/prepare/assets/js/583.0edc4c07.js"><link rel="prefetch" href="/prepare/assets/js/584.fde71c54.js"><link rel="prefetch" href="/prepare/assets/js/585.dfac8f68.js"><link rel="prefetch" href="/prepare/assets/js/586.07c9cabd.js"><link rel="prefetch" href="/prepare/assets/js/587.f6b20f0b.js"><link rel="prefetch" href="/prepare/assets/js/588.6a0248d8.js"><link rel="prefetch" href="/prepare/assets/js/589.4c6c4080.js"><link rel="prefetch" href="/prepare/assets/js/59.003ad046.js"><link rel="prefetch" href="/prepare/assets/js/590.4add70c5.js"><link rel="prefetch" href="/prepare/assets/js/591.6fd48a94.js"><link rel="prefetch" href="/prepare/assets/js/592.4584fe80.js"><link rel="prefetch" href="/prepare/assets/js/593.468bc146.js"><link rel="prefetch" href="/prepare/assets/js/594.c6eeda69.js"><link rel="prefetch" href="/prepare/assets/js/595.8f79c425.js"><link rel="prefetch" href="/prepare/assets/js/596.cb91d326.js"><link rel="prefetch" href="/prepare/assets/js/597.0446976d.js"><link rel="prefetch" href="/prepare/assets/js/598.184e0a9f.js"><link rel="prefetch" href="/prepare/assets/js/599.67d1b2e9.js"><link rel="prefetch" href="/prepare/assets/js/6.5e2b7fc9.js"><link rel="prefetch" href="/prepare/assets/js/60.ea3531ce.js"><link rel="prefetch" href="/prepare/assets/js/600.8cca3e28.js"><link rel="prefetch" href="/prepare/assets/js/601.58e7ef70.js"><link rel="prefetch" href="/prepare/assets/js/602.c36b01d9.js"><link rel="prefetch" href="/prepare/assets/js/603.be3ceb6a.js"><link rel="prefetch" href="/prepare/assets/js/604.6aa120cf.js"><link rel="prefetch" href="/prepare/assets/js/605.15135a2d.js"><link rel="prefetch" href="/prepare/assets/js/606.deb79c8f.js"><link rel="prefetch" href="/prepare/assets/js/607.bc140e12.js"><link rel="prefetch" href="/prepare/assets/js/608.55e119bc.js"><link rel="prefetch" href="/prepare/assets/js/609.9cc46d3a.js"><link rel="prefetch" href="/prepare/assets/js/61.00b69eba.js"><link rel="prefetch" href="/prepare/assets/js/610.428a6aa1.js"><link rel="prefetch" href="/prepare/assets/js/611.eda779d7.js"><link rel="prefetch" href="/prepare/assets/js/612.7b88907d.js"><link rel="prefetch" href="/prepare/assets/js/613.4bb5981e.js"><link rel="prefetch" href="/prepare/assets/js/614.e061fb82.js"><link rel="prefetch" href="/prepare/assets/js/615.7e466378.js"><link rel="prefetch" href="/prepare/assets/js/616.33be00c6.js"><link rel="prefetch" href="/prepare/assets/js/617.77361578.js"><link rel="prefetch" href="/prepare/assets/js/618.995ebe2e.js"><link rel="prefetch" href="/prepare/assets/js/619.9f580c89.js"><link rel="prefetch" href="/prepare/assets/js/62.17d33de0.js"><link rel="prefetch" href="/prepare/assets/js/620.66e4e0a5.js"><link rel="prefetch" href="/prepare/assets/js/621.c2b96f20.js"><link rel="prefetch" href="/prepare/assets/js/622.ff94c2b4.js"><link rel="prefetch" href="/prepare/assets/js/623.28cad2f6.js"><link rel="prefetch" href="/prepare/assets/js/624.c7721b24.js"><link rel="prefetch" href="/prepare/assets/js/625.1ae12154.js"><link rel="prefetch" href="/prepare/assets/js/626.1dc48758.js"><link rel="prefetch" href="/prepare/assets/js/627.ac903696.js"><link rel="prefetch" href="/prepare/assets/js/628.ecd3cab9.js"><link rel="prefetch" href="/prepare/assets/js/629.4c7f1cc5.js"><link rel="prefetch" href="/prepare/assets/js/63.ccf879ce.js"><link rel="prefetch" href="/prepare/assets/js/630.f98d193f.js"><link rel="prefetch" href="/prepare/assets/js/631.0aa729e4.js"><link rel="prefetch" href="/prepare/assets/js/632.63571339.js"><link rel="prefetch" href="/prepare/assets/js/633.7e684afc.js"><link rel="prefetch" href="/prepare/assets/js/634.82b543ca.js"><link rel="prefetch" href="/prepare/assets/js/635.1706e751.js"><link rel="prefetch" href="/prepare/assets/js/636.0de2a875.js"><link rel="prefetch" href="/prepare/assets/js/637.e13541a9.js"><link rel="prefetch" href="/prepare/assets/js/638.0c6b0b3a.js"><link rel="prefetch" href="/prepare/assets/js/639.0aad91d7.js"><link rel="prefetch" href="/prepare/assets/js/64.326db143.js"><link rel="prefetch" href="/prepare/assets/js/640.6cc8cd5d.js"><link rel="prefetch" href="/prepare/assets/js/641.a47c4dcf.js"><link rel="prefetch" href="/prepare/assets/js/642.813cdcb0.js"><link rel="prefetch" href="/prepare/assets/js/643.32ac692b.js"><link rel="prefetch" href="/prepare/assets/js/644.885890eb.js"><link rel="prefetch" href="/prepare/assets/js/645.8851569e.js"><link rel="prefetch" href="/prepare/assets/js/646.2fb9aa6d.js"><link rel="prefetch" href="/prepare/assets/js/647.b20513d2.js"><link rel="prefetch" href="/prepare/assets/js/648.b9b768ad.js"><link rel="prefetch" href="/prepare/assets/js/649.a629d04b.js"><link rel="prefetch" href="/prepare/assets/js/65.7323635e.js"><link rel="prefetch" href="/prepare/assets/js/650.99847943.js"><link rel="prefetch" href="/prepare/assets/js/651.8dd7f6bc.js"><link rel="prefetch" href="/prepare/assets/js/652.d5e768c7.js"><link rel="prefetch" href="/prepare/assets/js/653.e5873b9d.js"><link rel="prefetch" href="/prepare/assets/js/654.0923848e.js"><link rel="prefetch" href="/prepare/assets/js/655.acbeabd4.js"><link rel="prefetch" href="/prepare/assets/js/656.d5a6b8a9.js"><link rel="prefetch" href="/prepare/assets/js/657.dabafb69.js"><link rel="prefetch" href="/prepare/assets/js/658.68e5abc2.js"><link rel="prefetch" href="/prepare/assets/js/659.7886fece.js"><link rel="prefetch" href="/prepare/assets/js/66.94678dd2.js"><link rel="prefetch" href="/prepare/assets/js/660.50cd3c40.js"><link rel="prefetch" href="/prepare/assets/js/661.9df747ee.js"><link rel="prefetch" href="/prepare/assets/js/662.c998b28a.js"><link rel="prefetch" href="/prepare/assets/js/663.147310a8.js"><link rel="prefetch" href="/prepare/assets/js/664.2e379d19.js"><link rel="prefetch" href="/prepare/assets/js/665.b3e3be4c.js"><link rel="prefetch" href="/prepare/assets/js/666.b96f423c.js"><link rel="prefetch" href="/prepare/assets/js/667.f86319dd.js"><link rel="prefetch" href="/prepare/assets/js/668.fc20350c.js"><link rel="prefetch" href="/prepare/assets/js/669.180cd02f.js"><link rel="prefetch" href="/prepare/assets/js/67.4ea98f67.js"><link rel="prefetch" href="/prepare/assets/js/670.241f5099.js"><link rel="prefetch" href="/prepare/assets/js/671.9db3e800.js"><link rel="prefetch" href="/prepare/assets/js/672.87c8338d.js"><link rel="prefetch" href="/prepare/assets/js/673.ca553857.js"><link rel="prefetch" href="/prepare/assets/js/674.5b39ad0e.js"><link rel="prefetch" href="/prepare/assets/js/675.b062d8ca.js"><link rel="prefetch" href="/prepare/assets/js/676.86cc8bb2.js"><link rel="prefetch" href="/prepare/assets/js/677.f27f86db.js"><link rel="prefetch" href="/prepare/assets/js/678.fe94c7fb.js"><link rel="prefetch" href="/prepare/assets/js/679.d06b203b.js"><link rel="prefetch" href="/prepare/assets/js/68.f7bcdefa.js"><link rel="prefetch" href="/prepare/assets/js/680.f850bae4.js"><link rel="prefetch" href="/prepare/assets/js/681.7c2065f7.js"><link rel="prefetch" href="/prepare/assets/js/682.f6ce308a.js"><link rel="prefetch" href="/prepare/assets/js/683.6fad5e4d.js"><link rel="prefetch" href="/prepare/assets/js/684.3757543e.js"><link rel="prefetch" href="/prepare/assets/js/685.3172de78.js"><link rel="prefetch" href="/prepare/assets/js/686.5902022c.js"><link rel="prefetch" href="/prepare/assets/js/687.18fe87a3.js"><link rel="prefetch" href="/prepare/assets/js/688.3ec8725e.js"><link rel="prefetch" href="/prepare/assets/js/689.a6542793.js"><link rel="prefetch" href="/prepare/assets/js/69.c383e04c.js"><link rel="prefetch" href="/prepare/assets/js/690.76447f0d.js"><link rel="prefetch" href="/prepare/assets/js/691.c00410de.js"><link rel="prefetch" href="/prepare/assets/js/692.1cbf6002.js"><link rel="prefetch" href="/prepare/assets/js/693.6fe32b83.js"><link rel="prefetch" href="/prepare/assets/js/694.38315ef2.js"><link rel="prefetch" href="/prepare/assets/js/695.1684ccf0.js"><link rel="prefetch" href="/prepare/assets/js/696.ad2a4f9e.js"><link rel="prefetch" href="/prepare/assets/js/697.69c444ad.js"><link rel="prefetch" href="/prepare/assets/js/698.892eb1e3.js"><link rel="prefetch" href="/prepare/assets/js/699.6fd26915.js"><link rel="prefetch" href="/prepare/assets/js/7.6e89a6dc.js"><link rel="prefetch" href="/prepare/assets/js/70.aba5a496.js"><link rel="prefetch" href="/prepare/assets/js/700.30652b05.js"><link rel="prefetch" href="/prepare/assets/js/701.88b65cb6.js"><link rel="prefetch" href="/prepare/assets/js/702.edf3f6e8.js"><link rel="prefetch" href="/prepare/assets/js/703.935e0579.js"><link rel="prefetch" href="/prepare/assets/js/704.21e2d90e.js"><link rel="prefetch" href="/prepare/assets/js/705.1d99952b.js"><link rel="prefetch" href="/prepare/assets/js/706.c89ec504.js"><link rel="prefetch" href="/prepare/assets/js/707.c3872a5b.js"><link rel="prefetch" href="/prepare/assets/js/708.50a13b49.js"><link rel="prefetch" href="/prepare/assets/js/709.b3e49d10.js"><link rel="prefetch" href="/prepare/assets/js/71.1c244e7c.js"><link rel="prefetch" href="/prepare/assets/js/710.bf2a97d9.js"><link rel="prefetch" href="/prepare/assets/js/711.ea06fe31.js"><link rel="prefetch" href="/prepare/assets/js/712.325711c0.js"><link rel="prefetch" href="/prepare/assets/js/713.4ac28fc3.js"><link rel="prefetch" href="/prepare/assets/js/714.ef5ea502.js"><link rel="prefetch" href="/prepare/assets/js/715.78653aee.js"><link rel="prefetch" href="/prepare/assets/js/716.7b14ba94.js"><link rel="prefetch" href="/prepare/assets/js/717.4c3439fa.js"><link rel="prefetch" href="/prepare/assets/js/718.4fda4f01.js"><link rel="prefetch" href="/prepare/assets/js/719.275e7556.js"><link rel="prefetch" href="/prepare/assets/js/72.af5f48e8.js"><link rel="prefetch" href="/prepare/assets/js/720.05ca9f88.js"><link rel="prefetch" href="/prepare/assets/js/721.add21244.js"><link rel="prefetch" href="/prepare/assets/js/722.006b0234.js"><link rel="prefetch" href="/prepare/assets/js/723.11e186e3.js"><link rel="prefetch" href="/prepare/assets/js/724.aa3c2811.js"><link rel="prefetch" href="/prepare/assets/js/725.9b9ee5a7.js"><link rel="prefetch" href="/prepare/assets/js/726.a9afe968.js"><link rel="prefetch" href="/prepare/assets/js/727.755fa239.js"><link rel="prefetch" href="/prepare/assets/js/728.ce60f971.js"><link rel="prefetch" href="/prepare/assets/js/729.a8cc63d8.js"><link rel="prefetch" href="/prepare/assets/js/73.7cfd3fce.js"><link rel="prefetch" href="/prepare/assets/js/730.697aab97.js"><link rel="prefetch" href="/prepare/assets/js/731.4cf23cc5.js"><link rel="prefetch" href="/prepare/assets/js/732.f8f145f7.js"><link rel="prefetch" href="/prepare/assets/js/733.8a3ba797.js"><link rel="prefetch" href="/prepare/assets/js/734.3356a6b9.js"><link rel="prefetch" href="/prepare/assets/js/735.95d8e57d.js"><link rel="prefetch" href="/prepare/assets/js/736.41ee2231.js"><link rel="prefetch" href="/prepare/assets/js/737.36f76b77.js"><link rel="prefetch" href="/prepare/assets/js/738.5ed3aeb0.js"><link rel="prefetch" href="/prepare/assets/js/739.981b9f42.js"><link rel="prefetch" href="/prepare/assets/js/74.109aa626.js"><link rel="prefetch" href="/prepare/assets/js/740.f03e2ed3.js"><link rel="prefetch" href="/prepare/assets/js/741.48dd1192.js"><link rel="prefetch" href="/prepare/assets/js/742.a2213028.js"><link rel="prefetch" href="/prepare/assets/js/743.8da1c689.js"><link rel="prefetch" href="/prepare/assets/js/744.e3bbc2dc.js"><link rel="prefetch" href="/prepare/assets/js/745.ea339565.js"><link rel="prefetch" href="/prepare/assets/js/746.01683249.js"><link rel="prefetch" href="/prepare/assets/js/747.d7e016f3.js"><link rel="prefetch" href="/prepare/assets/js/748.ad718c46.js"><link rel="prefetch" href="/prepare/assets/js/749.c8724e10.js"><link rel="prefetch" href="/prepare/assets/js/75.6b79073a.js"><link rel="prefetch" href="/prepare/assets/js/750.eda65948.js"><link rel="prefetch" href="/prepare/assets/js/751.558c0dc4.js"><link rel="prefetch" href="/prepare/assets/js/752.64eb3e0d.js"><link rel="prefetch" href="/prepare/assets/js/753.6d1f0364.js"><link rel="prefetch" href="/prepare/assets/js/754.e5719dfc.js"><link rel="prefetch" href="/prepare/assets/js/755.de5e7020.js"><link rel="prefetch" href="/prepare/assets/js/756.191f63dd.js"><link rel="prefetch" href="/prepare/assets/js/757.58a5380d.js"><link rel="prefetch" href="/prepare/assets/js/758.a2b17f5e.js"><link rel="prefetch" href="/prepare/assets/js/759.942ed74d.js"><link rel="prefetch" href="/prepare/assets/js/76.48a21184.js"><link rel="prefetch" href="/prepare/assets/js/760.00add3dd.js"><link rel="prefetch" href="/prepare/assets/js/761.017758b2.js"><link rel="prefetch" href="/prepare/assets/js/762.c5b9bd34.js"><link rel="prefetch" href="/prepare/assets/js/763.c9804088.js"><link rel="prefetch" href="/prepare/assets/js/764.c8b25bae.js"><link rel="prefetch" href="/prepare/assets/js/765.6751454a.js"><link rel="prefetch" href="/prepare/assets/js/766.d27de5fc.js"><link rel="prefetch" href="/prepare/assets/js/767.4d4a731f.js"><link rel="prefetch" href="/prepare/assets/js/768.34c2fee7.js"><link rel="prefetch" href="/prepare/assets/js/769.be826a5e.js"><link rel="prefetch" href="/prepare/assets/js/77.542ef47e.js"><link rel="prefetch" href="/prepare/assets/js/78.3a524a25.js"><link rel="prefetch" href="/prepare/assets/js/79.2fe27234.js"><link rel="prefetch" href="/prepare/assets/js/8.d29fd3b1.js"><link rel="prefetch" href="/prepare/assets/js/80.8cd9dfb6.js"><link rel="prefetch" href="/prepare/assets/js/81.8423bba7.js"><link rel="prefetch" href="/prepare/assets/js/82.588f822a.js"><link rel="prefetch" href="/prepare/assets/js/83.69a0606d.js"><link rel="prefetch" href="/prepare/assets/js/84.77a38cdc.js"><link rel="prefetch" href="/prepare/assets/js/85.1807ffc9.js"><link rel="prefetch" href="/prepare/assets/js/86.d75f8a48.js"><link rel="prefetch" href="/prepare/assets/js/87.4c9d349c.js"><link rel="prefetch" href="/prepare/assets/js/88.871ce8b3.js"><link rel="prefetch" href="/prepare/assets/js/89.339dc49d.js"><link rel="prefetch" href="/prepare/assets/js/9.7a823e5f.js"><link rel="prefetch" href="/prepare/assets/js/90.8c56aa70.js"><link rel="prefetch" href="/prepare/assets/js/91.68daa697.js"><link rel="prefetch" href="/prepare/assets/js/92.116a047d.js"><link rel="prefetch" href="/prepare/assets/js/93.907aee8d.js"><link rel="prefetch" href="/prepare/assets/js/94.bf3f3be9.js"><link rel="prefetch" href="/prepare/assets/js/95.87adc61c.js"><link rel="prefetch" href="/prepare/assets/js/96.a5cf7209.js"><link rel="prefetch" href="/prepare/assets/js/97.e58ea87c.js"><link rel="prefetch" href="/prepare/assets/js/98.85f6c3dd.js"><link rel="prefetch" href="/prepare/assets/js/99.85f1886e.js">
    <link rel="stylesheet" href="/prepare/assets/css/0.styles.cacbc208.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/prepare/" class="home-link router-link-active"><!----> <span class="site-name">Lu notes</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/prepare/" class="nav-link">首页</a></div><div class="nav-item"><a href="/prepare/js/" class="nav-link router-link-active">Js</a></div><div class="nav-item"><a href="/prepare/react/" class="nav-link">React</a></div><div class="nav-item"><a href="/prepare/vue/" class="nav-link">Vue</a></div><div class="nav-item"><a href="/prepare/framework/" class="nav-link">框架通识</a></div><div class="nav-item"><a href="/prepare/safety/" class="nav-link">安全性能</a></div><div class="nav-item"><a href="/prepare/prepare/" class="nav-link">Prepare</a></div><div class="nav-item"><a href="/prepare/fullstack/" class="nav-link">FullStack</a></div><div class="nav-item"><a href="/prepare/handrolledcode/" class="nav-link">手撸代码无敌</a></div><div class="nav-item"><a href="/prepare/dataalgorithm/" class="nav-link">数据算法</a></div><div class="nav-item"><a href="/prepare/engineering/" class="nav-link">工程化</a></div><div class="nav-item"><a href="/prepare/other/" class="nav-link">其他</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/prepare/" class="nav-link">首页</a></div><div class="nav-item"><a href="/prepare/js/" class="nav-link router-link-active">Js</a></div><div class="nav-item"><a href="/prepare/react/" class="nav-link">React</a></div><div class="nav-item"><a href="/prepare/vue/" class="nav-link">Vue</a></div><div class="nav-item"><a href="/prepare/framework/" class="nav-link">框架通识</a></div><div class="nav-item"><a href="/prepare/safety/" class="nav-link">安全性能</a></div><div class="nav-item"><a href="/prepare/prepare/" class="nav-link">Prepare</a></div><div class="nav-item"><a href="/prepare/fullstack/" class="nav-link">FullStack</a></div><div class="nav-item"><a href="/prepare/handrolledcode/" class="nav-link">手撸代码无敌</a></div><div class="nav-item"><a href="/prepare/dataalgorithm/" class="nav-link">数据算法</a></div><div class="nav-item"><a href="/prepare/engineering/" class="nav-link">工程化</a></div><div class="nav-item"><a href="/prepare/other/" class="nav-link">其他</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><a href="/prepare/js/collection/" class="sidebar-heading clickable"><span>collection</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/prepare/js/H5/" class="sidebar-heading clickable"><span>H5</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/prepare/js/js基础/" class="sidebar-heading clickable"><span>js基础</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/prepare/js/Koa/" class="sidebar-heading clickable"><span>Koa</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/prepare/js/NodeJs/" class="sidebar-heading clickable"><span>NodeJs</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/prepare/js/TypeScript/" class="sidebar-heading clickable router-link-active open"><span>TypeScript</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/prepare/js/TypeScript/01-Typescript.html" class="sidebar-link">01-Typescript</a></li><li><a href="/prepare/js/TypeScript/02-TypeScript2.8下的终极React组件模式.html" class="sidebar-link">02-TypeScript2.8下的终极React组件模式</a></li><li><a href="/prepare/js/TypeScript/03-TypeScript2特性.html" class="sidebar-link">03-TypeScript2特性</a></li><li><a href="/prepare/js/TypeScript/04-Typescript中概念解释.html" class="sidebar-link">04-Typescript中概念解释</a></li><li><a href="/prepare/js/TypeScript/05-learningTypeScript.html" class="sidebar-link">05-learningTypeScript</a></li><li><a href="/prepare/js/TypeScript/06-TS从零开发AXIOS.html" class="active sidebar-link">06-TS从零开发AXIOS</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/prepare/js/TypeScript/06-TS从零开发AXIOS.html#features" class="sidebar-link">Features</a></li><li class="sidebar-sub-header"><a href="/prepare/js/TypeScript/06-TS从零开发AXIOS.html#typescript-library-starter" class="sidebar-link">TypeScript library starter</a></li><li class="sidebar-sub-header"><a href="/prepare/js/TypeScript/06-TS从零开发AXIOS.html#接口拓展" class="sidebar-link">接口拓展</a></li><li class="sidebar-sub-header"><a href="/prepare/js/TypeScript/06-TS从零开发AXIOS.html#ts-axios-编译与发布" class="sidebar-link">ts-axios 编译与发布</a></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/prepare/js/基础/" class="sidebar-heading clickable"><span>基础</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/prepare/js/小程序/" class="sidebar-heading clickable"><span>小程序</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/prepare/js/数据库/" class="sidebar-heading clickable"><span>数据库</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/prepare/js/服务/" class="sidebar-heading clickable"><span>服务</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/prepare/js/正则/" class="sidebar-heading clickable"><span>正则</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/prepare/js/移动端/" class="sidebar-heading clickable"><span>移动端</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/prepare/js/面向对象/" class="sidebar-heading clickable"><span>面向对象</span> <span class="arrow right"></span></a> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="ts从零开发axios全系列"><a href="#ts从零开发axios全系列" aria-hidden="true" class="header-anchor">#</a> TS从零开发AXIOS全系列</h1> <ul><li><a href="#ts%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%8F%91axios%E5%85%A8%E7%B3%BB%E5%88%97">TS从零开发AXIOS全系列</a> <ul><li><a href="#features">Features</a></li> <li><a href="#typescript-library-starter">TypeScript library starter</a></li> <li><a href="#%E6%8E%A5%E5%8F%A3%E6%8B%93%E5%B1%95">接口拓展</a> <ul><li><a href="#%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90">需求分析</a></li> <li><a href="#%E6%8E%A5%E5%8F%A3%E7%B1%BB%E5%9E%8B%E5%AE%9A%E4%B9%89">接口类型定义</a></li> <li><a href="#%E5%88%9B%E5%BB%BA-axios-%E7%B1%BB">创建 Axios 类</a></li> <li><a href="#%E6%B7%B7%E5%90%88%E5%AF%B9%E8%B1%A1%E5%AE%9E%E7%8E%B0">混合对象实现</a></li> <li><a href="#demo-%E7%BC%96%E5%86%99">demo 编写</a></li></ul></li> <li><a href="#ts-axios-%E7%BC%96%E8%AF%91%E4%B8%8E%E5%8F%91%E5%B8%83">ts-axios 编译与发布</a> <ul><li><a href="#%E7%BC%96%E8%AF%91%E5%92%8C%E6%89%93%E5%8C%85">编译和打包</a></li> <li><a href="#%E4%BF%AE%E6%94%B9-rollupconfigts">修改 rollup.config.ts</a></li> <li><a href="#%E4%BF%AE%E6%94%B9-packagejson">修改 package.json</a></li> <li><a href="#%E8%87%AA%E5%8A%A8%E5%8C%96%E9%83%A8%E7%BD%B2">自动化部署</a></li> <li><a href="#%E4%BF%AE%E6%94%B9-packagejson-1">修改 package.json</a></li> <li><a href="#%E7%BC%96%E5%86%99%E9%83%A8%E7%BD%B2%E8%84%9A%E6%9C%AC">编写部署脚本</a></li> <li><a href="#%E8%BF%90%E8%A1%8C%E9%83%A8%E7%BD%B2%E8%84%9A%E6%9C%AC">运行部署脚本</a></li></ul></li></ul></li></ul> <h2 id="features"><a href="#features" aria-hidden="true" class="header-anchor">#</a> Features</h2> <ul><li>在浏览器端使用 XMLHttpRequest 对象通讯</li> <li>支持 Promise API</li> <li>支持请求和响应的拦截器</li> <li>支持请求数据和响应数据的转换</li> <li>支持请求的取消</li> <li>JSON 数据的自动转换</li> <li>客户端防止 XSRF</li></ul> <h2 id="typescript-library-starter"><a href="#typescript-library-starter" aria-hidden="true" class="header-anchor">#</a> TypeScript library starter</h2> <p>它是一个开源的 TypeScript 开发基础库的脚手架工具，可以帮助我们快速初始化一个 TypeScript 项目，</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> clone https://github.com/alexjoverm/typescript-library-starter.git lu-ts-axios
<span class="token builtin class-name">cd</span> lu-ts-axios

<span class="token function">npm</span> <span class="token function">install</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="接口拓展"><a href="#接口拓展" aria-hidden="true" class="header-anchor">#</a> 接口拓展</h2> <h3 id="需求分析"><a href="#需求分析" aria-hidden="true" class="header-anchor">#</a> 需求分析</h3> <p>为了用户更加方便地使用 axios 发送请求，我们可以为所有支持请求方法扩展一些接口：</p> <ul><li><p><code>axios.request(config)</code></p></li> <li><p><code>axios.get(url[, config])</code></p></li> <li><p><code>axios.delete(url[, config])</code></p></li> <li><p><code>axios.head(url[, config])</code></p></li> <li><p><code>axios.options(url[, config])</code></p></li> <li><p><code>axios.post(url[, data[, config]])</code></p></li> <li><p><code>axios.put(url[, data[, config]])</code></p></li> <li><p><code>axios.patch(url[, data[, config]])</code></p></li></ul> <p>如果使用了这些方法，我们就不必在 <code>config</code> 中指定 <code>url</code>、<code>method</code>、<code>data</code> 这些属性了。</p> <p>从需求上来看，<code>axios</code> 不再单单是一个方法，更像是一个混合对象，本身是一个方法，又有很多方法属性，接下来我们就来实现这个混合对象。</p> <h3 id="接口类型定义"><a href="#接口类型定义" aria-hidden="true" class="header-anchor">#</a> 接口类型定义</h3> <p>根据需求分析，混合对象 <code>axios</code> 本身是一个函数，我们再实现一个包括它属性方法的类，然后把这个类的原型属性和自身属性再拷贝到 <code>axios</code> 上。</p> <p>我们先来给 <code>axios</code> 混合对象定义接口：</p> <p><code>types/index.ts</code>：</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">Axios</span> <span class="token punctuation">{</span>
  <span class="token function">request</span><span class="token punctuation">(</span>config<span class="token punctuation">:</span> AxiosRequestConfig<span class="token punctuation">)</span><span class="token punctuation">:</span> AxiosPromise

  <span class="token keyword">get</span><span class="token punctuation">(</span>url<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> config<span class="token operator">?</span><span class="token punctuation">:</span> AxiosRequestConfig<span class="token punctuation">)</span><span class="token punctuation">:</span> AxiosPromise

  <span class="token keyword">delete</span><span class="token punctuation">(</span>url<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> config<span class="token operator">?</span><span class="token punctuation">:</span> AxiosRequestConfig<span class="token punctuation">)</span><span class="token punctuation">:</span> AxiosPromise

  <span class="token function">head</span><span class="token punctuation">(</span>url<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> config<span class="token operator">?</span><span class="token punctuation">:</span> AxiosRequestConfig<span class="token punctuation">)</span><span class="token punctuation">:</span> AxiosPromise

  <span class="token function">options</span><span class="token punctuation">(</span>url<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> config<span class="token operator">?</span><span class="token punctuation">:</span> AxiosRequestConfig<span class="token punctuation">)</span><span class="token punctuation">:</span> AxiosPromise

  <span class="token function">post</span><span class="token punctuation">(</span>url<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> data<span class="token operator">?</span><span class="token punctuation">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span> config<span class="token operator">?</span><span class="token punctuation">:</span> AxiosRequestConfig<span class="token punctuation">)</span><span class="token punctuation">:</span> AxiosPromise

  <span class="token function">put</span><span class="token punctuation">(</span>url<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> data<span class="token operator">?</span><span class="token punctuation">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span> config<span class="token operator">?</span><span class="token punctuation">:</span> AxiosRequestConfig<span class="token punctuation">)</span><span class="token punctuation">:</span> AxiosPromise

  <span class="token function">patch</span><span class="token punctuation">(</span>url<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> data<span class="token operator">?</span><span class="token punctuation">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span> config<span class="token operator">?</span><span class="token punctuation">:</span> AxiosRequestConfig<span class="token punctuation">)</span><span class="token punctuation">:</span> AxiosPromise
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">AxiosInstance</span> <span class="token keyword">extends</span> <span class="token class-name">Axios</span> <span class="token punctuation">{</span>
  <span class="token punctuation">(</span>config<span class="token punctuation">:</span> AxiosRequestConfig<span class="token punctuation">)</span><span class="token punctuation">:</span> AxiosPromise
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">AxiosRequestConfig</span> <span class="token punctuation">{</span>
  url<span class="token operator">?</span><span class="token punctuation">:</span> <span class="token builtin">string</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><p>首先定义一个 <code>Axios</code> 类型接口，它描述了 <code>Axios</code> 类中的公共方法，接着定义了 <code>AxiosInstance</code> 接口继承 <code>Axios</code>，它就是一个混合类型的接口。</p> <p>另外 <code>AxiosRequestConfig</code> 类型接口中的 <code>url</code> 属性变成了可选属性。</p> <h3 id="创建-axios-类"><a href="#创建-axios-类" aria-hidden="true" class="header-anchor">#</a> 创建 Axios 类</h3> <p>我们创建一个 <code>Axios</code> 类，来实现接口定义的公共方法。我们创建了一个 <code>core</code> 目录，用来存放发送请求核心流程的代码。我们在 <code>core</code> 目录下创建 <code>Axios.ts</code> 文件。</p> <p><code>core/Axios.ts</code></p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> AxiosRequestConfig<span class="token punctuation">,</span> AxiosPromise<span class="token punctuation">,</span> Method <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../types'</span>
<span class="token keyword">import</span> dispatchRequest <span class="token keyword">from</span> <span class="token string">'./dispatchRequest'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">Axios</span> <span class="token punctuation">{</span>
  <span class="token function">request</span><span class="token punctuation">(</span>config<span class="token punctuation">:</span> AxiosRequestConfig<span class="token punctuation">)</span><span class="token punctuation">:</span> AxiosPromise <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">dispatchRequest</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">get</span><span class="token punctuation">(</span>url<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> config<span class="token operator">?</span><span class="token punctuation">:</span> AxiosRequestConfig<span class="token punctuation">)</span><span class="token punctuation">:</span> AxiosPromise <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_requestMethodWithoutData</span><span class="token punctuation">(</span><span class="token string">'get'</span><span class="token punctuation">,</span> url<span class="token punctuation">,</span> config<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">delete</span><span class="token punctuation">(</span>url<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> config<span class="token operator">?</span><span class="token punctuation">:</span> AxiosRequestConfig<span class="token punctuation">)</span><span class="token punctuation">:</span> AxiosPromise <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_requestMethodWithoutData</span><span class="token punctuation">(</span><span class="token string">'delete'</span><span class="token punctuation">,</span> url<span class="token punctuation">,</span> config<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token function">head</span><span class="token punctuation">(</span>url<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> config<span class="token operator">?</span><span class="token punctuation">:</span> AxiosRequestConfig<span class="token punctuation">)</span><span class="token punctuation">:</span> AxiosPromise <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_requestMethodWithoutData</span><span class="token punctuation">(</span><span class="token string">'head'</span><span class="token punctuation">,</span> url<span class="token punctuation">,</span> config<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token function">options</span><span class="token punctuation">(</span>url<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> config<span class="token operator">?</span><span class="token punctuation">:</span> AxiosRequestConfig<span class="token punctuation">)</span><span class="token punctuation">:</span> AxiosPromise <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_requestMethodWithoutData</span><span class="token punctuation">(</span><span class="token string">'options'</span><span class="token punctuation">,</span> url<span class="token punctuation">,</span> config<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token function">post</span><span class="token punctuation">(</span>url<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> data<span class="token operator">?</span><span class="token punctuation">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span> config<span class="token operator">?</span><span class="token punctuation">:</span> AxiosRequestConfig<span class="token punctuation">)</span><span class="token punctuation">:</span> AxiosPromise <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_requestMethodWithData</span><span class="token punctuation">(</span><span class="token string">'post'</span><span class="token punctuation">,</span> url<span class="token punctuation">,</span> data<span class="token punctuation">,</span> config<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token function">put</span><span class="token punctuation">(</span>url<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> data<span class="token operator">?</span><span class="token punctuation">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span> config<span class="token operator">?</span><span class="token punctuation">:</span> AxiosRequestConfig<span class="token punctuation">)</span><span class="token punctuation">:</span> AxiosPromise <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_requestMethodWithData</span><span class="token punctuation">(</span><span class="token string">'put'</span><span class="token punctuation">,</span> url<span class="token punctuation">,</span> data<span class="token punctuation">,</span> config<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token function">patch</span><span class="token punctuation">(</span>url<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> data<span class="token operator">?</span><span class="token punctuation">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span> config<span class="token operator">?</span><span class="token punctuation">:</span> AxiosRequestConfig<span class="token punctuation">)</span><span class="token punctuation">:</span> AxiosPromise <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_requestMethodWithData</span><span class="token punctuation">(</span><span class="token string">'patch'</span><span class="token punctuation">,</span> url<span class="token punctuation">,</span> data<span class="token punctuation">,</span> config<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token function">_requestMethodWithoutData</span><span class="token punctuation">(</span><span class="token parameter">method<span class="token punctuation">:</span> Method<span class="token punctuation">,</span> url<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> config<span class="token operator">?</span><span class="token punctuation">:</span> AxiosRequestConfig</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span>
      Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span>config <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
        method<span class="token punctuation">,</span>
        url
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token function">_requestMethodWithData</span><span class="token punctuation">(</span><span class="token parameter">method<span class="token punctuation">:</span> Method<span class="token punctuation">,</span> url<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> data<span class="token operator">?</span><span class="token punctuation">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span> config<span class="token operator">?</span><span class="token punctuation">:</span> AxiosRequestConfig</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span>
      Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span>config <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
        method<span class="token punctuation">,</span>
        url<span class="token punctuation">,</span>
        data
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br></div></div><p>其中 <code>request</code> 方法的功能和我们之前的 <code>axios</code> 函数功能是一致。<code>axios</code> 函数的功能就是发送请求，基于模块化编程的思想，我们把这部分功能抽出一个单独的模块，在 <code>core</code> 目录下创建 <code>dispatchRequest</code> 方法，把之前 <code>axios.ts</code> 的相关代码拷贝过去。另外我们把 <code>xhr.ts</code> 文件也迁移到 <code>core</code> 目录下。</p> <p><code>core/dispatchRequest.ts</code>：</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> AxiosPromise<span class="token punctuation">,</span> AxiosRequestConfig<span class="token punctuation">,</span> AxiosResponse <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../types'</span>
<span class="token keyword">import</span> xhr <span class="token keyword">from</span> <span class="token string">'./xhr'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> buildURL <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../helpers/url'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> transformRequest<span class="token punctuation">,</span> transformResponse <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../helpers/data'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> processHeaders <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../helpers/headers'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">dispatchRequest</span><span class="token punctuation">(</span><span class="token parameter">config<span class="token punctuation">:</span> AxiosRequestConfig</span><span class="token punctuation">)</span><span class="token punctuation">:</span> AxiosPromise <span class="token punctuation">{</span>
  <span class="token function">processConfig</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span>
  <span class="token keyword">return</span> <span class="token function">xhr</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">transformResponseData</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">processConfig</span><span class="token punctuation">(</span><span class="token parameter">config<span class="token punctuation">:</span> AxiosRequestConfig</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
  config<span class="token punctuation">.</span>url <span class="token operator">=</span> <span class="token function">transformURL</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span>
  config<span class="token punctuation">.</span>headers <span class="token operator">=</span> <span class="token function">transformHeaders</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span>
  config<span class="token punctuation">.</span>data <span class="token operator">=</span> <span class="token function">transformRequestData</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">transformURL</span><span class="token punctuation">(</span><span class="token parameter">config<span class="token punctuation">:</span> AxiosRequestConfig</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> url<span class="token punctuation">,</span> params <span class="token punctuation">}</span> <span class="token operator">=</span> config
  <span class="token keyword">return</span> <span class="token function">buildURL</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> params<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">transformRequestData</span><span class="token punctuation">(</span><span class="token parameter">config<span class="token punctuation">:</span> AxiosRequestConfig</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token builtin">any</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">transformRequest</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">transformHeaders</span><span class="token punctuation">(</span><span class="token parameter">config<span class="token punctuation">:</span> AxiosRequestConfig</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> headers <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> data <span class="token punctuation">}</span> <span class="token operator">=</span> config
  <span class="token keyword">return</span> <span class="token function">processHeaders</span><span class="token punctuation">(</span>headers<span class="token punctuation">,</span> data<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">transformResponseData</span><span class="token punctuation">(</span><span class="token parameter">res<span class="token punctuation">:</span> AxiosResponse</span><span class="token punctuation">)</span><span class="token punctuation">:</span> AxiosResponse <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span>data <span class="token operator">=</span> <span class="token function">transformResponse</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
  <span class="token keyword">return</span> res
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br></div></div><p>回到 <code>Axios.ts</code> 文件，对于 <code>get</code>、<code>delete</code>、<code>head</code>、<code>options</code>、<code>post</code>、<code>patch</code>、<code>put</code> 这些方法，都是对外提供的语法糖，内部都是通过调用 <code>request</code> 方法实现发送请求，只不过在调用之前对 <code>config</code> 做了一层合并处理。</p> <h3 id="混合对象实现"><a href="#混合对象实现" aria-hidden="true" class="header-anchor">#</a> 混合对象实现</h3> <p>混合对象实现思路很简单，首先这个对象是一个函数，其次这个对象要包括 <code>Axios</code> 类的所有原型属性和实例属性，我们首先来实现一个辅助函数 <code>extend</code>。</p> <p><code>helpers/util.ts</code></p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">export</span> <span class="token keyword">function</span> extend<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">U</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>to<span class="token punctuation">:</span> <span class="token constant">T</span><span class="token punctuation">,</span> <span class="token keyword">from</span><span class="token punctuation">:</span> <span class="token constant">U</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token constant">T</span> <span class="token operator">&amp;</span> <span class="token constant">U</span> <span class="token punctuation">{</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> key <span class="token keyword">in</span> <span class="token keyword">from</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">;</span><span class="token punctuation">(</span>to <span class="token keyword">as</span> <span class="token constant">T</span> <span class="token operator">&amp;</span> <span class="token constant">U</span><span class="token punctuation">)</span><span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">from</span><span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token keyword">as</span> <span class="token builtin">any</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> to <span class="token keyword">as</span> <span class="token constant">T</span> <span class="token operator">&amp;</span> <span class="token constant">U</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><code>extend</code> 方法的实现用到了交叉类型，并且用到了类型断言。<code>extend</code> 的最终目的是把 <code>from</code> 里的属性都扩展到 <code>to</code> 中，包括原型上的属性。</p> <p>我们接下来对 <code>axios.ts</code> 文件做修改，我们用工厂模式去创建一个 <code>axios</code> 混合对象。</p> <p><code>axios.ts</code>：</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> AxiosInstance <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./types'</span>
<span class="token keyword">import</span> Axios <span class="token keyword">from</span> <span class="token string">'./core/Axios'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> extend <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./helpers/util'</span>

<span class="token keyword">function</span> <span class="token function">createInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> AxiosInstance <span class="token punctuation">{</span>
  <span class="token keyword">const</span> context <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Axios</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> instance <span class="token operator">=</span> <span class="token class-name">Axios</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span>

  <span class="token function">extend</span><span class="token punctuation">(</span>instance<span class="token punctuation">,</span> context<span class="token punctuation">)</span>

  <span class="token keyword">return</span> instance <span class="token keyword">as</span> AxiosInstance
<span class="token punctuation">}</span>

<span class="token keyword">const</span> axios <span class="token operator">=</span> <span class="token function">createInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> axios
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>在 <code>createInstance</code> 工厂函数的内部，我们首先实例化了 <code>Axios</code> 实例 <code>context</code>，接着创建<code>instance</code> 指向 <code>Axios.prototype.request</code> 方法，并绑定了上下文 <code>context</code>；接着通过 <code>extend</code> 方法把 <code>context</code> 中的原型方法和实例方法全部拷贝到 <code>instance</code> 上，这样就实现了一个混合对象：<code>instance</code> 本身是一个函数，又拥有了 <code>Axios</code> 类的所有原型和实例属性，最终把这个 <code>instance</code> 返回。由于这里 <code>TypeScript</code> 不能正确推断 <code>instance</code> 的类型，我们把它断言成 <code>AxiosInstance</code> 类型。</p> <p>这样我们就可以通过 <code>createInstance</code> 工厂函数创建了 <code>axios</code>，当直接调用 <code>axios</code> 方法就相当于执行了 <code>Axios</code> 类的 <code>request</code> 方法发送请求，当然我们也可以调用 <code>axios.get</code>、<code>axios.post</code> 等方法。</p> <h3 id="demo-编写"><a href="#demo-编写" aria-hidden="true" class="header-anchor">#</a> demo 编写</h3> <p>在 <code>examples</code> 目录下创建 <code>extend</code> 目录，在 <code>extend</code> 目录下创建 <code>index.html</code>:</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token doctype">&lt;!DOCTYPE html&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>utf-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Extend example<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>/__build__/extend.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>接着创建 <code>app.ts</code> 作为入口文件：</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> axios <span class="token keyword">from</span> <span class="token string">'../../src/index'</span>

<span class="token function">axios</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  url<span class="token punctuation">:</span> <span class="token string">'/extend/post'</span><span class="token punctuation">,</span>
  method<span class="token punctuation">:</span> <span class="token string">'post'</span><span class="token punctuation">,</span>
  data<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    msg<span class="token punctuation">:</span> <span class="token string">'hi'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

axios<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  url<span class="token punctuation">:</span> <span class="token string">'/extend/post'</span><span class="token punctuation">,</span>
  method<span class="token punctuation">:</span> <span class="token string">'post'</span><span class="token punctuation">,</span>
  data<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    msg<span class="token punctuation">:</span> <span class="token string">'hello'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

axios<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">'/extend/get'</span><span class="token punctuation">)</span>

axios<span class="token punctuation">.</span><span class="token function">options</span><span class="token punctuation">(</span><span class="token string">'/extend/options'</span><span class="token punctuation">)</span>

axios<span class="token punctuation">.</span><span class="token keyword">delete</span><span class="token punctuation">(</span><span class="token string">'/extend/delete'</span><span class="token punctuation">)</span>

axios<span class="token punctuation">.</span><span class="token function">head</span><span class="token punctuation">(</span><span class="token string">'/extend/head'</span><span class="token punctuation">)</span>

axios<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/extend/post'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> msg<span class="token punctuation">:</span> <span class="token string">'post'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>

axios<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">'/extend/put'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> msg<span class="token punctuation">:</span> <span class="token string">'put'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>

axios<span class="token punctuation">.</span><span class="token function">patch</span><span class="token punctuation">(</span><span class="token string">'/extend/patch'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> msg<span class="token punctuation">:</span> <span class="token string">'patch'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><h2 id="ts-axios-编译与发布"><a href="#ts-axios-编译与发布" aria-hidden="true" class="header-anchor">#</a> ts-axios 编译与发布</h2> <h3 id="编译和打包"><a href="#编译和打包" aria-hidden="true" class="header-anchor">#</a> 编译和打包</h3> <p>我们会利用 <a href="https://github.com/rollup/rollup" target="_blank" rel="noopener noreferrer">rollup<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 来打包我们的 <code>ts-axios</code> 库，它是一个非常著名的编译打包工具，Vue.js 也是利用 rollup 编译打包的。相比 webpack，它非常适合去编译和打包一些 JS 库。</p> <p>由于使用 <code>typescript-library-starter</code> 初始化我们的项目，我们已经拥有了 rollup 打包的相关配置和相关插件的安装，接下来我们就来对生成的 <code>rollup.config.ts</code> 做小小的修改。</p> <h3 id="修改-rollup-config-ts"><a href="#修改-rollup-config-ts" aria-hidden="true" class="header-anchor">#</a> 修改 rollup.config.ts</h3> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> resolve <span class="token keyword">from</span> <span class="token string">'rollup-plugin-node-resolve'</span>
<span class="token keyword">import</span> commonjs <span class="token keyword">from</span> <span class="token string">'rollup-plugin-commonjs'</span>
<span class="token keyword">import</span> sourceMaps <span class="token keyword">from</span> <span class="token string">'rollup-plugin-sourcemaps'</span>
<span class="token keyword">import</span> camelCase <span class="token keyword">from</span> <span class="token string">'lodash.camelcase'</span>
<span class="token keyword">import</span> typescript <span class="token keyword">from</span> <span class="token string">'rollup-plugin-typescript2'</span>
<span class="token keyword">import</span> json <span class="token keyword">from</span> <span class="token string">'rollup-plugin-json'</span>

<span class="token keyword">const</span> pkg <span class="token operator">=</span> <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">'./package.json'</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> libraryName <span class="token operator">=</span> <span class="token string">'axios'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  input<span class="token punctuation">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">src/index.ts</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
  output<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span> file<span class="token punctuation">:</span> pkg<span class="token punctuation">.</span>main<span class="token punctuation">,</span> name<span class="token punctuation">:</span> <span class="token function">camelCase</span><span class="token punctuation">(</span>libraryName<span class="token punctuation">)</span><span class="token punctuation">,</span> format<span class="token punctuation">:</span> <span class="token string">'umd'</span><span class="token punctuation">,</span> sourcemap<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> file<span class="token punctuation">:</span> pkg<span class="token punctuation">.</span><span class="token keyword">module</span><span class="token punctuation">,</span> format<span class="token punctuation">:</span> <span class="token string">'es'</span><span class="token punctuation">,</span> sourcemap<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token comment">// Indicate here external modules you don't wanna include in your bundle (i.e.: 'lodash')</span>
  external<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  watch<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    include<span class="token punctuation">:</span> <span class="token string">'src/**'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token comment">// Allow json resolution</span>
    <span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token operator">/</span><span class="token operator">/</span> Compile TypeScript files
    <span class="token function">typescript</span><span class="token punctuation">(</span><span class="token punctuation">{</span> useTsconfigDeclarationDir<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token operator">/</span><span class="token operator">/</span> Allow bundling cjs <span class="token function">modules</span> <span class="token punctuation">(</span>unlike webpack<span class="token punctuation">,</span> rollup doesn't understand cjs<span class="token punctuation">)</span>
    <span class="token function">commonjs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token operator">/</span><span class="token operator">/</span> Allow node_modules resolution<span class="token punctuation">,</span> so you can use <span class="token string">'external'</span> to control
    <span class="token operator">/</span><span class="token operator">/</span> which external modules to include <span class="token keyword">in</span> the bundle
    <span class="token operator">/</span><span class="token operator">/</span> https<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>github<span class="token punctuation">.</span>com<span class="token operator">/</span>rollup<span class="token operator">/</span>rollup<span class="token operator">-</span>plugin<span class="token operator">-</span>node<span class="token operator">-</span>resolve#usage
    <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

    <span class="token operator">/</span><span class="token operator">/</span> Resolve source maps to the original source
    <span class="token function">sourceMaps</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br></div></div><p>注意要修改的地方，把 <code>libraryName</code> 修改为 <code>axios</code>，<code>input</code> 修改为 <code>src/index.ts</code>。</p> <p><code>rollup</code> 的配置很简单，我们简单地过一下。</p> <ul><li>input</li></ul> <p>表示打包入口文件。</p> <ul><li>output</li></ul> <p>表示输出的目标文件，它是一个对象数组，我们可以指定输出的格式，比如 <code>umd</code> 格式、<code>es</code> 模式等。</p> <ul><li>external</li></ul> <p>声明它的外部依赖，可以不被打包进去。</p> <ul><li>watch</li></ul> <p>监听文件的变化，重新编译，只有在编译的时候开启 <code>--watch</code> 才生效。</p> <ul><li>plugins</li></ul> <p>编译过程中使用的插件，其中 <code>rollup-plugin-typescript2</code> 就是用来编译 TypeScript 文件，<code>useTsconfigDeclarationDir</code> 表示使用 <code>tsconfig.json</code> 文件中定义的 <code>declarationDir</code>。其它插件感兴趣的同学可以自己去查阅文档。</p> <h3 id="修改-package-json"><a href="#修改-package-json" aria-hidden="true" class="header-anchor">#</a> 修改 package.json</h3> <p>由于我们已经在 <code>rollup.config.ts</code> 中修改了 <code>libraryName</code> 为 <code>axios</code>， 那么在 <code>package.json</code> 文件中你需要做相关的修改：</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token punctuation">{</span>
  <span class="token string">&quot;main&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;dist/axios.umd.js&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;module&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;dist/axios.es5.js&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;typings&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;dist/types/index.d.ts&quot;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>然后我们在控制台执行 <code>npm run build</code>，会编译输出 <code>dist</code> 目录，其中 <code>lib</code> 目录是单个 <code>.ts</code> 文件编译后的 <code>.js</code> 文件。<code>types</code> 目录是所有 <code>.ts</code> 文件编译后生产的 <code>.d.ts</code> 声明文件。<code>axios.es5.js</code> 是编译后生成的 es 模式的入口文件，用在 <code>package.json</code> 的 <code>module</code> 字段，<code>axios.umd.js</code> 文件是编译后生成的 <code>umd</code> 模式的入口文件，用在 <code>package.json</code> 的 <code>main</code> 字段。</p> <h3 id="自动化部署"><a href="#自动化部署" aria-hidden="true" class="header-anchor">#</a> 自动化部署</h3> <p>由于 <code>semantic-release</code> 插件过于黑盒也略微重量，我还是决定教同学们自己编写自动化部署脚本，这样更灵活，意义也更大，因为大部分场景是用不到那么多 feature 的。</p> <h3 id="修改-package-json-2"><a href="#修改-package-json-2" aria-hidden="true" class="header-anchor">#</a> 修改 package.json</h3> <p>发布到 npm 之前你需要为你的包命名，由于 <code>ts-axios</code> 这个名字已经被占用了，我使用了 <code>ts-axios-new</code> 这个名称，当然你学到这里，就需要起一个新名字了。可以使用 <code>npm view [&lt;@scope&gt;/]&lt;pkg&gt;[@&lt;version&gt;]</code> 的方式去搜索一个包名是否已经存在，比如你搜索 <code>npm view ts-axios-new</code> 会发现这个包已经存在，返回这个包相关信息。如果你搜索 <code>npm view xxxx</code> 返回错误 404 的话，那么你就可以使用 <code>xxxx</code> 这个包名了。</p> <p>如果你想让你发布的包关联你的仓库地址，可以配置 <code>repository</code> 的 <code>url</code> 字段。</p> <p>另外我们增加 2 个 npm scripts：</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;prepub&quot;</span><span class="token operator">:</span> <span class="token string">&quot;npm run test:prod &amp;&amp; npm run build&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;pub&quot;</span><span class="token operator">:</span> <span class="token string">&quot;sh release.sh&quot;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>当我们运行 <code>npm run pub</code> 的时候，会优先执行 <code>prepub</code> 脚本，在 <code>prepub</code> 中我们运行了 <code>test:prod</code> 和 <code>build</code> 2 个脚本。<code>&amp;&amp;</code> 符号表示前面一个命令执行成功后才会执行后面的任务。</p> <p><code>npm run test:prod</code> 实际上运行了 <code>npm run lint &amp;&amp; npm run test -- --no-cache</code>。 先运行 <code>lint</code> 去校验我们的源码和测试文件是否遵循 <code>tslint</code> 规范，再运行 <code>test</code> 去跑测试。</p> <p><code>npm run build</code> 实际上运行了 <code>tsc --module commonjs</code>、<code>rollup -c rollup.config.ts</code> 和 <code>typedoc --out docs --target es6 --theme minimal --mode file src</code>。先运行 <code>tsc</code> 去编译我们的 <code>TypeScript</code> 文件，<code>dist/lib</code> 和 <code>dist/types</code> 下的文件就是该命令产生的，然后运行 <code>rollup</code> 去构建 <code>axios.umd.js</code> 及 <code>axios.es.js</code>，最后运行 <code>typedoc</code> 去构建项目的文档。</p> <p>运行完 <code>prepub</code> 后就会再运行 <code>pub</code> 命令，实际上执行了 <code>sh release.sh</code> 命令，但是目前我们没有这个脚本，接下来我们就需要来编写部署脚本 <code>release.sh</code>。</p> <h3 id="编写部署脚本"><a href="#编写部署脚本" aria-hidden="true" class="header-anchor">#</a> 编写部署脚本</h3> <p><code>release.sh</code>：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token shebang important">#!/usr/bin/env sh</span>
<span class="token builtin class-name">set</span> -e
<span class="token builtin class-name">echo</span> <span class="token string">&quot;Enter release version: &quot;</span>
<span class="token builtin class-name">read</span> VERSION
<span class="token builtin class-name">read</span> -p <span class="token string">&quot;Releasing <span class="token variable">$VERSION</span> - are you sure? (y/n)&quot;</span> -n <span class="token number">1</span> -r
<span class="token builtin class-name">echo</span>  <span class="token comment"># (optional) move to a new line</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token environment constant">$REPLY</span> <span class="token operator">=</span>~ ^<span class="token punctuation">[</span>Yy<span class="token punctuation">]</span>$ <span class="token punctuation">]</span><span class="token punctuation">]</span>
<span class="token keyword">then</span>
  <span class="token builtin class-name">echo</span> <span class="token string">&quot;Releasing <span class="token variable">$VERSION</span> ...&quot;</span>

  <span class="token comment"># commit</span>
  <span class="token function">git</span> <span class="token function">add</span> -A
  <span class="token function">git</span> commit -m <span class="token string">&quot;[build] <span class="token variable">$VERSION</span>&quot;</span>
  <span class="token function">npm</span> version <span class="token variable">$VERSION</span> --message <span class="token string">&quot;[release] <span class="token variable">$VERSION</span>&quot;</span>
  <span class="token function">git</span> push origin master

  <span class="token comment"># publish</span>
  <span class="token function">npm</span> publish
<span class="token keyword">fi</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>部署脚本是 shell 脚本，shell 脚本就是封装了多行控制台命令，来逐行解释他们的含义。</p> <p><code>#!/usr/bin/env sh</code> 用来表示它是一个 shell 脚本。</p> <p><code>set -e</code> 告诉脚本如果执行结果不为 true 则退出。</p> <p><code>echo &quot;Enter release version: &quot;</code> 在控制台输出 <code>Enter release version:</code>。</p> <p><code>read VERSION</code> 表示从标准输入读取值，并赋值给 $VERSION 变量。</p> <p><code>read -p &quot;Releasing $VERSION - are you sure? (y/n)&quot; -n 1 -r</code>，其中 <code>read -p</code> 表示给出提示符，后面接着 <code>Releasing $VERSION - are you sure? (y/n)</code> 提示符；<code>-n 1</code> 表示限定最多可以有 1 个字符可以作为有效读入；<code>-r</code> 表示禁止反斜线的转义功能。因为我们的 read 并没有指定变量名，那么默认这个输入读取值会赋值给 <code>$REPLY</code> 变量。</p> <p><code>echo</code> 输出空值表示跳到一个新行，<code>#</code> 在 shell 脚本中表示注释。</p> <p><code>if [[ $REPLY =~ ^[Yy]$ ]]</code> 表示 shell 脚本中的流程控制语句，判断 <code>$REPLY</code> 是不是大小写的 <code>y</code>，如果满足，则走到后面的 <code>then</code> 逻辑。</p> <p><code>echo &quot;Releasing $VERSION ...&quot;</code>  在控制台输出 <code>Releasing $VERSION ...</code>。</p> <p><code>git add -A</code> 表示把代码所有变化提交到暂存区。</p> <p><code>git commit -m &quot;[build] $VERSION&quot;</code> 表示提交代码，提交注释是 <code>[build] $VERSION</code>。</p> <p><code>npm version $VERSION --message &quot;[release] $VERSION&quot;</code> 是修改 <code>package.json</code> 中的 <code>version</code> 字段到 <code>$VERSION</code>，并且提交一条修改记录，提交注释是 <code>[release] $VERSION</code>。</p> <p><code>git push origin master</code> 是把代码发布到主干分支。</p> <p><code>npm publish</code> 是把仓库发布到 <code>npm</code> 上，我们会把 <code>dist</code> 目录下的代码都发布到 <code>npm</code> 上，因为我们在 <code>package.json</code> 中配置的是 <code>files</code> 是 <code>[&quot;dist&quot;]</code>。</p> <h3 id="运行部署脚本"><a href="#运行部署脚本" aria-hidden="true" class="header-anchor">#</a> 运行部署脚本</h3> <p>接下来我们就运行 <code>npm run pub</code> 脚本部署，我们会发现在 <code>npm run prepub</code> 阶段，在执行 <code>tslint --project tsconfig.json -t codeFrame 'src/**/*.ts' 'test/**/*.ts'</code> 的时候失败了，原因是我们有代码不符合 lint 规范。原来是 <code>core/xhr.ts</code> 文件中 <code>processCancel</code> 函数中对 <code>promise</code> 的处理，我们没有对异常情况处理，所以我们要给它加上 <code>catch</code> 的逻辑：</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">function</span> <span class="token function">processCancel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>cancelToken<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    cancelToken<span class="token punctuation">.</span>promise
      <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">reason</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        request<span class="token punctuation">.</span><span class="token function">abort</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token function">reject</span><span class="token punctuation">(</span>reason<span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span>
        <span class="token comment">/* istanbul ignore next */</span>
        <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// do nothing</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>由于我们不会走到 <code>catch</code> 逻辑，所以我们给它添加一个注释 <code>/* istanbul ignore next */</code> 忽略该代码分支的测试。</p> <p>然后我们再重新运行 <code>npm run pub</code> 逻辑，它会先执行 <code>test</code>，然后运行 <code>build</code> 编译代码，再执行 <code>release.sh</code> 脚本。我们输入了要发布的版本，它就可以完成了整个代码的发布流程。</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/prepare/js/TypeScript/05-learningTypeScript.html" class="prev">05-learningTypeScript</a></span> <span class="next"><a href="/prepare/js/基础/01-错误处理机制.html">01-错误处理机制</a>
      →
    </span></p></div> </main> <span data-v-cedb125c></span></div><div class="global-ui"></div></div>
    <script src="/prepare/assets/js/app.4aa2a542.js" defer></script><script src="/prepare/assets/js/3.54d0c86c.js" defer></script><script src="/prepare/assets/js/2.1e70219e.js" defer></script><script src="/prepare/assets/js/367.7f7f1832.js" defer></script>
  </body>
</html>
